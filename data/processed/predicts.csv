,id,question,code_concise,code_verbose,answer,predict
0,1,How many total shipments are in the dataset?,result = len(df),"df['date']=pd.to_datetime(df['date'])
# total number of shipments
result = df.shape[0]
",1000,1000
1,2,What is the earliest shipment date recorded?,df['date']=pd.to_datetime(df['date']); result = df['date'].min(),"df['date']=pd.to_datetime(df['date'])
# earliest shipment date
result = df['date'].min()
",2024-01-01 00:00:00,The earliest shipment date recorded is 2024-01-01 00:00:00.
2,3,What is the most recent shipment date?,df['date']=pd.to_datetime(df['date']); result = df['date'].max(),"df['date']=pd.to_datetime(df['date'])
# most recent shipment date
result = df['date'].max()
",2024-12-30 00:00:00,The most recent shipment date is 2024-12-30 00:00:00.
3,4,How many unique routes are there?,result = df['route'].nunique(),"# number of unique routes
result = df['route'].nunique()
",5,5
4,5,How many warehouses are involved?,result = df['warehouse'].nunique(),"# number of unique warehouses
result = df['warehouse'].nunique()
",4,4
5,6,Which warehouse handled the most shipments overall?,result = df['warehouse'].value_counts().idxmax(),"# warehouse with most shipments
result = df['warehouse'].value_counts().idxmax()
",WH1,The warehouse that handled the most shipments overall is WH1.
6,7,Which route had the fewest shipments?,result = df['route'].value_counts().idxmin(),"# route with fewest shipments
result = df['route'].value_counts().idxmin()
",Route C,The route with the fewest shipments is Route C.
7,8,How many shipments had zero delay?,result = (df['delay_minutes']==0).sum(),"# count shipments with zero delay
result = df[df['delay_minutes']==0].shape[0]
",170,170
8,9,What percentage of all shipments were delayed?,result = (df['delay_minutes']>0).mean()*100,"# percentage of shipments delayed
result = (df['delay_minutes']>0).mean() * 100
",83.0,The percentage of all shipments that were delayed is 83.00%.
9,10,What is the total delay time across all shipments?,result = df['delay_minutes'].sum(),"# total delay minutes across dataset
result = df['delay_minutes'].sum()
",52784,52784.0
10,11,Which route has the highest average delivery time?,result = df.groupby('route')['delivery_time'].mean().idxmax(),"# route with highest average delivery time
result = df.groupby('route')['delivery_time'].mean().idxmax()
",Route C,The route with the highest average delivery time is Route C.
11,12,Which route has the lowest average delivery time?,result = df.groupby('route')['delivery_time'].mean().idxmin(),"# route with lowest average delivery time
result = df.groupby('route')['delivery_time'].mean().idxmin()
",Route B,The route with the lowest average delivery time is Route B.
12,13,Which route experienced the most total delay minutes?,result = df['delay_minutes'].sum(),"# total delay minutes across dataset
result = df['delay_minutes'].sum()
",52784,The route that experienced the most total delay minutes is Route E.
13,14,On which route were delays most frequent?,result = df[df['delay_minutes']>0]['route'].value_counts().idxmax(),"# route with most frequent delays
result = df[df['delay_minutes']>0]['route'].value_counts().idxmax()
",Route E,The route with the most frequent delays is Route E.
14,15,What is the average delivery time per route?,result = df.groupby('route')['delivery_time'].mean(),"# average delivery time per route
result = df.groupby('route')['delivery_time'].mean().reset_index()
","route
Route A    5.546961
Route B    5.438376
Route C    5.573716
Route D    5.461773
Route E    5.453333
Name: delivery_time, dtype: float64","     route  avg_delivery_time
0  Route C           5.573716
1  Route A           5.546961
2  Route D           5.461773
3  Route E           5.453333
4  Route B           5.438376"
15,16,Show the route-wise breakdown of delay reasons.,"result = df[df['delay_minutes']>0].groupby(['route','delay_reason'])['id'].count()","# breakdown of delay reasons by route
result = df[df['delay_minutes']>0].groupby(['route','delay_reason'])['id'].count().reset_index(name='count')
","route    delay_reason    
Route A  Customs Delay       24
         Driver Rest         31
         Mechanical Issue    27
         Minor Breakdown     22
         Traffic             29
         Weather             33
Route B  Customs Delay       22
         Driver Rest         38
         Mechanical Issue    24
         Minor Breakdown     29
         Traffic             30
         Weather             25
Route C  Customs Delay       17
         Driver Rest         21
         Mechanical Issue    28
         Minor Breakdown     30
         Traffic             32
         Weather             20
Route D  Customs Delay       21
         Driver Rest         30
         Mechanical Issue    41
         Minor Breakdown     20
         Traffic             29
         Weather             30
Route E  Customs Delay       31
         Driver Rest         25
         Mechanical Issue    23
         Minor Breakdown     32
         Traffic             37
         Weather             29
Name: id, dtype: int64","      route      delay_reason  count
0   Route A              None     38
1   Route A           Weather     33
2   Route A       Driver Rest     31
3   Route A           Traffic     29
4   Route A  Mechanical Issue     27
5   Route A     Customs Delay     24
6   Route A   Minor Breakdown     22
7   Route B       Driver Rest     38
8   Route B           Traffic     30
9   Route B   Minor Breakdown     29
10  Route B              None     29
11  Route B           Weather     25
12  Route B  Mechanical Issue     24
13  Route B     Customs Delay     22
14  Route C              None     35
15  Route C           Traffic     32
16  Route C   Minor Breakdown     30
17  Route C  Mechanical Issue     28
18  Route C       Driver Rest     21
19  Route C           Weather     20
20  Route C     Customs Delay     17
21  Route D  Mechanical Issue     41
22  Route D              None     32
23  Route D       Driver Rest     30
24  Route D           Weather     30
25  Route D           Traffic     29
26  Route D     Customs Delay     21
27  Route D   Minor Breakdown     20
28  Route E           Traffic     37
29  Route E              None     36
30  Route E   Minor Breakdown     32
31  Route E     Customs Delay     31
32  Route E           Weather     29
33  Route E       Driver Rest     25
34  Route E  Mechanical Issue     23"
16,17,Which routes had no delays at all?,"result = [r for r,g in df.groupby('route') if (g['delay_minutes']>0).sum()==0]","groups = df.groupby('route')
# routes with zero delays
result = [route for route, g in groups if (g['delay_minutes']>0).sum() == 0]
",[],"     route
0  Route B
1  Route D
2  Route C
3  Route E
4  Route A"
17,18,Rank all routes by reliability (fewest delays to most).,result = df.groupby('route').apply(lambda g:(g['delay_minutes']==0).mean()).sort_values(ascending=False),"# rank routes by on-time rate
result = df.groupby('route').apply(lambda g: (g['delay_minutes']==0).mean()).sort_values(ascending=False).reset_index(name='on_time_rate')
","route
Route C    0.191257
Route A    0.186275
Route E    0.169014
Route D    0.157635
Route B    0.147208
dtype: float64","     route  total_shipments  delayed_shipments  reliability_percentage
0  Route C              183              148.0               19.125683
1  Route A              204              166.0               18.627451
2  Route E              213              177.0               16.901408
3  Route D              203              171.0               15.763547
4  Route B              197              168.0               14.720812"
18,19,What is the median delivery time by route?,result = df.groupby('route')['delivery_time'].median(),"# median delivery time by route
result = df.groupby('route')['delivery_time'].median().reset_index()
","route
Route A    5.55
Route B    5.47
Route C    5.69
Route D    5.37
Route E    5.51
Name: delivery_time, dtype: float64","     route  median_delivery_time
0  Route C                  5.69
1  Route E                  5.51
2  Route A                  5.55
3  Route B                  5.47
4  Route D                  5.37"
19,20,Which warehouse has the longest average delay?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the longest average delay is WH2.
20,21,Which warehouse shows the shortest delivery time overall?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the shortest delivery time overall is WH4.
21,22,Which warehouse had the highest number of delayed shipments?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the highest number of delayed shipments is WH1.
22,23,What is the average delay time per warehouse?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delay_minutes
0       WH3          54.206612
1       WH1          50.613971
2       WH2          54.525424
3       WH4          52.124000"
23,24,Which warehouse had the most weather-related delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most weather-related delays is WH3.
24,25,Which warehouse had the least total delay minutes?,result = df['delay_minutes'].sum(),"# total delay minutes across dataset
result = df['delay_minutes'].sum()
",52784,The warehouse with the least total delay minutes is WH2.
25,26,Which warehouse served the most different routes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  distinct_routes
0       WH4                5"
26,27,Which warehouse has the most consistent delivery times?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most consistent delivery times is WH1.
27,28,How many shipments were sent from each warehouse?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  shipment_count
0       WH1             272
1       WH4             250
2       WH3             242
3       WH2             236"
28,29,What is the average delay time across all shipments?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",52.784
29,30,What is the most common delay reason?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The most common delay reason is None.
30,31,Which delay reason caused the most total delay minutes?,result = df['delay_minutes'].sum(),"# total delay minutes across dataset
result = df['delay_minutes'].sum()
",52784,The delay reason that caused the most total delay minutes is 'Traffic' with a total of 10747.0 minutes.
31,32,What is the maximum recorded delay time?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",120
32,33,Which route had the longest single delay event?,"idx = df['delay_minutes'].idxmax(); result = df.loc[idx, ['route','delay_minutes','date']].to_dict()","idx = df['delay_minutes'].idxmax()
result = df.loc[idx, ['route', 'delay_minutes', 'date']].to_dict()
","{'route': 'Route C', 'delay_minutes': 120, 'date': Timestamp('2024-01-06 00:00:00')}",The route with the longest single delay event is 'Route A' with a delay of 120 minutes.
33,34,How many shipments occurred per month?,df['date']=pd.to_datetime(df['date']); result = df.groupby(df['date'].dt.month)['id'].count(),"df['date']=pd.to_datetime(df['date'])
# shipments per month
result = df.groupby(df['date'].dt.month)['id'].count().reset_index(name='count')
","date
1     92
2     87
3     93
4     90
5     93
6     90
7     93
8     93
9     87
10    62
11    60
12    60
Name: id, dtype: int64","      month  shipments_count
0   2024-01               92
1   2024-02               87
2   2024-03               93
3   2024-04               90
4   2024-05               93
5   2024-06               90
6   2024-07               93
7   2024-08               93
8   2024-09               87
9   2024-10               62
10  2024-11               60
11  2024-12               60"
34,35,Which month had the highest delay rate?,df['date']=pd.to_datetime(df['date']); result = df.groupby(df['date'].dt.month).apply(lambda g:(g['delay_minutes']>0).mean()).idxmax(),"df['date']=pd.to_datetime(df['date'])
# month with highest delay rate
result = df.groupby(df['date'].dt.month).apply(lambda g: (g['delay_minutes']>0).mean()).idxmax()
",9,The month with the highest delay rate is 9.0.
35,36,Which week had the most deliveries?,df['date']=pd.to_datetime(df['date']); result = df.groupby(df['date'].dt.isocalendar().week)['id'].count().idxmax(),"df['date']=pd.to_datetime(df['date'])
# week number with most deliveries
result = df.groupby(df['date'].dt.isocalendar().week)['id'].count().idxmax()
",1,The week with the most deliveries was week 1.
36,37,What day of the week has the most shipments?,df['date']=pd.to_datetime(df['date']); result = df.groupby(df['date'].dt.day_name())['id'].count().idxmax(),"df['date']=pd.to_datetime(df['date'])
# day of week with most shipments
result = df.groupby(df['date'].dt.day_name())['id'].count().idxmax()
",Monday,The day of the week with the most shipments is Tuesday.
37,38,What is the on-time delivery rate?,result = (df['delay_minutes']==0).mean(),"# on-time delivery rate
result = (df['delay_minutes'] == 0).mean()
",0.17,The on-time delivery rate is 17.00%.
38,39,What is the 95th percentile of delivery time?,result = df['delivery_time'].quantile(0.95),"# 95th percentile of delivery_time
result = df['delivery_time'].quantile(0.95)
",6.87,6.87
39,40,How many shipments took more than 6 days?,result = (df['delivery_time']>6).sum(),"# shipments with delivery_time more than 6
result = df[df['delivery_time'] > 6].shape[0]
",318,318
40,41,How many shipments took less than 3 days?,result = (df['delivery_time']<3).sum(),"# shipments with delivery_time less than 3
result = df[df['delivery_time'] < 3].shape[0]
",0,1000
41,42,What is the correlation between delivery_time and delay_minutes?,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,-0.004137855444638722
42,43,Show all shipments delayed last week.,df['date']=pd.to_datetime(df['date']); maxd=df['date'].max(); last_week=df[(df['date']>maxd-pd.Timedelta(days=7))]; result = last_week[last_week['delay_minutes']>0],"df['date']=pd.to_datetime(df['date'])
max_date = df['date'].max()
last_week = df[(df['date'] > max_date - pd.Timedelta(days=7))]
result = last_week[last_week['delay_minutes'] > 0].reset_index(drop=True)
","      id    route warehouse  delivery_time  delay_minutes      delay_reason  \
357  358  Route A       WH4           4.91             21  Mechanical Issue   
358  359  Route C       WH4           6.27             51           Traffic   
359  360  Route C       WH1           6.64             27       Driver Rest   
360  361  Route E       WH2           6.38             62     Customs Delay   
361  362  Route D       WH2           5.65            117           Weather   
362  363  Route A       WH3           5.72             46           Weather   
363  364  Route B       WH1           4.46            118           Traffic   
722  723  Route C       WH4           5.08             69           Traffic   
723  724  Route D       WH1           6.23             71           Weather   
725  726  Route C       WH4           5.54              6   Minor Breakdown   
726  727  Route B       WH3           6.11             26           Traffic   
727  728  Route A       WH1           5.35             38           Traffic   
728  729  Route A       WH4           6.65             97       Driver Rest   

          date  
357 2024-12-24  
358 2024-12-25  
359 2024-12-26  
360 2024-12-27  
361 2024-12-28  
362 2024-12-29  
363 2024-12-30  
722 2024-12-24  
723 2024-12-25  
725 2024-12-27  
726 2024-12-28  
727 2024-12-29  
728 2024-12-30  ","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0   357  Route E       WH3           5.65             20     Customs Delay   
1   358  Route A       WH4           4.91             21  Mechanical Issue   
2   359  Route C       WH4           6.27             51           Traffic   
3   360  Route C       WH1           6.64             27       Driver Rest   
4   361  Route E       WH2           6.38             62     Customs Delay   
5   362  Route D       WH2           5.65            117           Weather   
6   363  Route A       WH3           5.72             46           Weather   
7   364  Route B       WH1           4.46            118           Traffic   
8   723  Route C       WH4           5.08             69           Traffic   
9   724  Route D       WH1           6.23             71           Weather   
10  726  Route C       WH4           5.54              6   Minor Breakdown   
11  727  Route B       WH3           6.11             26           Traffic   
12  728  Route A       WH1           5.35             38           Traffic   
13  729  Route A       WH4           6.65             97       Driver Rest   

         date  
0  2024-12-23  
1  2024-12-24  
2  2024-12-25  
3  2024-12-26  
4  2024-12-27  
5  2024-12-28  
6  2024-12-29  
7  2024-12-30  
8  2024-12-24  
9  2024-12-25  
10 2024-12-27  
11 2024-12-28  
12 2024-12-29  
13 2024-12-30  "
43,44,Show total delayed shipments last month.,df['date']=pd.to_datetime(df['date']); m=df['date'].max().month; y=df['date'].max().year; result = df[(df['date'].dt.month==m)&(df['date'].dt.year==y)&(df['delay_minutes']>0)].shape[0],"df['date']=pd.to_datetime(df['date'])
max_date = df['date'].max()
month = max_date.month; year = max_date.year
result = df[(df['date'].dt.month==month) & (df['date'].dt.year==year) & (df['delay_minutes']>0)].shape[0]
",48,50
44,45,List all shipments in October with delay above 20 minutes.,df['date']=pd.to_datetime(df['date']); result = df[(df['date'].dt.month==10)&(df['delay_minutes']>20)],"df['date']=pd.to_datetime(df['date'])
result = df[(df['date'].dt.month == 10) & (df['delay_minutes'] > 20)].reset_index(drop=True)
","      id    route warehouse  delivery_time  delay_minutes      delay_reason  \
273  274  Route B       WH2           4.12             77  Mechanical Issue   
275  276  Route C       WH2           5.81             78  Mechanical Issue   
276  277  Route D       WH4           6.19             69   Minor Breakdown   
277  278  Route A       WH1           6.41            108     Customs Delay   
278  279  Route B       WH4           4.25             28           Weather   
279  280  Route E       WH3           5.11             58  Mechanical Issue   
280  281  Route D       WH1           6.30             28  Mechanical Issue   
281  282  Route E       WH1           5.29            120           Traffic   
283  284  Route C       WH1           4.56             23           Weather   
284  285  Route C       WH2           5.20             88           Traffic   
285  286  Route E       WH3           6.27             28  Mechanical Issue   
286  287  Route B       WH1           5.10             46       Driver Rest   
287  288  Route B       WH3           5.19             88     Customs Delay   
288  289  Route C       WH1           4.09             81   Minor Breakdown   
289  290  Route D       WH1           4.83             86       Driver Rest   
291  292  Route A       WH3           5.22             33     Customs Delay   
292  293  Route E       WH4           4.07             21           Weather   
296  297  Route D       WH2           5.80            101  Mechanical Issue   
299  300  Route E       WH1           6.16             31           Traffic   
300  301  Route A       WH4           6.54             83  Mechanical Issue   
303  304  Route E       WH2           5.60            104  Mechanical Issue   
638  639  Route D       WH2           5.85             54           Weather   
639  640  Route D       WH4           4.36             29           Traffic   
640  641  Route B       WH2           6.29             72  Mechanical Issue   
642  643  Route E       WH2           4.11             93     Customs Delay   
643  644  Route B       WH1           6.40            107     Customs Delay   
647  648  Route E       WH2           6.72            110           Traffic   
648  649  Route E       WH1           6.44             29           Traffic   
651  652  Route C       WH4           6.23             93           Weather   
652  653  Route E       WH3           4.80            100           Weather   
653  654  Route B       WH4           5.47            113           Traffic   
656  657  Route D       WH1           4.45             87           Traffic   
657  658  Route A       WH3           4.20             71   Minor Breakdown   
658  659  Route B       WH2           6.48            106  Mechanical Issue   
660  661  Route E       WH1           5.93             83           Traffic   
661  662  Route E       WH1           6.06            110           Weather   
662  663  Route B       WH4           4.98             98   Minor Breakdown   
663  664  Route A       WH1           5.09             50   Minor Breakdown   
666  667  Route A       WH3           4.22             97           Weather   
668  669  Route B       WH1           4.38             86           Weather   

          date  
273 2024-10-01  
275 2024-10-03  
276 2024-10-04  
277 2024-10-05  
278 2024-10-06  
279 2024-10-07  
280 2024-10-08  
281 2024-10-09  
283 2024-10-11  
284 2024-10-12  
285 2024-10-13  
286 2024-10-14  
287 2024-10-15  
288 2024-10-16  
289 2024-10-17  
291 2024-10-19  
292 2024-10-20  
296 2024-10-24  
299 2024-10-27  
300 2024-10-28  
303 2024-10-31  
638 2024-10-01  
639 2024-10-02  
640 2024-10-03  
642 2024-10-05  
643 2024-10-06  
647 2024-10-10  
648 2024-10-11  
651 2024-10-14  
652 2024-10-15  
653 2024-10-16  
656 2024-10-19  
657 2024-10-20  
658 2024-10-21  
660 2024-10-23  
661 2024-10-24  
662 2024-10-25  
663 2024-10-26  
666 2024-10-29  
668 2024-10-31  ","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0   274  Route B       WH2           4.12             77  Mechanical Issue   
1   276  Route C       WH2           5.81             78  Mechanical Issue   
2   277  Route D       WH4           6.19             69   Minor Breakdown   
3   278  Route A       WH1           6.41            108     Customs Delay   
4   279  Route B       WH4           4.25             28           Weather   
5   280  Route E       WH3           5.11             58  Mechanical Issue   
6   281  Route D       WH1           6.30             28  Mechanical Issue   
7   282  Route E       WH1           5.29            120           Traffic   
8   284  Route C       WH1           4.56             23           Weather   
9   285  Route C       WH2           5.20             88           Traffic   
10  286  Route E       WH3           6.27             28  Mechanical Issue   
11  287  Route B       WH1           5.10             46       Driver Rest   
12  288  Route B       WH3           5.19             88     Customs Delay   
13  289  Route C       WH1           4.09             81   Minor Breakdown   
14  290  Route D       WH1           4.83             86       Driver Rest   
15  292  Route A       WH3           5.22             33     Customs Delay   
16  293  Route E       WH4           4.07             21           Weather   
17  297  Route D       WH2           5.80            101  Mechanical Issue   
18  300  Route E       WH1           6.16             31           Traffic   
19  301  Route A       WH4           6.54             83  Mechanical Issue   
20  304  Route E       WH2           5.60            104  Mechanical Issue   
21  639  Route D       WH2           5.85             54           Weather   
22  640  Route D       WH4           4.36             29           Traffic   
23  641  Route B       WH2           6.29             72  Mechanical Issue   
24  643  Route E       WH2           4.11             93     Customs Delay   
25  644  Route B       WH1           6.40            107     Customs Delay   
26  648  Route E       WH2           6.72            110           Traffic   
27  649  Route E       WH1           6.44             29           Traffic   
28  652  Route C       WH4           6.23             93           Weather   
29  653  Route E       WH3           4.80            100           Weather   
30  654  Route B       WH4           5.47            113           Traffic   
31  657  Route D       WH1           4.45             87           Traffic   
32  658  Route A       WH3           4.20             71   Minor Breakdown   
33  659  Route B       WH2           6.48            106  Mechanical Issue   
34  661  Route E       WH1           5.93             83           Traffic   
35  662  Route E       WH1           6.06            110           Weather   
36  663  Route B       WH4           4.98             98   Minor Breakdown   
37  664  Route A       WH1           5.09             50   Minor Breakdown   
38  667  Route A       WH3           4.22             97           Weather   
39  669  Route B       WH1           4.38             86           Weather   

         date  
0  2024-10-01  
1  2024-10-03  
2  2024-10-04  
3  2024-10-05  
4  2024-10-06  
5  2024-10-07  
6  2024-10-08  
7  2024-10-09  
8  2024-10-11  
9  2024-10-12  
10 2024-10-13  
11 2024-10-14  
12 2024-10-15  
13 2024-10-16  
14 2024-10-17  
15 2024-10-19  
16 2024-10-20  
17 2024-10-24  
18 2024-10-27  
19 2024-10-28  
20 2024-10-31  
21 2024-10-01  
22 2024-10-02  
23 2024-10-03  
24 2024-10-05  
25 2024-10-06  
26 2024-10-10  
27 2024-10-11  
28 2024-10-14  
29 2024-10-15  
30 2024-10-16  
31 2024-10-19  
32 2024-10-20  
33 2024-10-21  
34 2024-10-23  
35 2024-10-24  
36 2024-10-25  
37 2024-10-26  
38 2024-10-29  
39 2024-10-31  "
45,46,Show average delay per route in the last two weeks.,df['date']=pd.to_datetime(df['date']); maxd=df['date'].max(); window=df[(df['date']>maxd-pd.Timedelta(days=13))]; result = window.groupby('route')['delay_minutes'].mean(),"df['date']=pd.to_datetime(df['date'])
max_date = df['date'].max()
window = df[(df['date'] > max_date - pd.Timedelta(days=13))]
result = window.groupby('route')['delay_minutes'].mean().reset_index()
","route
Route A    43.333333
Route B    44.500000
Route C    30.600000
Route D    97.200000
Route E    48.000000
Name: delay_minutes, dtype: float64","     route  avg_delay_minutes
0  Route D          81.000000
1  Route B          50.200000
2  Route E          49.714286
3  Route C          43.500000
4  Route A          43.333333"
46,47,List top 5 routes with longest delays this quarter.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     route  total_delay_minutes
0  Route E               2264.0
1  Route B               2228.0
2  Route D               2143.0
3  Route A               1230.0
4  Route C               1230.0"
47,48,Predict next week's delay rate using historical averages.,df['date']=pd.to_datetime(df['date']); last_28=df[df['date']>df['date'].max()-pd.Timedelta(days=27)]; result = (last_28['delay_minutes']>0).mean(),"df['date']=pd.to_datetime(df['date'])
max_date = df['date'].max()
last_28 = df[df['date'] > max_date - pd.Timedelta(days=27)]
result = (last_28['delay_minutes'] > 0).mean()
",0.8333333333333334,63.55
48,49,Find routes where delivery time is rising but delay minutes are decreasing.,"df['date']=pd.to_datetime(df['date']); result = []
# compute monthly trend per route
monthly_dt = df.set_index(pd.to_datetime(df['date'])).groupby('route')['delivery_time'].resample('M').mean().unstack(0)
monthly_delay = df.set_index(pd.to_datetime(df['date'])).groupby('route')['delay_minutes'].resample('M').mean().unstack(0)
for col in monthly_dt.columns:
    if monthly_dt[col].iloc[-1] > monthly_dt[col].iloc[0] and monthly_delay[col].iloc[-1] < monthly_delay[col].iloc[0]:
        result.append(col)","df['date']=pd.to_datetime(df['date'])
monthly_dt = df.set_index('date').groupby('route')['delivery_time'].resample('M').mean().unstack(0)
monthly_delay = df.set_index('date').groupby('route')['delay_minutes'].resample('M').mean().unstack(0)
trend_dt = (monthly_dt.iloc[-1] - monthly_dt.iloc[0]) > 0
trend_delay = (monthly_delay.iloc[-1] - monthly_delay.iloc[0]) < 0
result = list(monthly_dt.columns[trend_dt & trend_delay])
","['Route A', 'Route C', 'Route D']","     route  avg_delivery_time  avg_delay_minutes
0  Route C           5.573716          52.672131
1  Route A           5.546961          52.823529
2  Route D           5.461773          50.344828
3  Route E           5.453333          54.366197
4  Route B           5.438376          53.649746"
49,50,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
50,51,Which route had the most Driver Rest delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most 'Driver Rest' delays is: Route B.
51,52,What is the average delivery_time for Route A?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.546960784313725
52,53,Which route had the most Weather delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most Weather delays is 'Route A' with 33 delays.
53,54,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  total_delay_minutes  total_shipments  daily_delay_rate
0  2024-12-16                 60.0                2              30.0
1  2024-12-17                181.0                2              90.5
2  2024-12-18                105.0                2              52.5
3  2024-12-19                127.0                2              63.5
4  2024-12-20                142.0                2              71.0
5  2024-12-21                134.0                2              67.0
6  2024-12-22                 88.0                2              44.0
7  2024-12-23                 20.0                2              10.0
8  2024-12-24                 90.0                2              45.0
9  2024-12-25                122.0                2              61.0
10 2024-12-26                 27.0                2              13.5
11 2024-12-27                 68.0                2              34.0
12 2024-12-28                143.0                2              71.5
13 2024-12-29                 84.0                2              42.0
14 2024-12-30                215.0                2             107.5"
54,55,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  rolling_avg_delay
0  2024-01-01          56.000000
1  2024-01-01          43.500000
2  2024-01-02          46.000000
3  2024-01-02          34.500000
4  2024-01-02          45.000000
..        ...                ...
87 2024-01-30          27.857143
88 2024-01-30          32.142857
89 2024-01-31          22.571429
90 2024-01-31          32.285714
91 2024-01-31          29.428571

[92 rows x 2 columns]"
55,56,List shipments in June with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0   153  Route B       WH1           5.17             71   Minor Breakdown   
1   154  Route B       WH3           6.01             73   Minor Breakdown   
2   156  Route C       WH4           5.02            105           Traffic   
3   159  Route D       WH2           4.32            109     Customs Delay   
4   162  Route A       WH3           4.73             61           Traffic   
5   163  Route E       WH4           4.24            117       Driver Rest   
6   164  Route E       WH1           4.20             85     Customs Delay   
7   165  Route C       WH1           4.99             94           Traffic   
8   167  Route C       WH1           5.28             74       Driver Rest   
9   171  Route E       WH4           6.89             48   Minor Breakdown   
10  173  Route D       WH4           5.21            112           Traffic   
11  174  Route E       WH3           5.31             73           Weather   
12  175  Route C       WH1           6.76             52     Customs Delay   
13  176  Route D       WH3           6.24             41     Customs Delay   
14  177  Route E       WH3           4.51            116           Weather   
15  179  Route E       WH3           5.71            105  Mechanical Issue   
16  180  Route B       WH1           4.43             76           Traffic   
17  181  Route A       WH1           4.84            109       Driver Rest   
18  517  Route C       WH1           4.54             61           Traffic   
19  518  Route E       WH3           6.92            120     Customs Delay   
20  519  Route E       WH4           5.29             53   Minor Breakdown   
21  520  Route B       WH3           6.56             98       Driver Rest   
22  521  Route A       WH1           4.81             99     Customs Delay   
23  522  Route C       WH2           5.42            117           Traffic   
24  523  Route B       WH4           4.01             98           Traffic   
25  529  Route E       WH3           4.54             76           Traffic   
26  531  Route B       WH4           4.14             55       Driver Rest   
27  532  Route B       WH1           6.93             44       Driver Rest   
28  533  Route E       WH3           6.79             69  Mechanical Issue   
29  535  Route E       WH1           5.21             61       Driver Rest   
30  536  Route E       WH3           6.66             97           Traffic   
31  537  Route E       WH2           5.34             32     Customs Delay   
32  540  Route E       WH1           5.65             79  Mechanical Issue   
33  541  Route D       WH1           4.93             79           Weather   
34  546  Route A       WH1           6.98            106       Driver Rest   
35  882  Route A       WH4           4.18             87       Driver Rest   
36  884  Route B       WH1           4.93             85  Mechanical Issue   
37  886  Route A       WH1           4.50             67           Traffic   
38  889  Route E       WH4           5.18             69  Mechanical Issue   
39  890  Route C       WH1           4.90             48   Minor Breakdown   
40  893  Route A       WH1           5.31             89           Weather   
41  894  Route E       WH1           4.48             94   Minor Breakdown   
42  897  Route E       WH2           6.50            120     Customs Delay   
43  898  Route C       WH2           4.28             66  Mechanical Issue   
44  899  Route B       WH3           4.54            120     Customs Delay   
45  900  Route A       WH4           4.08             95  Mechanical Issue   
46  901  Route C       WH3           6.14            112           Traffic   
47  902  Route D       WH4           4.84             67     Customs Delay   
48  903  Route B       WH4           6.86             40  Mechanical Issue   
49  906  Route C       WH2           4.47            115           Traffic   
50  907  Route C       WH1           4.10             81   Minor Breakdown   
51  908  Route B       WH3           5.08             71   Minor Breakdown   
52  909  Route E       WH2           5.32             82           Weather   
53  910  Route A       WH2           5.33             47       Driver Rest   
54  911  Route B       WH2           6.48            110     Customs Delay   

         date  
0  2024-06-02  
1  2024-06-03  
2  2024-06-05  
3  2024-06-08  
4  2024-06-11  
5  2024-06-12  
6  2024-06-13  
7  2024-06-14  
8  2024-06-16  
9  2024-06-20  
10 2024-06-22  
11 2024-06-23  
12 2024-06-24  
13 2024-06-25  
14 2024-06-26  
15 2024-06-28  
16 2024-06-29  
17 2024-06-30  
18 2024-06-01  
19 2024-06-02  
20 2024-06-03  
21 2024-06-04  
22 2024-06-05  
23 2024-06-06  
24 2024-06-07  
25 2024-06-13  
26 2024-06-15  
27 2024-06-16  
28 2024-06-17  
29 2024-06-19  
30 2024-06-20  
31 2024-06-21  
32 2024-06-24  
33 2024-06-25  
34 2024-06-30  
35 2024-06-01  
36 2024-06-03  
37 2024-06-05  
38 2024-06-08  
39 2024-06-09  
40 2024-06-12  
41 2024-06-13  
42 2024-06-16  
43 2024-06-17  
44 2024-06-18  
45 2024-06-19  
46 2024-06-20  
47 2024-06-21  
48 2024-06-22  
49 2024-06-25  
50 2024-06-26  
51 2024-06-27  
52 2024-06-28  
53 2024-06-29  
54 2024-06-30  "
56,57,What is the average delivery_time for Route A?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.546960784313725
57,58,List shipments in February with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0    32  Route D       WH2           6.78             51           Weather   
1    33  Route E       WH3           5.89             59     Customs Delay   
2    36  Route C       WH3           6.08             99           Weather   
3    37  Route B       WH4           6.25             79     Customs Delay   
4    39  Route E       WH3           4.93             84           Weather   
5    40  Route C       WH4           6.79            118  Mechanical Issue   
6    42  Route D       WH1           5.54             67           Weather   
7    44  Route C       WH3           4.88            107     Customs Delay   
8    48  Route A       WH1           4.12             41   Minor Breakdown   
9    49  Route E       WH1           6.15             60       Driver Rest   
10   52  Route C       WH1           4.98             69  Mechanical Issue   
11   53  Route B       WH3           6.61             78           Traffic   
12   54  Route E       WH3           6.41             96     Customs Delay   
13   56  Route B       WH2           5.97             91           Weather   
14   57  Route E       WH3           4.60            118           Traffic   
15   58  Route B       WH1           6.25             88           Traffic   
16   59  Route E       WH3           6.10             82       Driver Rest   
17  398  Route E       WH4           4.20            115       Driver Rest   
18  399  Route D       WH1           4.27            109       Driver Rest   
19  402  Route E       WH4           5.70             99   Minor Breakdown   
20  403  Route C       WH2           6.45             63   Minor Breakdown   
21  404  Route C       WH4           5.98             59           Weather   
22  405  Route B       WH2           4.33            116           Traffic   
23  406  Route E       WH1           6.65             61           Weather   
24  407  Route A       WH1           5.55             74  Mechanical Issue   
25  409  Route B       WH2           5.34             54  Mechanical Issue   
26  411  Route E       WH2           4.57            114       Driver Rest   
27  413  Route B       WH2           6.76             46           Traffic   
28  414  Route E       WH3           5.53             63     Customs Delay   
29  416  Route A       WH1           5.95             98       Driver Rest   
30  417  Route A       WH2           4.63             54           Weather   
31  418  Route E       WH2           6.21             54           Traffic   
32  419  Route A       WH3           4.06             32           Weather   
33  421  Route C       WH1           6.84             91   Minor Breakdown   
34  422  Route D       WH1           4.77             53   Minor Breakdown   
35  423  Route D       WH4           6.95             70           Weather   
36  424  Route E       WH3           5.95             71   Minor Breakdown   
37  761  Route E       WH4           4.78             96     Customs Delay   
38  762  Route A       WH2           6.98             80     Customs Delay   
39  763  Route A       WH2           5.26             98           Weather   
40  766  Route E       WH3           4.69             38  Mechanical Issue   
41  767  Route D       WH1           5.63            114       Driver Rest   
42  769  Route B       WH2           5.97             90       Driver Rest   
43  770  Route C       WH4           5.70             60   Minor Breakdown   
44  772  Route C       WH2           6.01             44       Driver Rest   
45  773  Route C       WH1           6.55             31  Mechanical Issue   
46  774  Route D       WH2           5.02             77  Mechanical Issue   
47  775  Route D       WH1           4.23             74       Driver Rest   
48  776  Route E       WH2           5.24             57   Minor Breakdown   
49  777  Route C       WH2           4.96            104   Minor Breakdown   
50  778  Route C       WH1           6.68             62       Driver Rest   
51  780  Route E       WH3           4.43            104       Driver Rest   
52  782  Route E       WH4           5.10             98           Weather   
53  784  Route A       WH4           5.84            116           Weather   
54  785  Route A       WH1           6.10             71  Mechanical Issue   
55  786  Route A       WH2           4.07             76   Minor Breakdown   
56  787  Route B       WH3           6.91             92       Driver Rest   

         date  
0  2024-02-02  
1  2024-02-03  
2  2024-02-06  
3  2024-02-07  
4  2024-02-09  
5  2024-02-10  
6  2024-02-12  
7  2024-02-14  
8  2024-02-18  
9  2024-02-19  
10 2024-02-22  
11 2024-02-23  
12 2024-02-24  
13 2024-02-26  
14 2024-02-27  
15 2024-02-28  
16 2024-02-29  
17 2024-02-03  
18 2024-02-04  
19 2024-02-07  
20 2024-02-08  
21 2024-02-09  
22 2024-02-10  
23 2024-02-11  
24 2024-02-12  
25 2024-02-14  
26 2024-02-16  
27 2024-02-18  
28 2024-02-19  
29 2024-02-21  
30 2024-02-22  
31 2024-02-23  
32 2024-02-24  
33 2024-02-26  
34 2024-02-27  
35 2024-02-28  
36 2024-02-29  
37 2024-02-01  
38 2024-02-02  
39 2024-02-03  
40 2024-02-06  
41 2024-02-07  
42 2024-02-09  
43 2024-02-10  
44 2024-02-12  
45 2024-02-13  
46 2024-02-14  
47 2024-02-15  
48 2024-02-16  
49 2024-02-17  
50 2024-02-18  
51 2024-02-20  
52 2024-02-22  
53 2024-02-24  
54 2024-02-25  
55 2024-02-26  
56 2024-02-27  "
58,59,What is the average delivery_time for Route E?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.45333333333333
59,60,Which route had the most Driver Rest delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most 'Driver Rest' delays is Route B.
60,61,List shipments in February with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","Empty DataFrame
Columns: [id, route, warehouse, delivery_time, delay_minutes, delay_reason, date]
Index: []"
61,62,List shipments in June with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","Empty DataFrame
Columns: [id, route, warehouse, delivery_time, delay_minutes, delay_reason, date]
Index: []"
62,63,Which route had the most Customs Delay delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most Customs Delay delays is: Route E.
63,64,Which route had the longest average delay in July?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in July is Route C.
64,65,Show correlation between delivery_time and delay_minutes for Route C.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,0.006022704518866803
65,66,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The day with the highest average delay minutes is 2024-04-29 00:00:00.
66,67,Which route had the most Driver Rest delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most 'Driver Rest' delays is Route B.
67,68,Show correlation between delivery_time and delay_minutes for Route B.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,0.05088014220470247
68,69,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  avg_delay_minutes
0  2024-12-16               30.0
1  2024-12-17               90.5
2  2024-12-18               52.5
3  2024-12-19               63.5
4  2024-12-20               71.0
5  2024-12-21               67.0
6  2024-12-22               44.0
7  2024-12-23               10.0
8  2024-12-24               45.0
9  2024-12-25               61.0
10 2024-12-26               13.5
11 2024-12-27               34.0
12 2024-12-28               71.5
13 2024-12-29               42.0
14 2024-12-30              107.5"
69,70,What was the average delay in August?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",55.41935483870968
70,71,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","          date  rolling_7_day_avg_delay
0   2024-01-01                56.000000
1   2024-01-01                43.500000
2   2024-01-02                46.000000
3   2024-01-02                34.500000
4   2024-01-02                45.000000
..         ...                      ...
995 2024-12-28                44.142857
996 2024-12-29                40.571429
997 2024-12-29                42.142857
998 2024-12-30                59.000000
999 2024-12-30                64.000000

[1000 rows x 2 columns]"
71,72,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  rolling_avg_delay
0  2024-01-01          56.000000
1  2024-01-01          43.500000
2  2024-01-02          46.000000
3  2024-01-02          34.500000
4  2024-01-02          45.000000
5  2024-01-03          45.000000
6  2024-01-03          55.142857
7  2024-01-03          50.428571
8  2024-01-04          62.142857
9  2024-01-04          61.000000
10 2024-01-04          62.428571
11 2024-01-05          54.571429
12 2024-01-05          48.142857
13 2024-01-05          44.142857
14 2024-01-06          58.000000
15 2024-01-06          52.142857
16 2024-01-06          56.142857
17 2024-01-07          70.714286
18 2024-01-07          79.571429
19 2024-01-07          94.857143"
72,73,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay_minutes
0  Route E              11580.0
1  Route A              10776.0
2  Route B              10569.0"
73,74,How many shipments from WH1 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",227
74,75,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
75,76,Which warehouse had the most shipments in March?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in March is WH1.
76,77,Show correlation between delivery_time and delay_minutes for Route C.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,0.006022704518866803
77,78,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay_minutes
0  Route E              11580.0
1  Route A              10776.0
2  Route B              10569.0"
78,79,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  rolling_7_day_avg
0  2024-01-01          56.000000
1  2024-01-01          43.500000
2  2024-01-02          46.000000
3  2024-01-02          34.500000
4  2024-01-02          45.000000
5  2024-01-03          45.000000
6  2024-01-03          55.142857
7  2024-01-03          50.428571
8  2024-01-04          62.142857
9  2024-01-04          61.000000
10 2024-01-04          62.428571
11 2024-01-05          54.571429
12 2024-01-05          48.142857
13 2024-01-05          44.142857
14 2024-01-06          58.000000
15 2024-01-06          52.142857
16 2024-01-06          56.142857"
79,80,What is the average delivery_time for Route C?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.573715846994536
80,81,Show correlation between delivery_time and delay_minutes for Route A.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,-0.02936237135725956
81,82,What is the average delivery_time for Route B?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.438375634517766
82,83,Show delay reason counts for WH3.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0       Driver Rest     39
1              None     39
2           Weather     38
3  Mechanical Issue     37
4     Customs Delay     35
5   Minor Breakdown     29
6           Traffic     25"
83,84,Which route had the most Mechanical Issue delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most Mechanical Issue delays is 'Route D' with 41 delays.
84,85,What was the average delay in February?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",54.50574712643678
85,86,Which route had the most None delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most None delays is Route A.
86,87,Which route had the most None delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most None delays is: Route A
87,88,How many shipments from WH2 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",193
88,89,Which route had the longest average delay in August?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in August is Route B.
89,90,Which route had the longest average delay in August?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in August is 'Route B' with an average delay of 65.5 minutes.
90,91,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  rolling_7_day_avg_delay
0  2024-01-01                56.000000
1  2024-01-01                43.500000
2  2024-01-02                46.000000
3  2024-01-02                34.500000
4  2024-01-02                45.000000
..        ...                      ...
87 2024-01-30                27.857143
88 2024-01-30                32.142857
89 2024-01-31                22.571429
90 2024-01-31                32.285714
91 2024-01-31                29.428571

[92 rows x 2 columns]"
91,92,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
92,93,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The day of the week with the highest average delay minutes is Thursday.
93,94,What was the average delay in April?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",56.81111111111111
94,95,Which warehouse had the most shipments in May?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","Unfortunately, I was not able to get your answer. Please try again."
95,96,Which route had the most Minor Breakdown delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most Minor Breakdown delays is: Route E.
96,97,How many shipments from WH1 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",227
97,98,How many shipments occurred on Mondays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",144
98,99,Show delay reason counts for WH4.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0           Traffic     52
1              None     43
2   Minor Breakdown     38
3  Mechanical Issue     35
4       Driver Rest     32
5           Weather     28
6     Customs Delay     22"
99,100,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","          date  rolling_7_day_avg
0   2024-01-01          56.000000
1   2024-01-01          43.500000
2   2024-01-02          46.000000
3   2024-01-02          34.500000
4   2024-01-02          45.000000
..         ...                ...
995 2024-12-28          44.142857
996 2024-12-29          40.571429
997 2024-12-29          42.142857
998 2024-12-30          59.000000
999 2024-12-30          64.000000

[1000 rows x 2 columns]"
100,101,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  delay_minutes  rolling_7_day_avg
0  2024-12-24             21          21.000000
1  2024-12-24             69          45.000000
2  2024-12-25             51          47.000000
3  2024-12-25             71          53.000000
4  2024-12-26             27          47.800000
5  2024-12-26              0          39.833333
6  2024-12-27             62          43.000000
7  2024-12-27              6          40.857143
8  2024-12-28            117          47.714286
9  2024-12-28             26          44.142857
10 2024-12-29             46          40.571429
11 2024-12-29             38          42.142857
12 2024-12-30            118          59.000000
13 2024-12-30             97          64.000000"
101,102,How many shipments from WH1 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",227
102,103,Which warehouse had the most shipments in February?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in February is WH2.
103,104,Show delay reason counts for WH1.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0              None     45
1           Traffic     45
2  Mechanical Issue     41
3       Driver Rest     39
4   Minor Breakdown     37
5           Weather     34
6     Customs Delay     31"
104,105,Which route had the most Customs Delay delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most Customs Delay delays is Route E.
105,106,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay_minutes
0  Route E              11580.0
1  Route A              10776.0
2  Route B              10569.0"
106,107,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay
0  Route E      11580.0
1  Route A      10776.0
2  Route B      10569.0"
107,108,What was the average delay in March?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",46.623655913978496
108,109,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
109,110,Which warehouse had the most shipments in April?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","Unfortunately, I was not able to get your answer. Please try again."
110,111,List shipments in April with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes     delay_reason  \
0    91  Route A       WH3           6.87             58    Customs Delay   
1    94  Route E       WH3           4.79             72  Minor Breakdown   
2    95  Route D       WH4           5.00             87  Minor Breakdown   
3    97  Route A       WH4           4.80             41    Customs Delay   
4    98  Route E       WH1           5.56             83          Weather   
..  ...      ...       ...            ...            ...              ...   
57  846  Route D       WH4           6.20            111          Traffic   
58  847  Route A       WH1           5.77             43          Weather   
59  848  Route D       WH4           4.08            102    Customs Delay   
60  849  Route E       WH3           4.34            115          Traffic   
61  850  Route C       WH1           5.92             56    Customs Delay   

         date  
0  2024-04-01  
1  2024-04-04  
2  2024-04-05  
3  2024-04-07  
4  2024-04-08  
..        ...  
57 2024-04-26  
58 2024-04-27  
59 2024-04-28  
60 2024-04-29  
61 2024-04-30  

[62 rows x 7 columns]"
111,112,List shipments in September with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","      id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0    245  Route C       WH4           4.35             80     Customs Delay   
1    248  Route B       WH2           6.33             50   Minor Breakdown   
2    249  Route A       WH3           5.46             90           Weather   
3    250  Route E       WH1           6.64             80           Weather   
4    251  Route C       WH2           4.47            107           Traffic   
5    252  Route A       WH4           6.26             72           Traffic   
6    253  Route D       WH3           6.22             60           Traffic   
7    254  Route C       WH1           4.35            104       Driver Rest   
8    258  Route E       WH4           6.34             95           Traffic   
9    259  Route B       WH3           5.89             34     Customs Delay   
10   262  Route B       WH2           6.87            112       Driver Rest   
11   263  Route B       WH4           4.31             69       Driver Rest   
12   265  Route A       WH3           6.94             63     Customs Delay   
13   269  Route B       WH1           6.35             63   Minor Breakdown   
14   270  Route D       WH2           6.61             92     Customs Delay   
15   271  Route D       WH3           4.98             75  Mechanical Issue   
16   273  Route D       WH3           6.10             60           Weather   
17   610  Route D       WH3           4.07             97     Customs Delay   
18   611  Route A       WH4           4.95             92           Weather   
19   612  Route A       WH1           4.27             70     Customs Delay   
20   614  Route B       WH1           5.47             84     Customs Delay   
21   615  Route A       WH1           4.72             94  Mechanical Issue   
22   616  Route B       WH2           6.46            109           Weather   
23   617  Route E       WH1           6.66            107   Minor Breakdown   
24   620  Route D       WH2           6.78            112           Weather   
25   621  Route C       WH3           4.48            112   Minor Breakdown   
26   622  Route D       WH1           6.51             98           Traffic   
27   624  Route C       WH3           5.65             54  Mechanical Issue   
28   626  Route B       WH2           5.98             76  Mechanical Issue   
29   628  Route D       WH4           5.21            107   Minor Breakdown   
30   630  Route E       WH4           6.94             79       Driver Rest   
31   632  Route D       WH1           6.58             88  Mechanical Issue   
32   634  Route C       WH1           5.34             52     Customs Delay   
33   635  Route A       WH4           5.31             33           Traffic   
34   637  Route D       WH4           5.24            111       Driver Rest   
35   638  Route A       WH3           6.59             33  Mechanical Issue   
36   976  Route D       WH4           5.29             54           Weather   
37   979  Route E       WH4           5.63            120           Traffic   
38   980  Route A       WH3           4.73            112       Driver Rest   
39   981  Route A       WH4           6.53             90  Mechanical Issue   
40   982  Route B       WH3           6.42             65       Driver Rest   
41   983  Route C       WH1           5.83             71   Minor Breakdown   
42   984  Route B       WH4           5.03             74   Minor Breakdown   
43   986  Route D       WH3           6.06             69  Mechanical Issue   
44   987  Route D       WH1           4.83             46           Weather   
45   989  Route B       WH4           4.33            100  Mechanical Issue   
46   991  Route A       WH2           6.02             80  Mechanical Issue   
47   992  Route D       WH3           4.02             37     Customs Delay   
48   993  Route D       WH1           6.03             65           Traffic   
49   994  Route D       WH1           5.00             80  Mechanical Issue   
50   995  Route A       WH4           6.35             57           Traffic   
51   996  Route B       WH2           5.60            118           Weather   
52   997  Route E       WH4           5.00             83       Driver Rest   
53   998  Route B       WH4           5.45             52       Driver Rest   
54   999  Route E       WH4           5.61            117           Traffic   
55  1000  Route B       WH3           5.52            105  Mechanical Issue   

         date  
0  2024-09-02  
1  2024-09-05  
2  2024-09-06  
3  2024-09-07  
4  2024-09-08  
5  2024-09-09  
6  2024-09-10  
7  2024-09-11  
8  2024-09-15  
9  2024-09-16  
10 2024-09-19  
11 2024-09-20  
12 2024-09-22  
13 2024-09-26  
14 2024-09-27  
15 2024-09-28  
16 2024-09-30  
17 2024-09-02  
18 2024-09-03  
19 2024-09-04  
20 2024-09-06  
21 2024-09-07  
22 2024-09-08  
23 2024-09-09  
24 2024-09-12  
25 2024-09-13  
26 2024-09-14  
27 2024-09-16  
28 2024-09-18  
29 2024-09-20  
30 2024-09-22  
31 2024-09-24  
32 2024-09-26  
33 2024-09-27  
34 2024-09-29  
35 2024-09-30  
36 2024-09-03  
37 2024-09-06  
38 2024-09-07  
39 2024-09-08  
40 2024-09-09  
41 2024-09-10  
42 2024-09-11  
43 2024-09-13  
44 2024-09-14  
45 2024-09-16  
46 2024-09-18  
47 2024-09-19  
48 2024-09-20  
49 2024-09-21  
50 2024-09-22  
51 2024-09-23  
52 2024-09-24  
53 2024-09-25  
54 2024-09-26  
55 2024-09-27  "
112,113,List shipments in November with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","Empty DataFrame
Columns: [id, route, warehouse, delivery_time, delay_minutes, delay_reason, date]
Index: []"
113,114,Show correlation between delivery_time and delay_minutes for Route C.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,0.006022704518866803
114,115,Which route had the longest average delay in October?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in October is Route B.
115,116,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  total_delay_minutes  total_shipments  daily_delay_rate
0  2024-12-30                215.0                2             107.5
1  2024-12-29                 84.0                2              42.0
2  2024-12-28                143.0                2              71.5
3  2024-12-27                 68.0                2              34.0
4  2024-12-26                 27.0                2              13.5
5  2024-12-25                122.0                2              61.0
6  2024-12-24                 90.0                2              45.0
7  2024-12-23                 20.0                2              10.0
8  2024-12-22                 88.0                2              44.0
9  2024-12-21                134.0                2              67.0
10 2024-12-20                142.0                2              71.0
11 2024-12-19                127.0                2              63.5
12 2024-12-18                105.0                2              52.5
13 2024-12-17                181.0                2              90.5
14 2024-12-16                 60.0                2              30.0"
116,117,List shipments in January with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0     1  Route C       WH2           4.88             51     Customs Delay   
1     2  Route A       WH4           4.77             45       Driver Rest   
2     3  Route C       WH4           5.31            113           Traffic   
3     4  Route B       WH4           5.83             32   Minor Breakdown   
4     5  Route C       WH4           6.13            120           Traffic   
5     6  Route E       WH2           5.51            112     Customs Delay   
6     9  Route E       WH2           4.73             49   Minor Breakdown   
7    10  Route E       WH4           5.60             58     Customs Delay   
8    11  Route A       WH2           4.75             93           Weather   
9    13  Route A       WH4           4.63             77   Minor Breakdown   
10   14  Route A       WH4           6.44            119   Minor Breakdown   
11   15  Route A       WH4           5.58            104           Weather   
12   16  Route A       WH3           4.90            119     Customs Delay   
13   17  Route C       WH4           4.25             38   Minor Breakdown   
14   18  Route E       WH3           6.53             87   Minor Breakdown   
15   20  Route B       WH2           5.64            109       Driver Rest   
16   21  Route A       WH2           5.25             68  Mechanical Issue   
17   23  Route E       WH2           6.37             45   Minor Breakdown   
18   24  Route D       WH1           4.53            114       Driver Rest   
19   25  Route A       WH3           6.95             88  Mechanical Issue   
20   26  Route C       WH3           6.11             86       Driver Rest   
21   27  Route C       WH3           6.40             60           Traffic   
22   29  Route A       WH2           4.70             88       Driver Rest   
23  365  Route E       WH4           5.48             56   Minor Breakdown   
24  367  Route D       WH1           4.08            116           Weather   
25  368  Route C       WH2           4.20             43     Customs Delay   
26  370  Route E       WH1           4.56             72           Weather   
27  371  Route B       WH1           4.32             94  Mechanical Issue   
28  374  Route C       WH2           6.03             39   Minor Breakdown   
29  376  Route A       WH3           5.62             67           Traffic   
30  377  Route E       WH4           6.21             41           Traffic   
31  379  Route A       WH3           4.96             75           Weather   
32  381  Route A       WH2           5.51             83     Customs Delay   
33  384  Route E       WH1           4.28             32       Driver Rest   
34  385  Route C       WH1           4.39            120           Traffic   
35  388  Route B       WH3           5.06             60     Customs Delay   
36  389  Route B       WH2           5.78             76   Minor Breakdown   
37  390  Route C       WH3           6.29             90       Driver Rest   
38  391  Route C       WH4           4.08             80           Traffic   
39  395  Route B       WH1           6.39             68       Driver Rest   
40  730  Route B       WH2           4.19             31       Driver Rest   
41  731  Route E       WH3           6.62             87  Mechanical Issue   
42  734  Route B       WH3           6.46             88   Minor Breakdown   
43  735  Route B       WH2           6.65             71           Weather   
44  736  Route A       WH4           5.41            107           Traffic   
45  739  Route D       WH1           6.91            117           Weather   
46  740  Route D       WH2           5.47            110     Customs Delay   
47  741  Route A       WH4           4.11            107           Traffic   
48  742  Route D       WH3           4.24             48       Driver Rest   
49  743  Route C       WH1           6.10             95   Minor Breakdown   
50  744  Route E       WH2           6.84             75           Weather   
51  747  Route C       WH4           4.57            106           Weather   
52  748  Route A       WH2           6.35             57           Traffic   
53  749  Route A       WH2           4.61             72   Minor Breakdown   
54  750  Route C       WH3           6.87             72   Minor Breakdown   
55  753  Route A       WH1           6.10             63           Weather   
56  754  Route C       WH1           4.68             46           Traffic   
57  755  Route B       WH1           4.24             76       Driver Rest   
58  757  Route E       WH1           4.40             67  Mechanical Issue   

         date  
0  2024-01-02  
1  2024-01-03  
2  2024-01-04  
3  2024-01-05  
4  2024-01-06  
5  2024-01-07  
6  2024-01-10  
7  2024-01-11  
8  2024-01-12  
9  2024-01-14  
10 2024-01-15  
11 2024-01-16  
12 2024-01-17  
13 2024-01-18  
14 2024-01-19  
15 2024-01-21  
16 2024-01-22  
17 2024-01-24  
18 2024-01-25  
19 2024-01-26  
20 2024-01-27  
21 2024-01-28  
22 2024-01-30  
23 2024-01-01  
24 2024-01-03  
25 2024-01-04  
26 2024-01-06  
27 2024-01-07  
28 2024-01-10  
29 2024-01-12  
30 2024-01-13  
31 2024-01-15  
32 2024-01-17  
33 2024-01-20  
34 2024-01-21  
35 2024-01-24  
36 2024-01-25  
37 2024-01-26  
38 2024-01-27  
39 2024-01-31  
40 2024-01-01  
41 2024-01-02  
42 2024-01-05  
43 2024-01-06  
44 2024-01-07  
45 2024-01-10  
46 2024-01-11  
47 2024-01-12  
48 2024-01-13  
49 2024-01-14  
50 2024-01-15  
51 2024-01-18  
52 2024-01-19  
53 2024-01-20  
54 2024-01-21  
55 2024-01-24  
56 2024-01-25  
57 2024-01-26  
58 2024-01-28  "
117,118,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
118,119,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  rolling_7_day_avg
0  2024-01-01          56.000000
1  2024-01-01          43.500000
2  2024-01-02          46.000000
3  2024-01-02          34.500000
4  2024-01-02          45.000000
5  2024-01-03          45.000000
6  2024-01-03          55.142857
7  2024-01-03          50.428571
8  2024-01-04          62.142857
9  2024-01-04          61.000000
10 2024-01-04          62.428571
11 2024-01-05          54.571429
12 2024-01-05          48.142857
13 2024-01-05          44.142857
14 2024-01-06          58.000000
15 2024-01-06          52.142857
16 2024-01-06          56.142857"
119,120,Which route had the longest average delay in February?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in February is 'Route E' with an average delay of 66.73913043478261 minutes.
120,121,Show correlation between delivery_time and delay_minutes for Route E.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,0.00567882444538465
121,122,Which route had the longest average delay in January?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in January is Route D.
122,123,What was the average delay in November?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",51.03333333333333
123,124,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
124,125,How many shipments occurred on Sundays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",142
125,126,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  rolling_7_day_avg_delay
0  2024-01-01                56.000000
1  2024-01-01                43.500000
2  2024-01-02                46.000000
3  2024-01-02                34.500000
4  2024-01-02                45.000000
..        ...                      ...
87 2024-01-30                27.857143
88 2024-01-30                32.142857
89 2024-01-31                22.571429
90 2024-01-31                32.285714
91 2024-01-31                29.428571

[92 rows x 2 columns]"
126,127,Show correlation between delivery_time and delay_minutes for Route D.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,-0.04930486211843905
127,128,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  total_delay_minutes  total_shipments  daily_delay_rate
0  2024-12-16                 60.0                2              30.0
1  2024-12-17                181.0                2              90.5
2  2024-12-18                105.0                2              52.5
3  2024-12-19                127.0                2              63.5
4  2024-12-20                142.0                2              71.0
5  2024-12-21                134.0                2              67.0
6  2024-12-22                 88.0                2              44.0
7  2024-12-23                 20.0                2              10.0
8  2024-12-24                 90.0                2              45.0
9  2024-12-25                122.0                2              61.0
10 2024-12-26                 27.0                2              13.5
11 2024-12-27                 68.0                2              34.0
12 2024-12-28                143.0                2              71.5
13 2024-12-29                 84.0                2              42.0
14 2024-12-30                215.0                2             107.5"
128,129,How many shipments occurred on Sundays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",142
129,130,Show correlation between delivery_time and delay_minutes for Route C.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,0.006022704518866803
130,131,How many shipments from WH2 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",193
131,132,What is the average delivery_time for Route C?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.573715846994536
132,133,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
133,134,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay_minutes
0  Route E              11580.0
1  Route A              10776.0
2  Route B              10569.0"
134,135,What was the average delay in September?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",56.0919540229885
135,136,How many shipments occurred on Thursdays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
136,137,How many shipments from WH2 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",193
137,138,Show correlation between delivery_time and delay_minutes for Route E.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,0.00567882444538465
138,139,What is the average delivery_time for Route E?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.45333333333333
139,140,What was the average delay in March?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",46.623655913978496
140,141,How many shipments occurred on Wednesdays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",12
141,142,How many shipments occurred on Thursdays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
142,143,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","          date  rolling_7_day_avg_delay
0   2024-01-01                56.000000
1   2024-01-01                43.500000
2   2024-01-02                46.000000
3   2024-01-02                34.500000
4   2024-01-02                45.000000
..         ...                      ...
995 2024-12-28                44.142857
996 2024-12-29                40.571429
997 2024-12-29                42.142857
998 2024-12-30                59.000000
999 2024-12-30                64.000000

[1000 rows x 2 columns]"
143,144,Which route had the most Driver Rest delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most 'Driver Rest' delays is: Route B.
144,145,Which route had the longest average delay in April?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in April is 'Route D' with an average delay of 65.55555555555556 minutes.
145,146,List shipments in January with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0     1  Route C       WH2           4.88             51     Customs Delay   
1     2  Route A       WH4           4.77             45       Driver Rest   
2     3  Route C       WH4           5.31            113           Traffic   
3     4  Route B       WH4           5.83             32   Minor Breakdown   
4     5  Route C       WH4           6.13            120           Traffic   
5     6  Route E       WH2           5.51            112     Customs Delay   
6     9  Route E       WH2           4.73             49   Minor Breakdown   
7    10  Route E       WH4           5.60             58     Customs Delay   
8    11  Route A       WH2           4.75             93           Weather   
9    13  Route A       WH4           4.63             77   Minor Breakdown   
10   14  Route A       WH4           6.44            119   Minor Breakdown   
11   15  Route A       WH4           5.58            104           Weather   
12   16  Route A       WH3           4.90            119     Customs Delay   
13   17  Route C       WH4           4.25             38   Minor Breakdown   
14   18  Route E       WH3           6.53             87   Minor Breakdown   
15   20  Route B       WH2           5.64            109       Driver Rest   
16   21  Route A       WH2           5.25             68  Mechanical Issue   
17   23  Route E       WH2           6.37             45   Minor Breakdown   
18   24  Route D       WH1           4.53            114       Driver Rest   
19   25  Route A       WH3           6.95             88  Mechanical Issue   
20   26  Route C       WH3           6.11             86       Driver Rest   
21   27  Route C       WH3           6.40             60           Traffic   
22   29  Route A       WH2           4.70             88       Driver Rest   
23  365  Route E       WH4           5.48             56   Minor Breakdown   
24  367  Route D       WH1           4.08            116           Weather   
25  368  Route C       WH2           4.20             43     Customs Delay   
26  370  Route E       WH1           4.56             72           Weather   
27  371  Route B       WH1           4.32             94  Mechanical Issue   
28  374  Route C       WH2           6.03             39   Minor Breakdown   
29  376  Route A       WH3           5.62             67           Traffic   
30  377  Route E       WH4           6.21             41           Traffic   
31  379  Route A       WH3           4.96             75           Weather   
32  381  Route A       WH2           5.51             83     Customs Delay   
33  384  Route E       WH1           4.28             32       Driver Rest   
34  385  Route C       WH1           4.39            120           Traffic   
35  388  Route B       WH3           5.06             60     Customs Delay   
36  389  Route B       WH2           5.78             76   Minor Breakdown   
37  390  Route C       WH3           6.29             90       Driver Rest   
38  391  Route C       WH4           4.08             80           Traffic   
39  395  Route B       WH1           6.39             68       Driver Rest   
40  730  Route B       WH2           4.19             31       Driver Rest   
41  731  Route E       WH3           6.62             87  Mechanical Issue   
42  734  Route B       WH3           6.46             88   Minor Breakdown   
43  735  Route B       WH2           6.65             71           Weather   
44  736  Route A       WH4           5.41            107           Traffic   
45  739  Route D       WH1           6.91            117           Weather   
46  740  Route D       WH2           5.47            110     Customs Delay   
47  741  Route A       WH4           4.11            107           Traffic   
48  742  Route D       WH3           4.24             48       Driver Rest   
49  743  Route C       WH1           6.10             95   Minor Breakdown   
50  744  Route E       WH2           6.84             75           Weather   
51  747  Route C       WH4           4.57            106           Weather   
52  748  Route A       WH2           6.35             57           Traffic   
53  749  Route A       WH2           4.61             72   Minor Breakdown   
54  750  Route C       WH3           6.87             72   Minor Breakdown   
55  753  Route A       WH1           6.10             63           Weather   
56  754  Route C       WH1           4.68             46           Traffic   
57  755  Route B       WH1           4.24             76       Driver Rest   
58  757  Route E       WH1           4.40             67  Mechanical Issue   

         date  
0  2024-01-02  
1  2024-01-03  
2  2024-01-04  
3  2024-01-05  
4  2024-01-06  
5  2024-01-07  
6  2024-01-10  
7  2024-01-11  
8  2024-01-12  
9  2024-01-14  
10 2024-01-15  
11 2024-01-16  
12 2024-01-17  
13 2024-01-18  
14 2024-01-19  
15 2024-01-21  
16 2024-01-22  
17 2024-01-24  
18 2024-01-25  
19 2024-01-26  
20 2024-01-27  
21 2024-01-28  
22 2024-01-30  
23 2024-01-01  
24 2024-01-03  
25 2024-01-04  
26 2024-01-06  
27 2024-01-07  
28 2024-01-10  
29 2024-01-12  
30 2024-01-13  
31 2024-01-15  
32 2024-01-17  
33 2024-01-20  
34 2024-01-21  
35 2024-01-24  
36 2024-01-25  
37 2024-01-26  
38 2024-01-27  
39 2024-01-31  
40 2024-01-01  
41 2024-01-02  
42 2024-01-05  
43 2024-01-06  
44 2024-01-07  
45 2024-01-10  
46 2024-01-11  
47 2024-01-12  
48 2024-01-13  
49 2024-01-14  
50 2024-01-15  
51 2024-01-18  
52 2024-01-19  
53 2024-01-20  
54 2024-01-21  
55 2024-01-24  
56 2024-01-25  
57 2024-01-26  
58 2024-01-28  "
146,147,Which route had the most Minor Breakdown delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most Minor Breakdown delays is Route E.
147,148,How many shipments occurred on Tuesdays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
148,149,Show delay reason counts for WH1.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0           Traffic     45
1              None     45
2  Mechanical Issue     41
3       Driver Rest     39
4   Minor Breakdown     37
5           Weather     34
6     Customs Delay     31"
149,150,Show delay reason counts for WH4.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0           Traffic     52
1              None     43
2   Minor Breakdown     38
3  Mechanical Issue     35
4       Driver Rest     32
5           Weather     28
6     Customs Delay     22"
150,151,What is the average delivery_time for Route B?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.438375634517766
151,152,Which route had the longest average delay in December?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in December is 'Route D' with an average delay of 57.875 minutes.
152,153,How many shipments occurred on Thursdays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
153,154,List shipments in September with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","      id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0    245  Route C       WH4           4.35             80     Customs Delay   
1    248  Route B       WH2           6.33             50   Minor Breakdown   
2    249  Route A       WH3           5.46             90           Weather   
3    250  Route E       WH1           6.64             80           Weather   
4    251  Route C       WH2           4.47            107           Traffic   
5    252  Route A       WH4           6.26             72           Traffic   
6    253  Route D       WH3           6.22             60           Traffic   
7    254  Route C       WH1           4.35            104       Driver Rest   
8    258  Route E       WH4           6.34             95           Traffic   
9    259  Route B       WH3           5.89             34     Customs Delay   
10   262  Route B       WH2           6.87            112       Driver Rest   
11   263  Route B       WH4           4.31             69       Driver Rest   
12   265  Route A       WH3           6.94             63     Customs Delay   
13   269  Route B       WH1           6.35             63   Minor Breakdown   
14   270  Route D       WH2           6.61             92     Customs Delay   
15   271  Route D       WH3           4.98             75  Mechanical Issue   
16   273  Route D       WH3           6.10             60           Weather   
17   610  Route D       WH3           4.07             97     Customs Delay   
18   611  Route A       WH4           4.95             92           Weather   
19   612  Route A       WH1           4.27             70     Customs Delay   
20   614  Route B       WH1           5.47             84     Customs Delay   
21   615  Route A       WH1           4.72             94  Mechanical Issue   
22   616  Route B       WH2           6.46            109           Weather   
23   617  Route E       WH1           6.66            107   Minor Breakdown   
24   620  Route D       WH2           6.78            112           Weather   
25   621  Route C       WH3           4.48            112   Minor Breakdown   
26   622  Route D       WH1           6.51             98           Traffic   
27   624  Route C       WH3           5.65             54  Mechanical Issue   
28   626  Route B       WH2           5.98             76  Mechanical Issue   
29   628  Route D       WH4           5.21            107   Minor Breakdown   
30   630  Route E       WH4           6.94             79       Driver Rest   
31   632  Route D       WH1           6.58             88  Mechanical Issue   
32   634  Route C       WH1           5.34             52     Customs Delay   
33   635  Route A       WH4           5.31             33           Traffic   
34   637  Route D       WH4           5.24            111       Driver Rest   
35   638  Route A       WH3           6.59             33  Mechanical Issue   
36   976  Route D       WH4           5.29             54           Weather   
37   979  Route E       WH4           5.63            120           Traffic   
38   980  Route A       WH3           4.73            112       Driver Rest   
39   981  Route A       WH4           6.53             90  Mechanical Issue   
40   982  Route B       WH3           6.42             65       Driver Rest   
41   983  Route C       WH1           5.83             71   Minor Breakdown   
42   984  Route B       WH4           5.03             74   Minor Breakdown   
43   986  Route D       WH3           6.06             69  Mechanical Issue   
44   987  Route D       WH1           4.83             46           Weather   
45   989  Route B       WH4           4.33            100  Mechanical Issue   
46   991  Route A       WH2           6.02             80  Mechanical Issue   
47   992  Route D       WH3           4.02             37     Customs Delay   
48   993  Route D       WH1           6.03             65           Traffic   
49   994  Route D       WH1           5.00             80  Mechanical Issue   
50   995  Route A       WH4           6.35             57           Traffic   
51   996  Route B       WH2           5.60            118           Weather   
52   997  Route E       WH4           5.00             83       Driver Rest   
53   998  Route B       WH4           5.45             52       Driver Rest   
54   999  Route E       WH4           5.61            117           Traffic   
55  1000  Route B       WH3           5.52            105  Mechanical Issue   

         date  
0  2024-09-02  
1  2024-09-05  
2  2024-09-06  
3  2024-09-07  
4  2024-09-08  
5  2024-09-09  
6  2024-09-10  
7  2024-09-11  
8  2024-09-15  
9  2024-09-16  
10 2024-09-19  
11 2024-09-20  
12 2024-09-22  
13 2024-09-26  
14 2024-09-27  
15 2024-09-28  
16 2024-09-30  
17 2024-09-02  
18 2024-09-03  
19 2024-09-04  
20 2024-09-06  
21 2024-09-07  
22 2024-09-08  
23 2024-09-09  
24 2024-09-12  
25 2024-09-13  
26 2024-09-14  
27 2024-09-16  
28 2024-09-18  
29 2024-09-20  
30 2024-09-22  
31 2024-09-24  
32 2024-09-26  
33 2024-09-27  
34 2024-09-29  
35 2024-09-30  
36 2024-09-03  
37 2024-09-06  
38 2024-09-07  
39 2024-09-08  
40 2024-09-09  
41 2024-09-10  
42 2024-09-11  
43 2024-09-13  
44 2024-09-14  
45 2024-09-16  
46 2024-09-18  
47 2024-09-19  
48 2024-09-20  
49 2024-09-21  
50 2024-09-22  
51 2024-09-23  
52 2024-09-24  
53 2024-09-25  
54 2024-09-26  
55 2024-09-27  "
154,155,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
155,156,List shipments in June with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0   153  Route B       WH1           5.17             71   Minor Breakdown   
1   154  Route B       WH3           6.01             73   Minor Breakdown   
2   156  Route C       WH4           5.02            105           Traffic   
3   159  Route D       WH2           4.32            109     Customs Delay   
4   162  Route A       WH3           4.73             61           Traffic   
5   163  Route E       WH4           4.24            117       Driver Rest   
6   164  Route E       WH1           4.20             85     Customs Delay   
7   165  Route C       WH1           4.99             94           Traffic   
8   167  Route C       WH1           5.28             74       Driver Rest   
9   171  Route E       WH4           6.89             48   Minor Breakdown   
10  173  Route D       WH4           5.21            112           Traffic   
11  174  Route E       WH3           5.31             73           Weather   
12  175  Route C       WH1           6.76             52     Customs Delay   
13  176  Route D       WH3           6.24             41     Customs Delay   
14  177  Route E       WH3           4.51            116           Weather   
15  179  Route E       WH3           5.71            105  Mechanical Issue   
16  180  Route B       WH1           4.43             76           Traffic   
17  181  Route A       WH1           4.84            109       Driver Rest   
18  517  Route C       WH1           4.54             61           Traffic   
19  518  Route E       WH3           6.92            120     Customs Delay   
20  519  Route E       WH4           5.29             53   Minor Breakdown   
21  520  Route B       WH3           6.56             98       Driver Rest   
22  521  Route A       WH1           4.81             99     Customs Delay   
23  522  Route C       WH2           5.42            117           Traffic   
24  523  Route B       WH4           4.01             98           Traffic   
25  529  Route E       WH3           4.54             76           Traffic   
26  531  Route B       WH4           4.14             55       Driver Rest   
27  532  Route B       WH1           6.93             44       Driver Rest   
28  533  Route E       WH3           6.79             69  Mechanical Issue   
29  535  Route E       WH1           5.21             61       Driver Rest   
30  536  Route E       WH3           6.66             97           Traffic   
31  537  Route E       WH2           5.34             32     Customs Delay   
32  540  Route E       WH1           5.65             79  Mechanical Issue   
33  541  Route D       WH1           4.93             79           Weather   
34  546  Route A       WH1           6.98            106       Driver Rest   
35  882  Route A       WH4           4.18             87       Driver Rest   
36  884  Route B       WH1           4.93             85  Mechanical Issue   
37  886  Route A       WH1           4.50             67           Traffic   
38  889  Route E       WH4           5.18             69  Mechanical Issue   
39  890  Route C       WH1           4.90             48   Minor Breakdown   
40  893  Route A       WH1           5.31             89           Weather   
41  894  Route E       WH1           4.48             94   Minor Breakdown   
42  897  Route E       WH2           6.50            120     Customs Delay   
43  898  Route C       WH2           4.28             66  Mechanical Issue   
44  899  Route B       WH3           4.54            120     Customs Delay   
45  900  Route A       WH4           4.08             95  Mechanical Issue   
46  901  Route C       WH3           6.14            112           Traffic   
47  902  Route D       WH4           4.84             67     Customs Delay   
48  903  Route B       WH4           6.86             40  Mechanical Issue   
49  906  Route C       WH2           4.47            115           Traffic   
50  907  Route C       WH1           4.10             81   Minor Breakdown   
51  908  Route B       WH3           5.08             71   Minor Breakdown   
52  909  Route E       WH2           5.32             82           Weather   
53  910  Route A       WH2           5.33             47       Driver Rest   
54  911  Route B       WH2           6.48            110     Customs Delay   

         date  
0  2024-06-02  
1  2024-06-03  
2  2024-06-05  
3  2024-06-08  
4  2024-06-11  
5  2024-06-12  
6  2024-06-13  
7  2024-06-14  
8  2024-06-16  
9  2024-06-20  
10 2024-06-22  
11 2024-06-23  
12 2024-06-24  
13 2024-06-25  
14 2024-06-26  
15 2024-06-28  
16 2024-06-29  
17 2024-06-30  
18 2024-06-01  
19 2024-06-02  
20 2024-06-03  
21 2024-06-04  
22 2024-06-05  
23 2024-06-06  
24 2024-06-07  
25 2024-06-13  
26 2024-06-15  
27 2024-06-16  
28 2024-06-17  
29 2024-06-19  
30 2024-06-20  
31 2024-06-21  
32 2024-06-24  
33 2024-06-25  
34 2024-06-30  
35 2024-06-01  
36 2024-06-03  
37 2024-06-05  
38 2024-06-08  
39 2024-06-09  
40 2024-06-12  
41 2024-06-13  
42 2024-06-16  
43 2024-06-17  
44 2024-06-18  
45 2024-06-19  
46 2024-06-20  
47 2024-06-21  
48 2024-06-22  
49 2024-06-25  
50 2024-06-26  
51 2024-06-27  
52 2024-06-28  
53 2024-06-29  
54 2024-06-30  "
156,157,What is the average delivery_time for Route B?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.438375634517766
157,158,Show delay reason counts for WH2.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0              None     43
1           Weather     37
2           Traffic     35
3       Driver Rest     35
4  Mechanical Issue     30
5   Minor Breakdown     29
6     Customs Delay     27"
158,159,Which route had the longest average delay in April?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in April is 'Route D' with an average delay of 65.55555555555556 minutes.
159,160,How many shipments occurred on Sundays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",142
160,161,Show correlation between delivery_time and delay_minutes for Route D.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,-0.04930486211843905
161,162,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  rolling_7_day_avg
0  2024-01-01          56.000000
1  2024-01-01          43.500000
2  2024-01-02          46.000000
3  2024-01-02          34.500000
4  2024-01-02          45.000000
5  2024-01-03          45.000000
6  2024-01-03          55.142857
7  2024-01-03          50.428571
8  2024-01-04          62.142857
9  2024-01-04          61.000000
10 2024-01-04          62.428571
11 2024-01-05          54.571429
12 2024-01-05          48.142857
13 2024-01-05          44.142857
14 2024-01-06          58.000000
15 2024-01-06          52.142857
16 2024-01-06          56.142857"
162,163,Which route had the longest average delay in May?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in May is 'Route B' with an average delay of 58.35 minutes.
163,164,Which warehouse had the most shipments in November?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",No shipments were recorded in November.
164,165,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","          date  rolling_7_day_avg
0   2024-01-01          56.000000
1   2024-01-01          43.500000
2   2024-01-02          46.000000
3   2024-01-02          34.500000
4   2024-01-02          45.000000
..         ...                ...
995 2024-12-28          44.142857
996 2024-12-29          40.571429
997 2024-12-29          42.142857
998 2024-12-30          59.000000
999 2024-12-30          64.000000

[1000 rows x 2 columns]"
165,166,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay_minutes
0  Route E              11580.0
1  Route A              10776.0
2  Route B              10569.0"
166,167,How many shipments from WH1 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",227
167,168,How many shipments from WH3 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",203
168,169,What was the average delay in July?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",56.40860215053763
169,170,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The day of the week with the highest average delay minutes is Thursday.
170,171,How many shipments from WH3 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",203
171,172,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
172,173,How many shipments from WH2 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",193
173,174,What is the average delivery_time for Route D?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.461773399014778
174,175,What was the average delay in December?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",48.95
175,176,What is the average delivery_time for Route C?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.573715846994536
176,177,Show correlation between delivery_time and delay_minutes for Route E.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,0.00567882444538465
177,178,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  total_delay_minutes  total_shipments  daily_delay_rate
0  2024-12-30                215.0                2             107.5
1  2024-12-29                 84.0                2              42.0
2  2024-12-28                143.0                2              71.5
3  2024-12-27                 68.0                2              34.0
4  2024-12-26                 27.0                2              13.5
5  2024-12-25                122.0                2              61.0
6  2024-12-24                 90.0                2              45.0
7  2024-12-23                 20.0                2              10.0
8  2024-12-22                 88.0                2              44.0
9  2024-12-21                134.0                2              67.0
10 2024-12-20                142.0                2              71.0
11 2024-12-19                127.0                2              63.5
12 2024-12-18                105.0                2              52.5
13 2024-12-17                181.0                2              90.5
14 2024-12-16                 60.0                2              30.0"
178,179,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
179,180,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
180,181,Which route had the longest average delay in September?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in September is 'Route B' with an average of 64.11111111111111 minutes.
181,182,What was the average delay in August?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",55.41935483870968
182,183,How many shipments occurred on Thursdays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
183,184,Show delay reason counts for WH3.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0       Driver Rest     39
1              None     39
2           Weather     38
3  Mechanical Issue     37
4     Customs Delay     35
5   Minor Breakdown     29
6           Traffic     25"
184,185,Which warehouse had the most shipments in December?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in December is WH4.
185,186,List shipments in February with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0    32  Route D       WH2           6.78             51           Weather   
1    33  Route E       WH3           5.89             59     Customs Delay   
2    36  Route C       WH3           6.08             99           Weather   
3    37  Route B       WH4           6.25             79     Customs Delay   
4    39  Route E       WH3           4.93             84           Weather   
5    40  Route C       WH4           6.79            118  Mechanical Issue   
6    42  Route D       WH1           5.54             67           Weather   
7    44  Route C       WH3           4.88            107     Customs Delay   
8    48  Route A       WH1           4.12             41   Minor Breakdown   
9    49  Route E       WH1           6.15             60       Driver Rest   
10   52  Route C       WH1           4.98             69  Mechanical Issue   
11   53  Route B       WH3           6.61             78           Traffic   
12   54  Route E       WH3           6.41             96     Customs Delay   
13   56  Route B       WH2           5.97             91           Weather   
14   57  Route E       WH3           4.60            118           Traffic   
15   58  Route B       WH1           6.25             88           Traffic   
16   59  Route E       WH3           6.10             82       Driver Rest   
17  398  Route E       WH4           4.20            115       Driver Rest   
18  399  Route D       WH1           4.27            109       Driver Rest   
19  402  Route E       WH4           5.70             99   Minor Breakdown   
20  403  Route C       WH2           6.45             63   Minor Breakdown   
21  404  Route C       WH4           5.98             59           Weather   
22  405  Route B       WH2           4.33            116           Traffic   
23  406  Route E       WH1           6.65             61           Weather   
24  407  Route A       WH1           5.55             74  Mechanical Issue   
25  409  Route B       WH2           5.34             54  Mechanical Issue   
26  411  Route E       WH2           4.57            114       Driver Rest   
27  413  Route B       WH2           6.76             46           Traffic   
28  414  Route E       WH3           5.53             63     Customs Delay   
29  416  Route A       WH1           5.95             98       Driver Rest   
30  417  Route A       WH2           4.63             54           Weather   
31  418  Route E       WH2           6.21             54           Traffic   
32  419  Route A       WH3           4.06             32           Weather   
33  421  Route C       WH1           6.84             91   Minor Breakdown   
34  422  Route D       WH1           4.77             53   Minor Breakdown   
35  423  Route D       WH4           6.95             70           Weather   
36  424  Route E       WH3           5.95             71   Minor Breakdown   
37  761  Route E       WH4           4.78             96     Customs Delay   
38  762  Route A       WH2           6.98             80     Customs Delay   
39  763  Route A       WH2           5.26             98           Weather   
40  766  Route E       WH3           4.69             38  Mechanical Issue   
41  767  Route D       WH1           5.63            114       Driver Rest   
42  769  Route B       WH2           5.97             90       Driver Rest   
43  770  Route C       WH4           5.70             60   Minor Breakdown   
44  772  Route C       WH2           6.01             44       Driver Rest   
45  773  Route C       WH1           6.55             31  Mechanical Issue   
46  774  Route D       WH2           5.02             77  Mechanical Issue   
47  775  Route D       WH1           4.23             74       Driver Rest   
48  776  Route E       WH2           5.24             57   Minor Breakdown   
49  777  Route C       WH2           4.96            104   Minor Breakdown   
50  778  Route C       WH1           6.68             62       Driver Rest   
51  780  Route E       WH3           4.43            104       Driver Rest   
52  782  Route E       WH4           5.10             98           Weather   
53  784  Route A       WH4           5.84            116           Weather   
54  785  Route A       WH1           6.10             71  Mechanical Issue   
55  786  Route A       WH2           4.07             76   Minor Breakdown   
56  787  Route B       WH3           6.91             92       Driver Rest   

         date  
0  2024-02-02  
1  2024-02-03  
2  2024-02-06  
3  2024-02-07  
4  2024-02-09  
5  2024-02-10  
6  2024-02-12  
7  2024-02-14  
8  2024-02-18  
9  2024-02-19  
10 2024-02-22  
11 2024-02-23  
12 2024-02-24  
13 2024-02-26  
14 2024-02-27  
15 2024-02-28  
16 2024-02-29  
17 2024-02-03  
18 2024-02-04  
19 2024-02-07  
20 2024-02-08  
21 2024-02-09  
22 2024-02-10  
23 2024-02-11  
24 2024-02-12  
25 2024-02-14  
26 2024-02-16  
27 2024-02-18  
28 2024-02-19  
29 2024-02-21  
30 2024-02-22  
31 2024-02-23  
32 2024-02-24  
33 2024-02-26  
34 2024-02-27  
35 2024-02-28  
36 2024-02-29  
37 2024-02-01  
38 2024-02-02  
39 2024-02-03  
40 2024-02-06  
41 2024-02-07  
42 2024-02-09  
43 2024-02-10  
44 2024-02-12  
45 2024-02-13  
46 2024-02-14  
47 2024-02-15  
48 2024-02-16  
49 2024-02-17  
50 2024-02-18  
51 2024-02-20  
52 2024-02-22  
53 2024-02-24  
54 2024-02-25  
55 2024-02-26  
56 2024-02-27  "
186,187,Show correlation between delivery_time and delay_minutes for Route B.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,0.05088014220470247
187,188,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay_minutes
0  Route E              11580.0
1  Route A              10776.0
2  Route B              10569.0"
188,189,What was the average delay in June?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",54.144444444444446
189,190,List shipments in December with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0   337  Route D       WH3           4.71             75           Traffic   
1   338  Route D       WH2           5.96             53       Driver Rest   
2   339  Route D       WH4           6.19             33  Mechanical Issue   
3   340  Route C       WH1           5.88             89       Driver Rest   
4   341  Route B       WH4           6.47             44           Traffic   
5   342  Route B       WH4           6.43             78  Mechanical Issue   
6   343  Route D       WH3           4.15            101           Traffic   
7   346  Route B       WH4           7.00             73     Customs Delay   
8   347  Route B       WH3           5.88             42  Mechanical Issue   
9   348  Route D       WH1           5.78             45           Traffic   
10  351  Route B       WH3           6.82             73           Traffic   
11  353  Route A       WH3           5.28             34       Driver Rest   
12  354  Route E       WH4           4.01            118   Minor Breakdown   
13  355  Route B       WH4           6.18             34     Customs Delay   
14  359  Route C       WH4           6.27             51           Traffic   
15  361  Route E       WH2           6.38             62     Customs Delay   
16  362  Route D       WH2           5.65            117           Weather   
17  363  Route A       WH3           5.72             46           Weather   
18  364  Route B       WH1           4.46            118           Traffic   
19  700  Route A       WH1           6.46             68  Mechanical Issue   
20  701  Route D       WH3           6.95             92  Mechanical Issue   
21  704  Route C       WH4           6.79             34   Minor Breakdown   
22  705  Route A       WH3           5.05             61           Weather   
23  707  Route B       WH2           5.05             57           Weather   
24  709  Route E       WH4           6.33            118           Traffic   
25  710  Route E       WH1           5.64             52  Mechanical Issue   
26  711  Route A       WH2           6.46            100       Driver Rest   
27  712  Route B       WH2           5.99             31           Weather   
28  714  Route D       WH1           6.07             41           Weather   
29  715  Route E       WH4           5.82             60           Traffic   
30  716  Route C       WH2           6.64            108           Weather   
31  717  Route D       WH2           4.47            105  Mechanical Issue   
32  718  Route D       WH3           6.02             93           Weather   
33  720  Route D       WH3           4.49            100  Mechanical Issue   
34  721  Route E       WH2           5.26             58   Minor Breakdown   
35  723  Route C       WH4           5.08             69           Traffic   
36  724  Route D       WH1           6.23             71           Weather   
37  728  Route A       WH1           5.35             38           Traffic   
38  729  Route A       WH4           6.65             97       Driver Rest   

         date  
0  2024-12-03  
1  2024-12-04  
2  2024-12-05  
3  2024-12-06  
4  2024-12-07  
5  2024-12-08  
6  2024-12-09  
7  2024-12-12  
8  2024-12-13  
9  2024-12-14  
10 2024-12-17  
11 2024-12-19  
12 2024-12-20  
13 2024-12-21  
14 2024-12-25  
15 2024-12-27  
16 2024-12-28  
17 2024-12-29  
18 2024-12-30  
19 2024-12-01  
20 2024-12-02  
21 2024-12-05  
22 2024-12-06  
23 2024-12-08  
24 2024-12-10  
25 2024-12-11  
26 2024-12-12  
27 2024-12-13  
28 2024-12-15  
29 2024-12-16  
30 2024-12-17  
31 2024-12-18  
32 2024-12-19  
33 2024-12-21  
34 2024-12-22  
35 2024-12-24  
36 2024-12-25  
37 2024-12-29  
38 2024-12-30  "
190,191,Which route had the longest average delay in February?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in February is 'Route E' with an average delay of 66.73913043478261 minutes.
191,192,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  total_delay_minutes  total_shipments  daily_delay_rate
0  2024-12-30                215.0                2             107.5
1  2024-12-29                 84.0                2              42.0
2  2024-12-28                143.0                2              71.5
3  2024-12-27                 68.0                2              34.0
4  2024-12-26                 27.0                2              13.5
5  2024-12-25                122.0                2              61.0
6  2024-12-24                 90.0                2              45.0
7  2024-12-23                 20.0                2              10.0
8  2024-12-22                 88.0                2              44.0
9  2024-12-21                134.0                2              67.0
10 2024-12-20                142.0                2              71.0
11 2024-12-19                127.0                2              63.5
12 2024-12-18                105.0                2              52.5
13 2024-12-17                181.0                2              90.5
14 2024-12-16                 60.0                2              30.0"
192,193,Which warehouse had the most shipments in January?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in January is WH3.
193,194,List shipments in April with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes     delay_reason  \
0    91  Route A       WH3           6.87             58    Customs Delay   
1    94  Route E       WH3           4.79             72  Minor Breakdown   
2    95  Route D       WH4           5.00             87  Minor Breakdown   
3    97  Route A       WH4           4.80             41    Customs Delay   
4    98  Route E       WH1           5.56             83          Weather   
..  ...      ...       ...            ...            ...              ...   
57  846  Route D       WH4           6.20            111          Traffic   
58  847  Route A       WH1           5.77             43          Weather   
59  848  Route D       WH4           4.08            102    Customs Delay   
60  849  Route E       WH3           4.34            115          Traffic   
61  850  Route C       WH1           5.92             56    Customs Delay   

         date  
0  2024-04-01  
1  2024-04-04  
2  2024-04-05  
3  2024-04-07  
4  2024-04-08  
..        ...  
57 2024-04-26  
58 2024-04-27  
59 2024-04-28  
60 2024-04-29  
61 2024-04-30  

[62 rows x 7 columns]"
194,195,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
195,196,How many shipments occurred on Wednesdays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
196,197,List shipments in December with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","Unfortunately, I was not able to get your answer. Please try again."
197,198,What was the average delay in December?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",48.95
198,199,Which route had the most Traffic delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most Traffic delays is Route E.
199,200,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","          date  rolling_7_day_avg_delay
0   2024-01-01                56.000000
1   2024-01-01                43.500000
2   2024-01-02                46.000000
3   2024-01-02                34.500000
4   2024-01-02                45.000000
..         ...                      ...
995 2024-12-28                44.142857
996 2024-12-29                40.571429
997 2024-12-29                42.142857
998 2024-12-30                59.000000
999 2024-12-30                64.000000

[1000 rows x 2 columns]"
200,201,Which route had the most Traffic delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most Traffic delays is Route E.
201,202,Which route had the longest average delay in January?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in January is 'Route D' with an average delay of 77.42857142857143 minutes.
202,203,List shipments in January with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0     1  Route C       WH2           4.88             51     Customs Delay   
1     2  Route A       WH4           4.77             45       Driver Rest   
2     3  Route C       WH4           5.31            113           Traffic   
3     4  Route B       WH4           5.83             32   Minor Breakdown   
4     5  Route C       WH4           6.13            120           Traffic   
5     6  Route E       WH2           5.51            112     Customs Delay   
6     9  Route E       WH2           4.73             49   Minor Breakdown   
7    10  Route E       WH4           5.60             58     Customs Delay   
8    11  Route A       WH2           4.75             93           Weather   
9    13  Route A       WH4           4.63             77   Minor Breakdown   
10   14  Route A       WH4           6.44            119   Minor Breakdown   
11   15  Route A       WH4           5.58            104           Weather   
12   16  Route A       WH3           4.90            119     Customs Delay   
13   17  Route C       WH4           4.25             38   Minor Breakdown   
14   18  Route E       WH3           6.53             87   Minor Breakdown   
15   20  Route B       WH2           5.64            109       Driver Rest   
16   21  Route A       WH2           5.25             68  Mechanical Issue   
17   23  Route E       WH2           6.37             45   Minor Breakdown   
18   24  Route D       WH1           4.53            114       Driver Rest   
19   25  Route A       WH3           6.95             88  Mechanical Issue   
20   26  Route C       WH3           6.11             86       Driver Rest   
21   27  Route C       WH3           6.40             60           Traffic   
22   29  Route A       WH2           4.70             88       Driver Rest   
23  365  Route E       WH4           5.48             56   Minor Breakdown   
24  367  Route D       WH1           4.08            116           Weather   
25  368  Route C       WH2           4.20             43     Customs Delay   
26  370  Route E       WH1           4.56             72           Weather   
27  371  Route B       WH1           4.32             94  Mechanical Issue   
28  374  Route C       WH2           6.03             39   Minor Breakdown   
29  376  Route A       WH3           5.62             67           Traffic   
30  377  Route E       WH4           6.21             41           Traffic   
31  379  Route A       WH3           4.96             75           Weather   
32  381  Route A       WH2           5.51             83     Customs Delay   
33  384  Route E       WH1           4.28             32       Driver Rest   
34  385  Route C       WH1           4.39            120           Traffic   
35  388  Route B       WH3           5.06             60     Customs Delay   
36  389  Route B       WH2           5.78             76   Minor Breakdown   
37  390  Route C       WH3           6.29             90       Driver Rest   
38  391  Route C       WH4           4.08             80           Traffic   
39  395  Route B       WH1           6.39             68       Driver Rest   
40  730  Route B       WH2           4.19             31       Driver Rest   
41  731  Route E       WH3           6.62             87  Mechanical Issue   
42  734  Route B       WH3           6.46             88   Minor Breakdown   
43  735  Route B       WH2           6.65             71           Weather   
44  736  Route A       WH4           5.41            107           Traffic   
45  739  Route D       WH1           6.91            117           Weather   
46  740  Route D       WH2           5.47            110     Customs Delay   
47  741  Route A       WH4           4.11            107           Traffic   
48  742  Route D       WH3           4.24             48       Driver Rest   
49  743  Route C       WH1           6.10             95   Minor Breakdown   
50  744  Route E       WH2           6.84             75           Weather   
51  747  Route C       WH4           4.57            106           Weather   
52  748  Route A       WH2           6.35             57           Traffic   
53  749  Route A       WH2           4.61             72   Minor Breakdown   
54  750  Route C       WH3           6.87             72   Minor Breakdown   
55  753  Route A       WH1           6.10             63           Weather   
56  754  Route C       WH1           4.68             46           Traffic   
57  755  Route B       WH1           4.24             76       Driver Rest   
58  757  Route E       WH1           4.40             67  Mechanical Issue   

         date  
0  2024-01-02  
1  2024-01-03  
2  2024-01-04  
3  2024-01-05  
4  2024-01-06  
5  2024-01-07  
6  2024-01-10  
7  2024-01-11  
8  2024-01-12  
9  2024-01-14  
10 2024-01-15  
11 2024-01-16  
12 2024-01-17  
13 2024-01-18  
14 2024-01-19  
15 2024-01-21  
16 2024-01-22  
17 2024-01-24  
18 2024-01-25  
19 2024-01-26  
20 2024-01-27  
21 2024-01-28  
22 2024-01-30  
23 2024-01-01  
24 2024-01-03  
25 2024-01-04  
26 2024-01-06  
27 2024-01-07  
28 2024-01-10  
29 2024-01-12  
30 2024-01-13  
31 2024-01-15  
32 2024-01-17  
33 2024-01-20  
34 2024-01-21  
35 2024-01-24  
36 2024-01-25  
37 2024-01-26  
38 2024-01-27  
39 2024-01-31  
40 2024-01-01  
41 2024-01-02  
42 2024-01-05  
43 2024-01-06  
44 2024-01-07  
45 2024-01-10  
46 2024-01-11  
47 2024-01-12  
48 2024-01-13  
49 2024-01-14  
50 2024-01-15  
51 2024-01-18  
52 2024-01-19  
53 2024-01-20  
54 2024-01-21  
55 2024-01-24  
56 2024-01-25  
57 2024-01-26  
58 2024-01-28  "
203,204,List shipments in June with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0   153  Route B       WH1           5.17             71   Minor Breakdown   
1   154  Route B       WH3           6.01             73   Minor Breakdown   
2   156  Route C       WH4           5.02            105           Traffic   
3   159  Route D       WH2           4.32            109     Customs Delay   
4   162  Route A       WH3           4.73             61           Traffic   
5   163  Route E       WH4           4.24            117       Driver Rest   
6   164  Route E       WH1           4.20             85     Customs Delay   
7   165  Route C       WH1           4.99             94           Traffic   
8   167  Route C       WH1           5.28             74       Driver Rest   
9   171  Route E       WH4           6.89             48   Minor Breakdown   
10  173  Route D       WH4           5.21            112           Traffic   
11  174  Route E       WH3           5.31             73           Weather   
12  175  Route C       WH1           6.76             52     Customs Delay   
13  176  Route D       WH3           6.24             41     Customs Delay   
14  177  Route E       WH3           4.51            116           Weather   
15  179  Route E       WH3           5.71            105  Mechanical Issue   
16  180  Route B       WH1           4.43             76           Traffic   
17  181  Route A       WH1           4.84            109       Driver Rest   
18  517  Route C       WH1           4.54             61           Traffic   
19  518  Route E       WH3           6.92            120     Customs Delay   
20  519  Route E       WH4           5.29             53   Minor Breakdown   
21  520  Route B       WH3           6.56             98       Driver Rest   
22  521  Route A       WH1           4.81             99     Customs Delay   
23  522  Route C       WH2           5.42            117           Traffic   
24  523  Route B       WH4           4.01             98           Traffic   
25  529  Route E       WH3           4.54             76           Traffic   
26  531  Route B       WH4           4.14             55       Driver Rest   
27  532  Route B       WH1           6.93             44       Driver Rest   
28  533  Route E       WH3           6.79             69  Mechanical Issue   
29  535  Route E       WH1           5.21             61       Driver Rest   
30  536  Route E       WH3           6.66             97           Traffic   
31  537  Route E       WH2           5.34             32     Customs Delay   
32  540  Route E       WH1           5.65             79  Mechanical Issue   
33  541  Route D       WH1           4.93             79           Weather   
34  546  Route A       WH1           6.98            106       Driver Rest   
35  882  Route A       WH4           4.18             87       Driver Rest   
36  884  Route B       WH1           4.93             85  Mechanical Issue   
37  886  Route A       WH1           4.50             67           Traffic   
38  889  Route E       WH4           5.18             69  Mechanical Issue   
39  890  Route C       WH1           4.90             48   Minor Breakdown   
40  893  Route A       WH1           5.31             89           Weather   
41  894  Route E       WH1           4.48             94   Minor Breakdown   
42  897  Route E       WH2           6.50            120     Customs Delay   
43  898  Route C       WH2           4.28             66  Mechanical Issue   
44  899  Route B       WH3           4.54            120     Customs Delay   
45  900  Route A       WH4           4.08             95  Mechanical Issue   
46  901  Route C       WH3           6.14            112           Traffic   
47  902  Route D       WH4           4.84             67     Customs Delay   
48  903  Route B       WH4           6.86             40  Mechanical Issue   
49  906  Route C       WH2           4.47            115           Traffic   
50  907  Route C       WH1           4.10             81   Minor Breakdown   
51  908  Route B       WH3           5.08             71   Minor Breakdown   
52  909  Route E       WH2           5.32             82           Weather   
53  910  Route A       WH2           5.33             47       Driver Rest   
54  911  Route B       WH2           6.48            110     Customs Delay   

         date  
0  2024-06-02  
1  2024-06-03  
2  2024-06-05  
3  2024-06-08  
4  2024-06-11  
5  2024-06-12  
6  2024-06-13  
7  2024-06-14  
8  2024-06-16  
9  2024-06-20  
10 2024-06-22  
11 2024-06-23  
12 2024-06-24  
13 2024-06-25  
14 2024-06-26  
15 2024-06-28  
16 2024-06-29  
17 2024-06-30  
18 2024-06-01  
19 2024-06-02  
20 2024-06-03  
21 2024-06-04  
22 2024-06-05  
23 2024-06-06  
24 2024-06-07  
25 2024-06-13  
26 2024-06-15  
27 2024-06-16  
28 2024-06-17  
29 2024-06-19  
30 2024-06-20  
31 2024-06-21  
32 2024-06-24  
33 2024-06-25  
34 2024-06-30  
35 2024-06-01  
36 2024-06-03  
37 2024-06-05  
38 2024-06-08  
39 2024-06-09  
40 2024-06-12  
41 2024-06-13  
42 2024-06-16  
43 2024-06-17  
44 2024-06-18  
45 2024-06-19  
46 2024-06-20  
47 2024-06-21  
48 2024-06-22  
49 2024-06-25  
50 2024-06-26  
51 2024-06-27  
52 2024-06-28  
53 2024-06-29  
54 2024-06-30  "
204,205,How many shipments from WH3 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",203
205,206,Which warehouse had the most shipments in November?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in November is WH4.
206,207,Show delay reason counts for WH2.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0              None     43
1           Weather     37
2       Driver Rest     35
3           Traffic     35
4  Mechanical Issue     30
5   Minor Breakdown     29
6     Customs Delay     27"
207,208,What is the average delivery_time for Route E?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.45333333333333
208,209,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","          date  rolling_7_day_avg_delay
0   2024-01-01                56.000000
1   2024-01-01                43.500000
2   2024-01-02                46.000000
3   2024-01-02                34.500000
4   2024-01-02                45.000000
..         ...                      ...
995 2024-12-28                44.142857
996 2024-12-29                40.571429
997 2024-12-29                42.142857
998 2024-12-30                59.000000
999 2024-12-30                64.000000

[1000 rows x 2 columns]"
209,210,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay_minutes
0  Route E              11580.0
1  Route A              10776.0
2  Route B              10569.0"
210,211,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay
0  Route E      11580.0
1  Route A      10776.0
2  Route B      10569.0"
211,212,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
212,213,What is the average delivery_time for Route A?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.546960784313725
213,214,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay
0  Route E      11580.0
1  Route A      10776.0
2  Route B      10569.0"
214,215,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  total_delay_minutes  total_shipments  daily_delay_rate
0  2024-12-30                215.0                2             107.5
1  2024-12-29                 84.0                2              42.0
2  2024-12-28                143.0                2              71.5
3  2024-12-27                 68.0                2              34.0
4  2024-12-26                 27.0                2              13.5
5  2024-12-25                122.0                2              61.0
6  2024-12-24                 90.0                2              45.0
7  2024-12-23                 20.0                2              10.0
8  2024-12-22                 88.0                2              44.0
9  2024-12-21                134.0                2              67.0
10 2024-12-20                142.0                2              71.0
11 2024-12-19                127.0                2              63.5
12 2024-12-18                105.0                2              52.5
13 2024-12-17                181.0                2              90.5
14 2024-12-16                 60.0                2              30.0"
215,216,Show correlation between delivery_time and delay_minutes for Route E.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,0.00567882444538465
216,217,What is the average delivery_time for Route B?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.438375634517766
217,218,How many shipments from WH2 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",193
218,219,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay_minutes
0  Route E              11580.0
1  Route A              10776.0
2  Route B              10569.0"
219,220,List shipments in September with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","      id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0    245  Route C       WH4           4.35             80     Customs Delay   
1    248  Route B       WH2           6.33             50   Minor Breakdown   
2    249  Route A       WH3           5.46             90           Weather   
3    250  Route E       WH1           6.64             80           Weather   
4    251  Route C       WH2           4.47            107           Traffic   
5    252  Route A       WH4           6.26             72           Traffic   
6    253  Route D       WH3           6.22             60           Traffic   
7    254  Route C       WH1           4.35            104       Driver Rest   
8    258  Route E       WH4           6.34             95           Traffic   
9    259  Route B       WH3           5.89             34     Customs Delay   
10   262  Route B       WH2           6.87            112       Driver Rest   
11   263  Route B       WH4           4.31             69       Driver Rest   
12   265  Route A       WH3           6.94             63     Customs Delay   
13   269  Route B       WH1           6.35             63   Minor Breakdown   
14   270  Route D       WH2           6.61             92     Customs Delay   
15   271  Route D       WH3           4.98             75  Mechanical Issue   
16   273  Route D       WH3           6.10             60           Weather   
17   610  Route D       WH3           4.07             97     Customs Delay   
18   611  Route A       WH4           4.95             92           Weather   
19   612  Route A       WH1           4.27             70     Customs Delay   
20   614  Route B       WH1           5.47             84     Customs Delay   
21   615  Route A       WH1           4.72             94  Mechanical Issue   
22   616  Route B       WH2           6.46            109           Weather   
23   617  Route E       WH1           6.66            107   Minor Breakdown   
24   620  Route D       WH2           6.78            112           Weather   
25   621  Route C       WH3           4.48            112   Minor Breakdown   
26   622  Route D       WH1           6.51             98           Traffic   
27   624  Route C       WH3           5.65             54  Mechanical Issue   
28   626  Route B       WH2           5.98             76  Mechanical Issue   
29   628  Route D       WH4           5.21            107   Minor Breakdown   
30   630  Route E       WH4           6.94             79       Driver Rest   
31   632  Route D       WH1           6.58             88  Mechanical Issue   
32   634  Route C       WH1           5.34             52     Customs Delay   
33   635  Route A       WH4           5.31             33           Traffic   
34   637  Route D       WH4           5.24            111       Driver Rest   
35   638  Route A       WH3           6.59             33  Mechanical Issue   
36   976  Route D       WH4           5.29             54           Weather   
37   979  Route E       WH4           5.63            120           Traffic   
38   980  Route A       WH3           4.73            112       Driver Rest   
39   981  Route A       WH4           6.53             90  Mechanical Issue   
40   982  Route B       WH3           6.42             65       Driver Rest   
41   983  Route C       WH1           5.83             71   Minor Breakdown   
42   984  Route B       WH4           5.03             74   Minor Breakdown   
43   986  Route D       WH3           6.06             69  Mechanical Issue   
44   987  Route D       WH1           4.83             46           Weather   
45   989  Route B       WH4           4.33            100  Mechanical Issue   
46   991  Route A       WH2           6.02             80  Mechanical Issue   
47   992  Route D       WH3           4.02             37     Customs Delay   
48   993  Route D       WH1           6.03             65           Traffic   
49   994  Route D       WH1           5.00             80  Mechanical Issue   
50   995  Route A       WH4           6.35             57           Traffic   
51   996  Route B       WH2           5.60            118           Weather   
52   997  Route E       WH4           5.00             83       Driver Rest   
53   998  Route B       WH4           5.45             52       Driver Rest   
54   999  Route E       WH4           5.61            117           Traffic   
55  1000  Route B       WH3           5.52            105  Mechanical Issue   

         date  
0  2024-09-02  
1  2024-09-05  
2  2024-09-06  
3  2024-09-07  
4  2024-09-08  
5  2024-09-09  
6  2024-09-10  
7  2024-09-11  
8  2024-09-15  
9  2024-09-16  
10 2024-09-19  
11 2024-09-20  
12 2024-09-22  
13 2024-09-26  
14 2024-09-27  
15 2024-09-28  
16 2024-09-30  
17 2024-09-02  
18 2024-09-03  
19 2024-09-04  
20 2024-09-06  
21 2024-09-07  
22 2024-09-08  
23 2024-09-09  
24 2024-09-12  
25 2024-09-13  
26 2024-09-14  
27 2024-09-16  
28 2024-09-18  
29 2024-09-20  
30 2024-09-22  
31 2024-09-24  
32 2024-09-26  
33 2024-09-27  
34 2024-09-29  
35 2024-09-30  
36 2024-09-03  
37 2024-09-06  
38 2024-09-07  
39 2024-09-08  
40 2024-09-09  
41 2024-09-10  
42 2024-09-11  
43 2024-09-13  
44 2024-09-14  
45 2024-09-16  
46 2024-09-18  
47 2024-09-19  
48 2024-09-20  
49 2024-09-21  
50 2024-09-22  
51 2024-09-23  
52 2024-09-24  
53 2024-09-25  
54 2024-09-26  
55 2024-09-27  "
220,221,Which warehouse had the most shipments in July?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in July is WH2.
221,222,What was the average delay in April?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","Unfortunately, I was not able to get your answer. Please try again."
222,223,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The day of the week with the highest average delay_minutes is Thursday with an average delay of 56.52 minutes.
223,224,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  rolling_7_day_avg_delay
0  2024-01-01                56.000000
1  2024-01-01                43.500000
2  2024-01-02                46.000000
3  2024-01-02                34.500000
4  2024-01-02                45.000000
..        ...                      ...
87 2024-01-30                27.857143
88 2024-01-30                32.142857
89 2024-01-31                22.571429
90 2024-01-31                32.285714
91 2024-01-31                29.428571

[92 rows x 2 columns]"
224,225,Show correlation between delivery_time and delay_minutes for Route B.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,0.05088014220470247
225,226,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  day_of_week  avg_delay_minutes
0    Thursday          56.517483"
226,227,What was the average delay in March?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",46.623655913978496
227,228,How many shipments occurred on Sundays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",142
228,229,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","          date  rolling_avg_delay
0   2024-01-01          56.000000
1   2024-01-01          43.500000
2   2024-01-02          46.000000
3   2024-01-02          34.500000
4   2024-01-02          45.000000
..         ...                ...
995 2024-12-28          44.142857
996 2024-12-29          40.571429
997 2024-12-29          42.142857
998 2024-12-30          59.000000
999 2024-12-30          64.000000

[1000 rows x 2 columns]"
229,230,What was the average delay in September?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",56.0919540229885
230,231,How many shipments from WH4 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",207
231,232,What was the average delay in January?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",53.380434782608695
232,233,List shipments in December with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0   337  Route D       WH3           4.71             75           Traffic   
1   338  Route D       WH2           5.96             53       Driver Rest   
2   339  Route D       WH4           6.19             33  Mechanical Issue   
3   340  Route C       WH1           5.88             89       Driver Rest   
4   341  Route B       WH4           6.47             44           Traffic   
5   342  Route B       WH4           6.43             78  Mechanical Issue   
6   343  Route D       WH3           4.15            101           Traffic   
7   346  Route B       WH4           7.00             73     Customs Delay   
8   347  Route B       WH3           5.88             42  Mechanical Issue   
9   348  Route D       WH1           5.78             45           Traffic   
10  351  Route B       WH3           6.82             73           Traffic   
11  353  Route A       WH3           5.28             34       Driver Rest   
12  354  Route E       WH4           4.01            118   Minor Breakdown   
13  355  Route B       WH4           6.18             34     Customs Delay   
14  359  Route C       WH4           6.27             51           Traffic   
15  361  Route E       WH2           6.38             62     Customs Delay   
16  362  Route D       WH2           5.65            117           Weather   
17  363  Route A       WH3           5.72             46           Weather   
18  364  Route B       WH1           4.46            118           Traffic   
19  700  Route A       WH1           6.46             68  Mechanical Issue   
20  701  Route D       WH3           6.95             92  Mechanical Issue   
21  704  Route C       WH4           6.79             34   Minor Breakdown   
22  705  Route A       WH3           5.05             61           Weather   
23  707  Route B       WH2           5.05             57           Weather   
24  709  Route E       WH4           6.33            118           Traffic   
25  710  Route E       WH1           5.64             52  Mechanical Issue   
26  711  Route A       WH2           6.46            100       Driver Rest   
27  712  Route B       WH2           5.99             31           Weather   
28  714  Route D       WH1           6.07             41           Weather   
29  715  Route E       WH4           5.82             60           Traffic   
30  716  Route C       WH2           6.64            108           Weather   
31  717  Route D       WH2           4.47            105  Mechanical Issue   
32  718  Route D       WH3           6.02             93           Weather   
33  720  Route D       WH3           4.49            100  Mechanical Issue   
34  721  Route E       WH2           5.26             58   Minor Breakdown   
35  723  Route C       WH4           5.08             69           Traffic   
36  724  Route D       WH1           6.23             71           Weather   
37  728  Route A       WH1           5.35             38           Traffic   
38  729  Route A       WH4           6.65             97       Driver Rest   

         date  
0  2024-12-03  
1  2024-12-04  
2  2024-12-05  
3  2024-12-06  
4  2024-12-07  
5  2024-12-08  
6  2024-12-09  
7  2024-12-12  
8  2024-12-13  
9  2024-12-14  
10 2024-12-17  
11 2024-12-19  
12 2024-12-20  
13 2024-12-21  
14 2024-12-25  
15 2024-12-27  
16 2024-12-28  
17 2024-12-29  
18 2024-12-30  
19 2024-12-01  
20 2024-12-02  
21 2024-12-05  
22 2024-12-06  
23 2024-12-08  
24 2024-12-10  
25 2024-12-11  
26 2024-12-12  
27 2024-12-13  
28 2024-12-15  
29 2024-12-16  
30 2024-12-17  
31 2024-12-18  
32 2024-12-19  
33 2024-12-21  
34 2024-12-22  
35 2024-12-24  
36 2024-12-25  
37 2024-12-29  
38 2024-12-30  "
233,234,What is the average delivery_time for Route E?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.45333333333333
234,235,Show delay reason counts for WH3.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0              None     39
1       Driver Rest     39
2           Weather     38
3  Mechanical Issue     37
4     Customs Delay     35
5   Minor Breakdown     29
6           Traffic     25"
235,236,What is the average delivery_time for Route A?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.546960784313725
236,237,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The day of the week with the highest average delay minutes is Thursday.
237,238,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  total_delay_minutes  total_shipments  delay_rate
0  2024-12-16                 60.0                2        30.0
1  2024-12-17                181.0                2        90.5
2  2024-12-18                105.0                2        52.5
3  2024-12-19                127.0                2        63.5
4  2024-12-20                142.0                2        71.0
5  2024-12-21                134.0                2        67.0
6  2024-12-22                 88.0                2        44.0
7  2024-12-23                 20.0                2        10.0
8  2024-12-24                 90.0                2        45.0
9  2024-12-25                122.0                2        61.0
10 2024-12-26                 27.0                2        13.5
11 2024-12-27                 68.0                2        34.0
12 2024-12-28                143.0                2        71.5
13 2024-12-29                 84.0                2        42.0
14 2024-12-30                215.0                2       107.5"
238,239,Which route had the most Weather delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most Weather delays is: Route A.
239,240,Show correlation between delivery_time and delay_minutes for Route A.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,-0.02936237135725956
240,241,Show correlation between delivery_time and delay_minutes for Route A.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,-0.02936237135725956
241,242,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The day of the week with the highest average delay minutes is Thursday.
242,243,What was the average delay in September?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",56.0919540229885
243,244,Which warehouse had the most shipments in April?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","Unfortunately, I was not able to get your answer. Please try again."
244,245,How many shipments occurred on Saturdays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",142
245,246,Which warehouse had the most shipments in November?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",No shipments were recorded in November.
246,247,Which warehouse had the most shipments in October?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in October is WH1.
247,248,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The day of the week with the highest average delay minutes is Thursday with an average of 56.52 minutes.
248,249,How many shipments from WH2 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",193
249,250,What is the average delivery_time for Route C?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.573715846994536
250,251,How many shipments occurred on Sundays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",142
251,252,Which route had the longest average delay in December?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in December is 'Route D' with an average delay of 57.875 minutes.
252,253,Which warehouse had the most shipments in April?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in April is WH3.
253,254,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
254,255,What is the average delivery_time for Route D?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.461773399014778
255,256,Show correlation between delivery_time and delay_minutes for Route A.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,-0.02936237135725956
256,257,What was the average delay in April?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","Unfortunately, I was not able to get your answer. Please try again."
257,258,How many shipments occurred on Fridays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
258,259,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The day of the week with the highest average delay minutes is Monday.
259,260,Show correlation between delivery_time and delay_minutes for Route B.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,0.05088014220470247
260,261,Which warehouse had the most shipments in August?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in August is WH3.
261,262,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
262,263,List shipments in May with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","Unfortunately, I was not able to get your answer. Please try again."
263,264,How many shipments occurred on Fridays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
264,265,What was the average delay in November?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",51.03333333333333
265,266,List shipments in November with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","Empty DataFrame
Columns: [id, route, warehouse, delivery_time, delay_minutes, delay_reason, date]
Index: []"
266,267,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  total_delay_minutes  total_shipments  daily_delay_rate
0  2024-12-30                215.0                2             107.5
1  2024-12-29                 84.0                2              42.0
2  2024-12-28                143.0                2              71.5
3  2024-12-27                 68.0                2              34.0
4  2024-12-26                 27.0                2              13.5
5  2024-12-25                122.0                2              61.0
6  2024-12-24                 90.0                2              45.0
7  2024-12-23                 20.0                2              10.0
8  2024-12-22                 88.0                2              44.0
9  2024-12-21                134.0                2              67.0
10 2024-12-20                142.0                2              71.0
11 2024-12-19                127.0                2              63.5
12 2024-12-18                105.0                2              52.5
13 2024-12-17                181.0                2              90.5
14 2024-12-16                 60.0                2              30.0"
267,268,Show correlation between delivery_time and delay_minutes for Route B.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,0.05088014220470247
268,269,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  average_delivery_time
0       WH4               5.451840
1       WH3               5.464298
2       WH2               5.527119"
269,270,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  total_delay_minutes  total_shipments  daily_delay_rate
0  2024-12-30                215.0                2             107.5
1  2024-12-29                 84.0                2              42.0
2  2024-12-28                143.0                2              71.5
3  2024-12-27                 68.0                2              34.0
4  2024-12-26                 27.0                2              13.5
5  2024-12-25                122.0                2              61.0
6  2024-12-24                 90.0                2              45.0
7  2024-12-23                 20.0                2              10.0
8  2024-12-22                 88.0                2              44.0
9  2024-12-21                134.0                2              67.0
10 2024-12-20                142.0                2              71.0
11 2024-12-19                127.0                2              63.5
12 2024-12-18                105.0                2              52.5
13 2024-12-17                181.0                2              90.5
14 2024-12-16                 60.0                2              30.0"
270,271,List shipments in June with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0   153  Route B       WH1           5.17             71   Minor Breakdown   
1   154  Route B       WH3           6.01             73   Minor Breakdown   
2   156  Route C       WH4           5.02            105           Traffic   
3   159  Route D       WH2           4.32            109     Customs Delay   
4   162  Route A       WH3           4.73             61           Traffic   
5   163  Route E       WH4           4.24            117       Driver Rest   
6   164  Route E       WH1           4.20             85     Customs Delay   
7   165  Route C       WH1           4.99             94           Traffic   
8   167  Route C       WH1           5.28             74       Driver Rest   
9   171  Route E       WH4           6.89             48   Minor Breakdown   
10  173  Route D       WH4           5.21            112           Traffic   
11  174  Route E       WH3           5.31             73           Weather   
12  175  Route C       WH1           6.76             52     Customs Delay   
13  176  Route D       WH3           6.24             41     Customs Delay   
14  177  Route E       WH3           4.51            116           Weather   
15  179  Route E       WH3           5.71            105  Mechanical Issue   
16  180  Route B       WH1           4.43             76           Traffic   
17  181  Route A       WH1           4.84            109       Driver Rest   
18  517  Route C       WH1           4.54             61           Traffic   
19  518  Route E       WH3           6.92            120     Customs Delay   
20  519  Route E       WH4           5.29             53   Minor Breakdown   
21  520  Route B       WH3           6.56             98       Driver Rest   
22  521  Route A       WH1           4.81             99     Customs Delay   
23  522  Route C       WH2           5.42            117           Traffic   
24  523  Route B       WH4           4.01             98           Traffic   
25  529  Route E       WH3           4.54             76           Traffic   
26  531  Route B       WH4           4.14             55       Driver Rest   
27  532  Route B       WH1           6.93             44       Driver Rest   
28  533  Route E       WH3           6.79             69  Mechanical Issue   
29  535  Route E       WH1           5.21             61       Driver Rest   
30  536  Route E       WH3           6.66             97           Traffic   
31  537  Route E       WH2           5.34             32     Customs Delay   
32  540  Route E       WH1           5.65             79  Mechanical Issue   
33  541  Route D       WH1           4.93             79           Weather   
34  546  Route A       WH1           6.98            106       Driver Rest   
35  882  Route A       WH4           4.18             87       Driver Rest   
36  884  Route B       WH1           4.93             85  Mechanical Issue   
37  886  Route A       WH1           4.50             67           Traffic   
38  889  Route E       WH4           5.18             69  Mechanical Issue   
39  890  Route C       WH1           4.90             48   Minor Breakdown   
40  893  Route A       WH1           5.31             89           Weather   
41  894  Route E       WH1           4.48             94   Minor Breakdown   
42  897  Route E       WH2           6.50            120     Customs Delay   
43  898  Route C       WH2           4.28             66  Mechanical Issue   
44  899  Route B       WH3           4.54            120     Customs Delay   
45  900  Route A       WH4           4.08             95  Mechanical Issue   
46  901  Route C       WH3           6.14            112           Traffic   
47  902  Route D       WH4           4.84             67     Customs Delay   
48  903  Route B       WH4           6.86             40  Mechanical Issue   
49  906  Route C       WH2           4.47            115           Traffic   
50  907  Route C       WH1           4.10             81   Minor Breakdown   
51  908  Route B       WH3           5.08             71   Minor Breakdown   
52  909  Route E       WH2           5.32             82           Weather   
53  910  Route A       WH2           5.33             47       Driver Rest   
54  911  Route B       WH2           6.48            110     Customs Delay   

         date  
0  2024-06-02  
1  2024-06-03  
2  2024-06-05  
3  2024-06-08  
4  2024-06-11  
5  2024-06-12  
6  2024-06-13  
7  2024-06-14  
8  2024-06-16  
9  2024-06-20  
10 2024-06-22  
11 2024-06-23  
12 2024-06-24  
13 2024-06-25  
14 2024-06-26  
15 2024-06-28  
16 2024-06-29  
17 2024-06-30  
18 2024-06-01  
19 2024-06-02  
20 2024-06-03  
21 2024-06-04  
22 2024-06-05  
23 2024-06-06  
24 2024-06-07  
25 2024-06-13  
26 2024-06-15  
27 2024-06-16  
28 2024-06-17  
29 2024-06-19  
30 2024-06-20  
31 2024-06-21  
32 2024-06-24  
33 2024-06-25  
34 2024-06-30  
35 2024-06-01  
36 2024-06-03  
37 2024-06-05  
38 2024-06-08  
39 2024-06-09  
40 2024-06-12  
41 2024-06-13  
42 2024-06-16  
43 2024-06-17  
44 2024-06-18  
45 2024-06-19  
46 2024-06-20  
47 2024-06-21  
48 2024-06-22  
49 2024-06-25  
50 2024-06-26  
51 2024-06-27  
52 2024-06-28  
53 2024-06-29  
54 2024-06-30  "
271,272,Show delay reason counts for WH1.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0              None     45
1           Traffic     45
2  Mechanical Issue     41
3       Driver Rest     39
4   Minor Breakdown     37
5           Weather     34
6     Customs Delay     31"
272,273,Show delay reason counts for WH2.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0              None     43
1           Weather     37
2           Traffic     35
3       Driver Rest     35
4  Mechanical Issue     30
5   Minor Breakdown     29
6     Customs Delay     27"
273,274,Which route had the longest average delay in August?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in August is 'Route B' with an average delay of 65.5 minutes.
274,275,List shipments in February with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0    32  Route D       WH2           6.78             51           Weather   
1    33  Route E       WH3           5.89             59     Customs Delay   
2    36  Route C       WH3           6.08             99           Weather   
3    37  Route B       WH4           6.25             79     Customs Delay   
4    39  Route E       WH3           4.93             84           Weather   
5    40  Route C       WH4           6.79            118  Mechanical Issue   
6    42  Route D       WH1           5.54             67           Weather   
7    44  Route C       WH3           4.88            107     Customs Delay   
8    48  Route A       WH1           4.12             41   Minor Breakdown   
9    49  Route E       WH1           6.15             60       Driver Rest   
10   52  Route C       WH1           4.98             69  Mechanical Issue   
11   53  Route B       WH3           6.61             78           Traffic   
12   54  Route E       WH3           6.41             96     Customs Delay   
13   56  Route B       WH2           5.97             91           Weather   
14   57  Route E       WH3           4.60            118           Traffic   
15   58  Route B       WH1           6.25             88           Traffic   
16   59  Route E       WH3           6.10             82       Driver Rest   
17  398  Route E       WH4           4.20            115       Driver Rest   
18  399  Route D       WH1           4.27            109       Driver Rest   
19  402  Route E       WH4           5.70             99   Minor Breakdown   
20  403  Route C       WH2           6.45             63   Minor Breakdown   
21  404  Route C       WH4           5.98             59           Weather   
22  405  Route B       WH2           4.33            116           Traffic   
23  406  Route E       WH1           6.65             61           Weather   
24  407  Route A       WH1           5.55             74  Mechanical Issue   
25  409  Route B       WH2           5.34             54  Mechanical Issue   
26  411  Route E       WH2           4.57            114       Driver Rest   
27  413  Route B       WH2           6.76             46           Traffic   
28  414  Route E       WH3           5.53             63     Customs Delay   
29  416  Route A       WH1           5.95             98       Driver Rest   
30  417  Route A       WH2           4.63             54           Weather   
31  418  Route E       WH2           6.21             54           Traffic   
32  419  Route A       WH3           4.06             32           Weather   
33  421  Route C       WH1           6.84             91   Minor Breakdown   
34  422  Route D       WH1           4.77             53   Minor Breakdown   
35  423  Route D       WH4           6.95             70           Weather   
36  424  Route E       WH3           5.95             71   Minor Breakdown   
37  761  Route E       WH4           4.78             96     Customs Delay   
38  762  Route A       WH2           6.98             80     Customs Delay   
39  763  Route A       WH2           5.26             98           Weather   
40  766  Route E       WH3           4.69             38  Mechanical Issue   
41  767  Route D       WH1           5.63            114       Driver Rest   
42  769  Route B       WH2           5.97             90       Driver Rest   
43  770  Route C       WH4           5.70             60   Minor Breakdown   
44  772  Route C       WH2           6.01             44       Driver Rest   
45  773  Route C       WH1           6.55             31  Mechanical Issue   
46  774  Route D       WH2           5.02             77  Mechanical Issue   
47  775  Route D       WH1           4.23             74       Driver Rest   
48  776  Route E       WH2           5.24             57   Minor Breakdown   
49  777  Route C       WH2           4.96            104   Minor Breakdown   
50  778  Route C       WH1           6.68             62       Driver Rest   
51  780  Route E       WH3           4.43            104       Driver Rest   
52  782  Route E       WH4           5.10             98           Weather   
53  784  Route A       WH4           5.84            116           Weather   
54  785  Route A       WH1           6.10             71  Mechanical Issue   
55  786  Route A       WH2           4.07             76   Minor Breakdown   
56  787  Route B       WH3           6.91             92       Driver Rest   

         date  
0  2024-02-02  
1  2024-02-03  
2  2024-02-06  
3  2024-02-07  
4  2024-02-09  
5  2024-02-10  
6  2024-02-12  
7  2024-02-14  
8  2024-02-18  
9  2024-02-19  
10 2024-02-22  
11 2024-02-23  
12 2024-02-24  
13 2024-02-26  
14 2024-02-27  
15 2024-02-28  
16 2024-02-29  
17 2024-02-03  
18 2024-02-04  
19 2024-02-07  
20 2024-02-08  
21 2024-02-09  
22 2024-02-10  
23 2024-02-11  
24 2024-02-12  
25 2024-02-14  
26 2024-02-16  
27 2024-02-18  
28 2024-02-19  
29 2024-02-21  
30 2024-02-22  
31 2024-02-23  
32 2024-02-24  
33 2024-02-26  
34 2024-02-27  
35 2024-02-28  
36 2024-02-29  
37 2024-02-01  
38 2024-02-02  
39 2024-02-03  
40 2024-02-06  
41 2024-02-07  
42 2024-02-09  
43 2024-02-10  
44 2024-02-12  
45 2024-02-13  
46 2024-02-14  
47 2024-02-15  
48 2024-02-16  
49 2024-02-17  
50 2024-02-18  
51 2024-02-20  
52 2024-02-22  
53 2024-02-24  
54 2024-02-25  
55 2024-02-26  
56 2024-02-27  "
275,276,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","          date  rolling_7_day_avg_delay
0   2024-01-01                56.000000
1   2024-01-01                43.500000
2   2024-01-02                46.000000
3   2024-01-02                34.500000
4   2024-01-02                45.000000
..         ...                      ...
995 2024-12-28                44.142857
996 2024-12-29                40.571429
997 2024-12-29                42.142857
998 2024-12-30                59.000000
999 2024-12-30                64.000000

[1000 rows x 2 columns]"
276,277,What is the average delivery_time for Route A?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.546960784313725
277,278,Which warehouse had the most shipments in July?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in July is WH2.
278,279,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
279,280,How many shipments from WH3 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",203
280,281,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
281,282,Show delay reason counts for WH1.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0           Traffic     45
1              None     45
2  Mechanical Issue     41
3       Driver Rest     39
4   Minor Breakdown     37
5           Weather     34
6     Customs Delay     31"
282,283,What is the average delivery_time for Route E?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.45333333333333
283,284,What was the average delay in December?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",48.95
284,285,Show correlation between delivery_time and delay_minutes for Route A.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,-0.02936237135725956
285,286,How many shipments occurred on Tuesdays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
286,287,Which warehouse had the most shipments in June?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in June is WH1.
287,288,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
288,289,How many shipments occurred on Mondays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",14
289,290,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
290,291,What was the average delay in October?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",49.935483870967744
291,292,What is the average delivery_time for Route E?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.45333333333333
292,293,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  rolling_7_day_avg
0  2024-01-01          56.000000
1  2024-01-01          43.500000
2  2024-01-02          46.000000
3  2024-01-02          34.500000
4  2024-01-02          45.000000
..        ...                ...
87 2024-01-30          27.857143
88 2024-01-30          32.142857
89 2024-01-31          22.571429
90 2024-01-31          32.285714
91 2024-01-31          29.428571

[92 rows x 2 columns]"
293,294,Show delay reason counts for WH2.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0              None     43
1           Weather     37
2           Traffic     35
3       Driver Rest     35
4  Mechanical Issue     30
5   Minor Breakdown     29
6     Customs Delay     27"
294,295,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
295,296,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","          date  rolling_7_day_avg_delay
0   2024-01-01                56.000000
1   2024-01-01                43.500000
2   2024-01-02                46.000000
3   2024-01-02                34.500000
4   2024-01-02                45.000000
..         ...                      ...
995 2024-12-28                44.142857
996 2024-12-29                40.571429
997 2024-12-29                42.142857
998 2024-12-30                59.000000
999 2024-12-30                64.000000

[1000 rows x 2 columns]"
296,297,List shipments in July with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0   182  Route C       WH4           4.79            120           Traffic   
1   183  Route A       WH1           4.64             57  Mechanical Issue   
2   184  Route A       WH4           6.75             68     Customs Delay   
3   185  Route A       WH2           4.50             42   Minor Breakdown   
4   187  Route B       WH1           5.44             65  Mechanical Issue   
..  ...      ...       ...            ...            ...               ...   
61  936  Route E       WH2           6.02             70           Traffic   
62  937  Route B       WH1           5.83             51           Traffic   
63  940  Route E       WH1           5.38            100           Weather   
64  941  Route C       WH3           6.00             82     Customs Delay   
65  942  Route A       WH4           4.44             75  Mechanical Issue   

         date  
0  2024-07-01  
1  2024-07-02  
2  2024-07-03  
3  2024-07-04  
4  2024-07-06  
..        ...  
61 2024-07-25  
62 2024-07-26  
63 2024-07-29  
64 2024-07-30  
65 2024-07-31  

[66 rows x 7 columns]"
297,298,What is the average delivery_time for Route D?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.461773399014778
298,299,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay_minutes
0  Route E              11580.0
1  Route A              10776.0
2  Route B              10569.0"
299,300,How many shipments from WH3 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",203
300,301,Which warehouse had the most shipments in February?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in February is WH2.
301,302,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  total_delay_minutes  total_shipments  daily_delay_rate
0  2024-12-30                215.0                2             107.5
1  2024-12-29                 84.0                2              42.0
2  2024-12-28                143.0                2              71.5
3  2024-12-27                 68.0                2              34.0
4  2024-12-26                 27.0                2              13.5
5  2024-12-25                122.0                2              61.0
6  2024-12-24                 90.0                2              45.0
7  2024-12-23                 20.0                2              10.0
8  2024-12-22                 88.0                2              44.0
9  2024-12-21                134.0                2              67.0
10 2024-12-20                142.0                2              71.0
11 2024-12-19                127.0                2              63.5
12 2024-12-18                105.0                2              52.5
13 2024-12-17                181.0                2              90.5
14 2024-12-16                 60.0                2              30.0"
302,303,Show delay reason counts for WH1.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0           Traffic     45
1              None     45
2  Mechanical Issue     41
3       Driver Rest     39
4   Minor Breakdown     37
5           Weather     34
6     Customs Delay     31"
303,304,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay
0  Route E      11580.0
1  Route A      10776.0
2  Route B      10569.0"
304,305,Which warehouse had the most shipments in December?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in December is WH4 with 19 shipments.
305,306,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The day of the week with the highest average delay_minutes is Monday with an average of 113.67 minutes.
306,307,What was the average delay in December?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",48.95
307,308,What was the average delay in May?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",47.67741935483871
308,309,Show delay reason counts for WH4.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0           Traffic     52
1              None     43
2   Minor Breakdown     38
3  Mechanical Issue     35
4       Driver Rest     32
5           Weather     28
6     Customs Delay     22"
309,310,How many shipments occurred on Fridays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
310,311,How many shipments from WH3 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",203
311,312,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
312,313,What was the average delay in April?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",56.81111111111111
313,314,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
314,315,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The day of the week with the highest average delay minutes is Thursday.
315,316,Which route had the most Minor Breakdown delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most 'Minor Breakdown' delays is: Route E
316,317,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
317,318,How many shipments from WH2 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",193
318,319,What was the average delay in March?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",46.623655913978496
319,320,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
320,321,How many shipments from WH1 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",227
321,322,Which warehouse had the most shipments in May?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in May is WH1.
322,323,What was the average delay in March?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",46.623655913978496
323,324,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay_minutes
0  Route E              11580.0
1  Route A              10776.0
2  Route B              10569.0"
324,325,How many shipments occurred on Wednesdays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",12
325,326,Which route had the most Mechanical Issue delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most Mechanical Issue delays is Route D.
326,327,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
327,328,Which route had the most None delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most None delays is: Route A
328,329,List shipments in May with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0   121  Route B       WH4           6.91            108  Mechanical Issue   
1   126  Route D       WH3           6.23             31           Weather   
2   128  Route C       WH2           6.30            112  Mechanical Issue   
3   129  Route A       WH4           6.55            120       Driver Rest   
4   130  Route A       WH2           4.41             33           Weather   
5   133  Route A       WH1           6.64             67   Minor Breakdown   
6   134  Route A       WH3           6.48             43   Minor Breakdown   
7   136  Route E       WH1           6.37             67   Minor Breakdown   
8   137  Route B       WH1           5.48             69           Weather   
9   142  Route C       WH4           5.60             72     Customs Delay   
10  144  Route B       WH4           5.15            110       Driver Rest   
11  145  Route B       WH3           6.45             70  Mechanical Issue   
12  146  Route D       WH2           4.38             70  Mechanical Issue   
13  147  Route C       WH1           5.93             45   Minor Breakdown   
14  150  Route E       WH3           6.36            109     Customs Delay   
15  486  Route D       WH2           5.80             49           Weather   
16  487  Route D       WH3           4.35             53  Mechanical Issue   
17  488  Route A       WH2           4.59             99   Minor Breakdown   
18  490  Route D       WH3           4.80             75     Customs Delay   
19  492  Route B       WH2           6.58             88   Minor Breakdown   
20  493  Route A       WH2           5.01             73  Mechanical Issue   
21  494  Route D       WH3           5.01             90       Driver Rest   
22  497  Route A       WH4           4.14             72           Weather   
23  499  Route A       WH1           4.84             54           Traffic   
24  501  Route B       WH2           6.24             93   Minor Breakdown   
25  502  Route D       WH3           4.16             99  Mechanical Issue   
26  506  Route A       WH1           5.41             65     Customs Delay   
27  507  Route E       WH1           6.89             95     Customs Delay   
28  508  Route B       WH1           5.59             32  Mechanical Issue   
29  509  Route B       WH3           4.93             89           Traffic   
30  510  Route D       WH1           5.84             67       Driver Rest   
31  511  Route D       WH1           6.82             60       Driver Rest   
32  512  Route C       WH2           4.81             70           Weather   
33  515  Route E       WH2           5.98             95       Driver Rest   
34  516  Route C       WH4           6.81             42           Weather   
35  851  Route B       WH4           5.43             58           Traffic   
36  853  Route B       WH1           4.36            109     Customs Delay   
37  854  Route B       WH1           6.34             45           Traffic   
38  856  Route B       WH3           5.47             79       Driver Rest   
39  857  Route A       WH2           6.21             79           Weather   
40  859  Route E       WH3           4.62             96   Minor Breakdown   
41  861  Route D       WH3           6.37             70  Mechanical Issue   
42  862  Route D       WH1           6.59             85     Customs Delay   
43  863  Route A       WH1           6.46            117   Minor Breakdown   
44  864  Route E       WH3           5.18             38  Mechanical Issue   
45  865  Route D       WH3           6.79             86     Customs Delay   
46  866  Route A       WH2           5.69             88           Traffic   
47  867  Route E       WH1           4.04             52     Customs Delay   
48  868  Route B       WH2           4.34             79           Traffic   
49  872  Route B       WH1           5.40             33           Weather   
50  875  Route C       WH1           5.28             83           Weather   
51  877  Route A       WH1           5.50             51           Traffic   
52  879  Route A       WH1           4.43             88     Customs Delay   
53  880  Route E       WH3           6.68            109  Mechanical Issue   
54  881  Route E       WH4           6.89             47   Minor Breakdown   

         date  
0  2024-05-01  
1  2024-05-06  
2  2024-05-08  
3  2024-05-09  
4  2024-05-10  
5  2024-05-13  
6  2024-05-14  
7  2024-05-16  
8  2024-05-17  
9  2024-05-22  
10 2024-05-24  
11 2024-05-25  
12 2024-05-26  
13 2024-05-27  
14 2024-05-30  
15 2024-05-01  
16 2024-05-02  
17 2024-05-03  
18 2024-05-05  
19 2024-05-07  
20 2024-05-08  
21 2024-05-09  
22 2024-05-12  
23 2024-05-14  
24 2024-05-16  
25 2024-05-17  
26 2024-05-21  
27 2024-05-22  
28 2024-05-23  
29 2024-05-24  
30 2024-05-25  
31 2024-05-26  
32 2024-05-27  
33 2024-05-30  
34 2024-05-31  
35 2024-05-01  
36 2024-05-03  
37 2024-05-04  
38 2024-05-06  
39 2024-05-07  
40 2024-05-09  
41 2024-05-11  
42 2024-05-12  
43 2024-05-13  
44 2024-05-14  
45 2024-05-15  
46 2024-05-16  
47 2024-05-17  
48 2024-05-18  
49 2024-05-22  
50 2024-05-25  
51 2024-05-27  
52 2024-05-29  
53 2024-05-30  
54 2024-05-31  "
329,330,What was the average delay in December?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",48.95
330,331,Show delay reason counts for WH2.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0              None     43
1           Weather     37
2           Traffic     35
3       Driver Rest     35
4  Mechanical Issue     30
5   Minor Breakdown     29
6     Customs Delay     27"
331,332,Which route had the longest average delay in December?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in December is 'Route D' with an average delay of 57.875 minutes.
332,333,How many shipments occurred on Fridays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
333,334,How many shipments occurred on Thursdays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
334,335,How many shipments from WH3 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",203
335,336,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The day of the week with the highest average delay minutes is Thursday with an average of 56.52 minutes.
336,337,How many shipments occurred on Sundays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",142
337,338,List shipments in March with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0    60  Route B       WH3           6.88             55   Minor Breakdown   
1    61  Route A       WH4           5.88             84           Traffic   
2    62  Route E       WH4           4.92            109       Driver Rest   
3    63  Route B       WH2           6.54             88       Driver Rest   
4    65  Route B       WH2           4.10             35           Weather   
5    70  Route B       WH3           4.56             67           Weather   
6    71  Route A       WH2           6.48             43     Customs Delay   
7    73  Route C       WH1           6.00             60     Customs Delay   
8    77  Route E       WH2           5.18            100       Driver Rest   
9    80  Route D       WH3           6.89             70  Mechanical Issue   
10   82  Route A       WH1           5.13             31       Driver Rest   
11   83  Route E       WH1           6.58             80  Mechanical Issue   
12   86  Route B       WH4           4.92             60     Customs Delay   
13   88  Route A       WH3           5.24             95       Driver Rest   
14   90  Route D       WH2           6.35             97       Driver Rest   
15  425  Route E       WH4           4.94             44  Mechanical Issue   
16  427  Route C       WH1           5.48            117           Weather   
17  428  Route A       WH2           6.63             68           Traffic   
18  429  Route E       WH4           5.79             53   Minor Breakdown   
19  430  Route D       WH2           5.64             65   Minor Breakdown   
20  432  Route C       WH1           4.38             66       Driver Rest   
21  433  Route E       WH4           5.77             97  Mechanical Issue   
22  436  Route C       WH4           6.22             47  Mechanical Issue   
23  437  Route C       WH2           4.77             42   Minor Breakdown   
24  440  Route D       WH3           6.85            111           Weather   
25  441  Route C       WH3           5.88             87           Traffic   
26  444  Route D       WH1           6.72            114           Traffic   
27  445  Route D       WH1           6.42             47       Driver Rest   
28  447  Route C       WH3           4.36             90       Driver Rest   
29  449  Route A       WH3           5.45             58       Driver Rest   
30  450  Route E       WH1           4.56             53     Customs Delay   
31  451  Route C       WH4           6.60             73           Traffic   
32  790  Route E       WH3           5.04             71           Weather   
33  791  Route E       WH4           5.81             99   Minor Breakdown   
34  792  Route E       WH1           4.01             32     Customs Delay   
35  794  Route B       WH4           5.82             34           Weather   
36  796  Route D       WH4           4.65            106           Traffic   
37  797  Route A       WH1           6.04            105           Traffic   
38  798  Route A       WH1           5.85            112  Mechanical Issue   
39  801  Route A       WH2           5.67             55   Minor Breakdown   
40  802  Route D       WH1           5.53             54  Mechanical Issue   
41  803  Route A       WH1           4.87            111  Mechanical Issue   
42  806  Route B       WH2           4.54            118       Driver Rest   
43  807  Route A       WH3           6.73             94           Weather   
44  814  Route B       WH4           6.49             68  Mechanical Issue   
45  815  Route E       WH1           6.80             70   Minor Breakdown   
46  816  Route B       WH2           5.91             82   Minor Breakdown   
47  817  Route A       WH2           6.91             68       Driver Rest   
48  818  Route A       WH2           4.92            108           Traffic   
49  819  Route C       WH1           6.46            108           Traffic   
50  820  Route E       WH1           5.45             91     Customs Delay   

         date  
0  2024-03-01  
1  2024-03-02  
2  2024-03-03  
3  2024-03-04  
4  2024-03-06  
5  2024-03-11  
6  2024-03-12  
7  2024-03-14  
8  2024-03-18  
9  2024-03-21  
10 2024-03-23  
11 2024-03-24  
12 2024-03-27  
13 2024-03-29  
14 2024-03-31  
15 2024-03-01  
16 2024-03-03  
17 2024-03-04  
18 2024-03-05  
19 2024-03-06  
20 2024-03-08  
21 2024-03-09  
22 2024-03-12  
23 2024-03-13  
24 2024-03-16  
25 2024-03-17  
26 2024-03-20  
27 2024-03-21  
28 2024-03-23  
29 2024-03-25  
30 2024-03-26  
31 2024-03-27  
32 2024-03-01  
33 2024-03-02  
34 2024-03-03  
35 2024-03-05  
36 2024-03-07  
37 2024-03-08  
38 2024-03-09  
39 2024-03-12  
40 2024-03-13  
41 2024-03-14  
42 2024-03-17  
43 2024-03-18  
44 2024-03-25  
45 2024-03-26  
46 2024-03-27  
47 2024-03-28  
48 2024-03-29  
49 2024-03-30  
50 2024-03-31  "
338,339,Which route had the longest average delay in April?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in April is 'Route D' with an average delay of 65.55555555555556 minutes.
339,340,What was the average delay in February?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",54.50574712643678
340,341,List shipments in March with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0    60  Route B       WH3           6.88             55   Minor Breakdown   
1    61  Route A       WH4           5.88             84           Traffic   
2    62  Route E       WH4           4.92            109       Driver Rest   
3    63  Route B       WH2           6.54             88       Driver Rest   
4    65  Route B       WH2           4.10             35           Weather   
5    70  Route B       WH3           4.56             67           Weather   
6    71  Route A       WH2           6.48             43     Customs Delay   
7    73  Route C       WH1           6.00             60     Customs Delay   
8    77  Route E       WH2           5.18            100       Driver Rest   
9    80  Route D       WH3           6.89             70  Mechanical Issue   
10   82  Route A       WH1           5.13             31       Driver Rest   
11   83  Route E       WH1           6.58             80  Mechanical Issue   
12   86  Route B       WH4           4.92             60     Customs Delay   
13   88  Route A       WH3           5.24             95       Driver Rest   
14   90  Route D       WH2           6.35             97       Driver Rest   
15  425  Route E       WH4           4.94             44  Mechanical Issue   
16  427  Route C       WH1           5.48            117           Weather   
17  428  Route A       WH2           6.63             68           Traffic   
18  429  Route E       WH4           5.79             53   Minor Breakdown   
19  430  Route D       WH2           5.64             65   Minor Breakdown   
20  432  Route C       WH1           4.38             66       Driver Rest   
21  433  Route E       WH4           5.77             97  Mechanical Issue   
22  436  Route C       WH4           6.22             47  Mechanical Issue   
23  437  Route C       WH2           4.77             42   Minor Breakdown   
24  440  Route D       WH3           6.85            111           Weather   
25  441  Route C       WH3           5.88             87           Traffic   
26  444  Route D       WH1           6.72            114           Traffic   
27  445  Route D       WH1           6.42             47       Driver Rest   
28  447  Route C       WH3           4.36             90       Driver Rest   
29  449  Route A       WH3           5.45             58       Driver Rest   
30  450  Route E       WH1           4.56             53     Customs Delay   
31  451  Route C       WH4           6.60             73           Traffic   
32  790  Route E       WH3           5.04             71           Weather   
33  791  Route E       WH4           5.81             99   Minor Breakdown   
34  792  Route E       WH1           4.01             32     Customs Delay   
35  794  Route B       WH4           5.82             34           Weather   
36  796  Route D       WH4           4.65            106           Traffic   
37  797  Route A       WH1           6.04            105           Traffic   
38  798  Route A       WH1           5.85            112  Mechanical Issue   
39  801  Route A       WH2           5.67             55   Minor Breakdown   
40  802  Route D       WH1           5.53             54  Mechanical Issue   
41  803  Route A       WH1           4.87            111  Mechanical Issue   
42  806  Route B       WH2           4.54            118       Driver Rest   
43  807  Route A       WH3           6.73             94           Weather   
44  814  Route B       WH4           6.49             68  Mechanical Issue   
45  815  Route E       WH1           6.80             70   Minor Breakdown   
46  816  Route B       WH2           5.91             82   Minor Breakdown   
47  817  Route A       WH2           6.91             68       Driver Rest   
48  818  Route A       WH2           4.92            108           Traffic   
49  819  Route C       WH1           6.46            108           Traffic   
50  820  Route E       WH1           5.45             91     Customs Delay   

         date  
0  2024-03-01  
1  2024-03-02  
2  2024-03-03  
3  2024-03-04  
4  2024-03-06  
5  2024-03-11  
6  2024-03-12  
7  2024-03-14  
8  2024-03-18  
9  2024-03-21  
10 2024-03-23  
11 2024-03-24  
12 2024-03-27  
13 2024-03-29  
14 2024-03-31  
15 2024-03-01  
16 2024-03-03  
17 2024-03-04  
18 2024-03-05  
19 2024-03-06  
20 2024-03-08  
21 2024-03-09  
22 2024-03-12  
23 2024-03-13  
24 2024-03-16  
25 2024-03-17  
26 2024-03-20  
27 2024-03-21  
28 2024-03-23  
29 2024-03-25  
30 2024-03-26  
31 2024-03-27  
32 2024-03-01  
33 2024-03-02  
34 2024-03-03  
35 2024-03-05  
36 2024-03-07  
37 2024-03-08  
38 2024-03-09  
39 2024-03-12  
40 2024-03-13  
41 2024-03-14  
42 2024-03-17  
43 2024-03-18  
44 2024-03-25  
45 2024-03-26  
46 2024-03-27  
47 2024-03-28  
48 2024-03-29  
49 2024-03-30  
50 2024-03-31  "
341,342,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","          date  rolling_7_day_avg_delay
0   2024-01-01                56.000000
1   2024-01-01                43.500000
2   2024-01-02                46.000000
3   2024-01-02                34.500000
4   2024-01-02                45.000000
..         ...                      ...
995 2024-12-28                44.142857
996 2024-12-29                40.571429
997 2024-12-29                42.142857
998 2024-12-30                59.000000
999 2024-12-30                64.000000

[1000 rows x 2 columns]"
342,343,Which warehouse had the most shipments in November?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in November is WH4.
343,344,What was the average delay in February?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",54.50574712643678
344,345,Which warehouse had the most shipments in January?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in January is WH3.
345,346,Which route had the longest average delay in August?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in August is Route B.
346,347,How many shipments from WH3 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",203
347,348,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The day of the week with the highest average delay_minutes is Thursday.
348,349,Which warehouse had the most shipments in October?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  shipment_count
0       WH1              18"
349,350,Which route had the most Mechanical Issue delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most Mechanical Issue delays is 'Route D' with 41 incidents.
350,351,How many shipments from WH4 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",207
351,352,What is the average delivery_time for Route A?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",5.546960784313725
352,353,Which warehouse had the most shipments in May?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in May is WH1.
353,354,How many shipments occurred on Saturdays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",142
354,355,What was the average delay in September?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",56.0919540229885
355,356,How many shipments occurred on Fridays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
356,357,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The day of the week with the highest average delay minutes is Monday with an average of 113.67 minutes.
357,358,Show delay reason counts for WH3.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0       Driver Rest     39
1              None     39
2           Weather     38
3  Mechanical Issue     37
4     Customs Delay     35
5   Minor Breakdown     29
6           Traffic     25"
358,359,How many shipments occurred on Wednesdays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
359,360,Which route had the longest average delay in March?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in March is 'Route A' with an average delay of 56.73684210526316 minutes.
360,361,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  total_delay_minutes  total_shipments  daily_delay_rate
0  2024-12-16                 60.0                2              30.0
1  2024-12-17                181.0                2              90.5
2  2024-12-18                105.0                2              52.5
3  2024-12-19                127.0                2              63.5
4  2024-12-20                142.0                2              71.0
5  2024-12-21                134.0                2              67.0
6  2024-12-22                 88.0                2              44.0
7  2024-12-23                 20.0                2              10.0
8  2024-12-24                 90.0                2              45.0
9  2024-12-25                122.0                2              61.0
10 2024-12-26                 27.0                2              13.5
11 2024-12-27                 68.0                2              34.0
12 2024-12-28                143.0                2              71.5
13 2024-12-29                 84.0                2              42.0
14 2024-12-30                215.0                2             107.5"
361,362,What was the average delay in June?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",54.144444444444446
362,363,Which warehouse had the most shipments in March?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in March is WH1.
363,364,List shipments in September with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","      id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0    245  Route C       WH4           4.35             80     Customs Delay   
1    248  Route B       WH2           6.33             50   Minor Breakdown   
2    249  Route A       WH3           5.46             90           Weather   
3    250  Route E       WH1           6.64             80           Weather   
4    251  Route C       WH2           4.47            107           Traffic   
5    252  Route A       WH4           6.26             72           Traffic   
6    253  Route D       WH3           6.22             60           Traffic   
7    254  Route C       WH1           4.35            104       Driver Rest   
8    258  Route E       WH4           6.34             95           Traffic   
9    259  Route B       WH3           5.89             34     Customs Delay   
10   262  Route B       WH2           6.87            112       Driver Rest   
11   263  Route B       WH4           4.31             69       Driver Rest   
12   265  Route A       WH3           6.94             63     Customs Delay   
13   269  Route B       WH1           6.35             63   Minor Breakdown   
14   270  Route D       WH2           6.61             92     Customs Delay   
15   271  Route D       WH3           4.98             75  Mechanical Issue   
16   273  Route D       WH3           6.10             60           Weather   
17   610  Route D       WH3           4.07             97     Customs Delay   
18   611  Route A       WH4           4.95             92           Weather   
19   612  Route A       WH1           4.27             70     Customs Delay   
20   614  Route B       WH1           5.47             84     Customs Delay   
21   615  Route A       WH1           4.72             94  Mechanical Issue   
22   616  Route B       WH2           6.46            109           Weather   
23   617  Route E       WH1           6.66            107   Minor Breakdown   
24   620  Route D       WH2           6.78            112           Weather   
25   621  Route C       WH3           4.48            112   Minor Breakdown   
26   622  Route D       WH1           6.51             98           Traffic   
27   624  Route C       WH3           5.65             54  Mechanical Issue   
28   626  Route B       WH2           5.98             76  Mechanical Issue   
29   628  Route D       WH4           5.21            107   Minor Breakdown   
30   630  Route E       WH4           6.94             79       Driver Rest   
31   632  Route D       WH1           6.58             88  Mechanical Issue   
32   634  Route C       WH1           5.34             52     Customs Delay   
33   635  Route A       WH4           5.31             33           Traffic   
34   637  Route D       WH4           5.24            111       Driver Rest   
35   638  Route A       WH3           6.59             33  Mechanical Issue   
36   976  Route D       WH4           5.29             54           Weather   
37   979  Route E       WH4           5.63            120           Traffic   
38   980  Route A       WH3           4.73            112       Driver Rest   
39   981  Route A       WH4           6.53             90  Mechanical Issue   
40   982  Route B       WH3           6.42             65       Driver Rest   
41   983  Route C       WH1           5.83             71   Minor Breakdown   
42   984  Route B       WH4           5.03             74   Minor Breakdown   
43   986  Route D       WH3           6.06             69  Mechanical Issue   
44   987  Route D       WH1           4.83             46           Weather   
45   989  Route B       WH4           4.33            100  Mechanical Issue   
46   991  Route A       WH2           6.02             80  Mechanical Issue   
47   992  Route D       WH3           4.02             37     Customs Delay   
48   993  Route D       WH1           6.03             65           Traffic   
49   994  Route D       WH1           5.00             80  Mechanical Issue   
50   995  Route A       WH4           6.35             57           Traffic   
51   996  Route B       WH2           5.60            118           Weather   
52   997  Route E       WH4           5.00             83       Driver Rest   
53   998  Route B       WH4           5.45             52       Driver Rest   
54   999  Route E       WH4           5.61            117           Traffic   
55  1000  Route B       WH3           5.52            105  Mechanical Issue   

         date  
0  2024-09-02  
1  2024-09-05  
2  2024-09-06  
3  2024-09-07  
4  2024-09-08  
5  2024-09-09  
6  2024-09-10  
7  2024-09-11  
8  2024-09-15  
9  2024-09-16  
10 2024-09-19  
11 2024-09-20  
12 2024-09-22  
13 2024-09-26  
14 2024-09-27  
15 2024-09-28  
16 2024-09-30  
17 2024-09-02  
18 2024-09-03  
19 2024-09-04  
20 2024-09-06  
21 2024-09-07  
22 2024-09-08  
23 2024-09-09  
24 2024-09-12  
25 2024-09-13  
26 2024-09-14  
27 2024-09-16  
28 2024-09-18  
29 2024-09-20  
30 2024-09-22  
31 2024-09-24  
32 2024-09-26  
33 2024-09-27  
34 2024-09-29  
35 2024-09-30  
36 2024-09-03  
37 2024-09-06  
38 2024-09-07  
39 2024-09-08  
40 2024-09-09  
41 2024-09-10  
42 2024-09-11  
43 2024-09-13  
44 2024-09-14  
45 2024-09-16  
46 2024-09-18  
47 2024-09-19  
48 2024-09-20  
49 2024-09-21  
50 2024-09-22  
51 2024-09-23  
52 2024-09-24  
53 2024-09-25  
54 2024-09-26  
55 2024-09-27  "
364,365,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  total_delay_minutes  total_shipments  daily_delay_rate
0  2024-12-16                 60.0                2              30.0
1  2024-12-17                181.0                2              90.5
2  2024-12-18                105.0                2              52.5
3  2024-12-19                127.0                2              63.5
4  2024-12-20                142.0                2              71.0
5  2024-12-21                134.0                2              67.0
6  2024-12-22                 88.0                2              44.0
7  2024-12-23                 20.0                2              10.0
8  2024-12-24                 90.0                2              45.0
9  2024-12-25                122.0                2              61.0
10 2024-12-26                 27.0                2              13.5
11 2024-12-27                 68.0                2              34.0
12 2024-12-28                143.0                2              71.5
13 2024-12-29                 84.0                2              42.0
14 2024-12-30                215.0                2             107.5"
365,366,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay_minutes
0  Route E              11580.0
1  Route A              10776.0
2  Route B              10569.0"
366,367,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  total_delay_minutes  total_shipments  daily_delay_rate
0  2024-12-30                215.0                2             107.5
1  2024-12-29                 84.0                2              42.0
2  2024-12-28                143.0                2              71.5
3  2024-12-27                 68.0                2              34.0
4  2024-12-26                 27.0                2              13.5
5  2024-12-25                122.0                2              61.0
6  2024-12-24                 90.0                2              45.0
7  2024-12-23                 20.0                2              10.0
8  2024-12-22                 88.0                2              44.0
9  2024-12-21                134.0                2              67.0
10 2024-12-20                142.0                2              71.0
11 2024-12-19                127.0                2              63.5
12 2024-12-18                105.0                2              52.5
13 2024-12-17                181.0                2              90.5
14 2024-12-16                 60.0                2              30.0"
367,368,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
368,369,What is the daily delay rate for the last 14 days?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  total_delay_minutes  total_shipments  daily_delay_rate
0  2024-12-30                215.0                2             107.5
1  2024-12-29                 84.0                2              42.0
2  2024-12-28                143.0                2              71.5
3  2024-12-27                 68.0                2              34.0
4  2024-12-26                 27.0                2              13.5
5  2024-12-25                122.0                2              61.0
6  2024-12-24                 90.0                2              45.0
7  2024-12-23                 20.0                2              10.0
8  2024-12-22                 88.0                2              44.0
9  2024-12-21                134.0                2              67.0
10 2024-12-20                142.0                2              71.0
11 2024-12-19                127.0                2              63.5
12 2024-12-18                105.0                2              52.5
13 2024-12-17                181.0                2              90.5
14 2024-12-16                 60.0                2              30.0"
369,370,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","         date  rolling_7_day_avg_delay
0  2024-01-01                56.000000
1  2024-01-01                43.500000
2  2024-01-02                46.000000
3  2024-01-02                34.500000
4  2024-01-02                45.000000
5  2024-01-03                45.000000
6  2024-01-03                55.142857
7  2024-01-03                50.428571
8  2024-01-04                62.142857
9  2024-01-04                61.000000
10 2024-01-04                62.428571
11 2024-01-05                54.571429
12 2024-01-05                48.142857
13 2024-01-05                44.142857
14 2024-01-06                58.000000
15 2024-01-06                52.142857
16 2024-01-06                56.142857"
370,371,Which warehouse had the most shipments in July?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in July is WH2.
371,372,Which route had the longest average delay in April?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in April is 'Route D' with an average delay of 65.55555555555556 minutes.
372,373,Show the top 3 routes by total delay_minutes.,result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(3),"result = df.groupby('route')['delay_minutes'].sum().sort_values(ascending=False).head(5).reset_index(name='total_delay')
","route
Route E    11580
Route A    10776
Route B    10569
Name: delay_minutes, dtype: int64","     route  total_delay_minutes
0  Route E              11580.0
1  Route A              10776.0
2  Route B              10569.0"
373,374,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","        date day_of_week  avg_delay_minutes
0 2024-04-29      Monday         113.666667"
374,375,Which route had the longest average delay in March?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in March is 'Route A' with an average delay of 56.73684210526316 minutes.
375,376,Which warehouse had the most shipments in April?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in April is WH3.
376,377,Which warehouse had the most shipments in January?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in January is WH3.
377,378,Which route had the longest average delay in February?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in February is 'Route E' with an average delay of 66.73913043478261 minutes.
378,379,Which route had the most None delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the most None delays is Route A.
379,380,What was the average delay in May?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",47.67741935483871
380,381,Which warehouse had the most shipments in October?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most shipments in October is WH1.
381,382,Show correlation between delivery_time and delay_minutes for Route A.,result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,-0.02936237135725956
382,383,Show delay reason counts for WH4.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0           Traffic     52
1              None     43
2   Minor Breakdown     38
3  Mechanical Issue     35
4       Driver Rest     32
5           Weather     28
6     Customs Delay     22"
383,384,List shipments in July with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","Empty DataFrame
Columns: [id, route, warehouse, delivery_time, delay_minutes, delay_reason, date]
Index: []"
384,385,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","          date  delay_minutes  rolling_7_day_avg
0   2024-01-01             56          56.000000
1   2024-01-01             31          43.500000
2   2024-01-02             51          46.000000
3   2024-01-02              0          34.500000
4   2024-01-02             87          45.000000
..         ...            ...                ...
995 2024-12-28             26          44.142857
996 2024-12-29             46          40.571429
997 2024-12-29             38          42.142857
998 2024-12-30            118          59.000000
999 2024-12-30             97          64.000000

[1000 rows x 3 columns]"
385,386,Which route had the longest average delay in April?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in April is 'Route D' with an average delay of 65.55555555555556 minutes.
386,387,Show delay reason counts for WH3.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0              None     39
1       Driver Rest     39
2           Weather     38
3  Mechanical Issue     37
4     Customs Delay     35
5   Minor Breakdown     29
6           Traffic     25"
387,388,Which route had the most Driver Rest delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     route  num_delays
0  Route B          38"
388,389,Which route had the longest average delay in September?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The route with the longest average delay in September is 'Route B' with an average delay of 64.11 minutes.
389,390,What is the rolling 7-day average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","          date  rolling_7_day_avg_delay
0   2024-01-01                56.000000
1   2024-01-01                43.500000
2   2024-01-02                46.000000
3   2024-01-02                34.500000
4   2024-01-02                45.000000
..         ...                      ...
995 2024-12-28                44.142857
996 2024-12-29                40.571429
997 2024-12-29                42.142857
998 2024-12-30                59.000000
999 2024-12-30                64.000000

[1000 rows x 2 columns]"
390,391,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
391,392,What was the average delay in December?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",nan
392,393,Show the bottom 3 warehouses by average delivery_time.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  avg_delivery_time
0       WH4           5.451840
1       WH3           5.464298
2       WH2           5.527119"
393,394,How many shipments from WH3 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",203
394,395,Which day of week has highest average delay_minutes?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The day of week with the highest average delay minutes is Thursday.
395,396,Show delay reason counts for WH1.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","       delay_reason  count
0              None     45
1           Traffic     45
2  Mechanical Issue     41
3       Driver Rest     39
4   Minor Breakdown     37
5           Weather     34
6     Customs Delay     31"
396,397,How many shipments from WH2 had delays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",193
397,398,How many shipments occurred on Tuesdays?,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",143
398,399,List shipments in November with delay_minutes > 30.,"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","Empty DataFrame
Columns: [id, route, warehouse, delivery_time, delay_minutes, delay_reason, date]
Index: []"
399,400,Rank all routes by reliability (fewest delays to most). (count only),result = df.groupby('route').apply(lambda g:(g['delay_minutes']==0).mean()).sort_values(ascending=False),"# rank routes by on-time rate
result = df.groupby('route').apply(lambda g: (g['delay_minutes']==0).mean()).sort_values(ascending=False).reset_index(name='on_time_rate')
","route
Route C    0.191257
Route A    0.186275
Route E    0.169014
Route D    0.157635
Route B    0.147208
dtype: float64","     route  total_shipments  delayed_shipments
0  Route C              183              148.0
1  Route A              204              166.0
2  Route B              197              168.0
3  Route D              203              171.0
4  Route E              213              177.0"
400,401,How many shipments had zero delay? (count only),result = (df['delay_minutes']==0).sum(),"# count shipments with zero delay
result = df[df['delay_minutes']==0].shape[0]
",170,170
401,402,Which warehouse had the most weather-related delays? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  weather_delay_count
0       WH3                   38"
402,403,How many shipments were sent from each warehouse? (detailed),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  num_shipments
0       WH1            272
1       WH4            250
2       WH3            242
3       WH2            236"
403,404,Which warehouse served the most different routes? (detailed),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  distinct_routes
0       WH3                5"
404,405,Predict next week's delay rate using historical averages. (count only),df['date']=pd.to_datetime(df['date']); last_28=df[df['date']>df['date'].max()-pd.Timedelta(days=27)]; result = (last_28['delay_minutes']>0).mean(),"df['date']=pd.to_datetime(df['date'])
max_date = df['date'].max()
last_28 = df[df['date'] > max_date - pd.Timedelta(days=27)]
result = (last_28['delay_minutes'] > 0).mean()
",0.8333333333333334,63.55
405,406,What is the average delay time across all shipments? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",52.784
406,407,Which warehouse had the least total delay minutes? (count only),result = df['delay_minutes'].sum(),"# total delay minutes across dataset
result = df['delay_minutes'].sum()
",52784,The warehouse with the least total delay minutes is WH2.
407,408,Which warehouse had the highest number of delayed shipments? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the highest number of delayed shipments is WH1.
408,409,Which route has the lowest average delivery time? (detailed),result = df.groupby('route')['delivery_time'].mean().idxmin(),"# route with lowest average delivery time
result = df.groupby('route')['delivery_time'].mean().idxmin()
",Route B,"     route  avg_delivery_time
0  Route B           5.438376
1  Route E           5.453333
2  Route D           5.461773
3  Route A           5.546961
4  Route C           5.573716"
409,410,What is the maximum recorded delay time? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",120
410,411,List all shipments in October with delay above 20 minutes. (count only),df['date']=pd.to_datetime(df['date']); result = df[(df['date'].dt.month==10)&(df['delay_minutes']>20)],"df['date']=pd.to_datetime(df['date'])
result = df[(df['date'].dt.month == 10) & (df['delay_minutes'] > 20)].reset_index(drop=True)
","      id    route warehouse  delivery_time  delay_minutes      delay_reason  \
273  274  Route B       WH2           4.12             77  Mechanical Issue   
275  276  Route C       WH2           5.81             78  Mechanical Issue   
276  277  Route D       WH4           6.19             69   Minor Breakdown   
277  278  Route A       WH1           6.41            108     Customs Delay   
278  279  Route B       WH4           4.25             28           Weather   
279  280  Route E       WH3           5.11             58  Mechanical Issue   
280  281  Route D       WH1           6.30             28  Mechanical Issue   
281  282  Route E       WH1           5.29            120           Traffic   
283  284  Route C       WH1           4.56             23           Weather   
284  285  Route C       WH2           5.20             88           Traffic   
285  286  Route E       WH3           6.27             28  Mechanical Issue   
286  287  Route B       WH1           5.10             46       Driver Rest   
287  288  Route B       WH3           5.19             88     Customs Delay   
288  289  Route C       WH1           4.09             81   Minor Breakdown   
289  290  Route D       WH1           4.83             86       Driver Rest   
291  292  Route A       WH3           5.22             33     Customs Delay   
292  293  Route E       WH4           4.07             21           Weather   
296  297  Route D       WH2           5.80            101  Mechanical Issue   
299  300  Route E       WH1           6.16             31           Traffic   
300  301  Route A       WH4           6.54             83  Mechanical Issue   
303  304  Route E       WH2           5.60            104  Mechanical Issue   
638  639  Route D       WH2           5.85             54           Weather   
639  640  Route D       WH4           4.36             29           Traffic   
640  641  Route B       WH2           6.29             72  Mechanical Issue   
642  643  Route E       WH2           4.11             93     Customs Delay   
643  644  Route B       WH1           6.40            107     Customs Delay   
647  648  Route E       WH2           6.72            110           Traffic   
648  649  Route E       WH1           6.44             29           Traffic   
651  652  Route C       WH4           6.23             93           Weather   
652  653  Route E       WH3           4.80            100           Weather   
653  654  Route B       WH4           5.47            113           Traffic   
656  657  Route D       WH1           4.45             87           Traffic   
657  658  Route A       WH3           4.20             71   Minor Breakdown   
658  659  Route B       WH2           6.48            106  Mechanical Issue   
660  661  Route E       WH1           5.93             83           Traffic   
661  662  Route E       WH1           6.06            110           Weather   
662  663  Route B       WH4           4.98             98   Minor Breakdown   
663  664  Route A       WH1           5.09             50   Minor Breakdown   
666  667  Route A       WH3           4.22             97           Weather   
668  669  Route B       WH1           4.38             86           Weather   

          date  
273 2024-10-01  
275 2024-10-03  
276 2024-10-04  
277 2024-10-05  
278 2024-10-06  
279 2024-10-07  
280 2024-10-08  
281 2024-10-09  
283 2024-10-11  
284 2024-10-12  
285 2024-10-13  
286 2024-10-14  
287 2024-10-15  
288 2024-10-16  
289 2024-10-17  
291 2024-10-19  
292 2024-10-20  
296 2024-10-24  
299 2024-10-27  
300 2024-10-28  
303 2024-10-31  
638 2024-10-01  
639 2024-10-02  
640 2024-10-03  
642 2024-10-05  
643 2024-10-06  
647 2024-10-10  
648 2024-10-11  
651 2024-10-14  
652 2024-10-15  
653 2024-10-16  
656 2024-10-19  
657 2024-10-20  
658 2024-10-21  
660 2024-10-23  
661 2024-10-24  
662 2024-10-25  
663 2024-10-26  
666 2024-10-29  
668 2024-10-31  ",40
411,412,What is the maximum recorded delay time? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",120
412,413,Which warehouse had the most weather-related delays? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most weather-related delays is WH3.
413,414,How many shipments occurred per month? (detailed),df['date']=pd.to_datetime(df['date']); result = df.groupby(df['date'].dt.month)['id'].count(),"df['date']=pd.to_datetime(df['date'])
# shipments per month
result = df.groupby(df['date'].dt.month)['id'].count().reset_index(name='count')
","date
1     92
2     87
3     93
4     90
5     93
6     90
7     93
8     93
9     87
10    62
11    60
12    60
Name: id, dtype: int64","      month  shipment_count
0   2024-01              92
1   2024-02              87
2   2024-03              93
3   2024-04              90
4   2024-05              93
5   2024-06              90
6   2024-07              93
7   2024-08              93
8   2024-09              87
9   2024-10              62
10  2024-11              60
11  2024-12              60"
414,415,Rank all routes by reliability (fewest delays to most). (count only),result = df.groupby('route').apply(lambda g:(g['delay_minutes']==0).mean()).sort_values(ascending=False),"# rank routes by on-time rate
result = df.groupby('route').apply(lambda g: (g['delay_minutes']==0).mean()).sort_values(ascending=False).reset_index(name='on_time_rate')
","route
Route C    0.191257
Route A    0.186275
Route E    0.169014
Route D    0.157635
Route B    0.147208
dtype: float64","     route  delay_count
0  Route C          148
1  Route A          166
2  Route B          168
3  Route D          171
4  Route E          177"
415,416,Which warehouse handled the most shipments overall? (detailed),result = df['warehouse'].value_counts().idxmax(),"# warehouse with most shipments
result = df['warehouse'].value_counts().idxmax()
",WH1,"  warehouse  num_shipments
0       WH1            272"
416,417,List top 5 routes with longest delays this quarter. (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     route  total_delays
0  Route E            64
1  Route A            58
2  Route C            54
3  Route B            54
4  Route D            42"
417,418,How many shipments were sent from each warehouse? (detailed),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  shipment_count
0       WH1             272
1       WH4             250
2       WH3             242
3       WH2             236"
418,419,Which warehouse handled the most shipments overall? (detailed),result = df['warehouse'].value_counts().idxmax(),"# warehouse with most shipments
result = df['warehouse'].value_counts().idxmax()
",WH1,The warehouse that handled the most shipments overall is 'WH1' with a total of 272 shipments.
419,420,How many shipments were sent from each warehouse? (detailed),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  shipment_count
0       WH1             272
1       WH4             250
2       WH3             242
3       WH2             236"
420,421,What is the 95th percentile of delivery time? (detailed),result = df['delivery_time'].quantile(0.95),"# 95th percentile of delivery_time
result = df['delivery_time'].quantile(0.95)
",6.87,6.87
421,422,Which route has the lowest average delivery time? (detailed),result = df.groupby('route')['delivery_time'].mean().idxmin(),"# route with lowest average delivery time
result = df.groupby('route')['delivery_time'].mean().idxmin()
",Route B,The route with the lowest average delivery time is 'Route B' with an average delivery time of 5.44 hours.
422,423,Which month had the highest delay rate? (count only),df['date']=pd.to_datetime(df['date']); result = df.groupby(df['date'].dt.month).apply(lambda g:(g['delay_minutes']>0).mean()).idxmax(),"df['date']=pd.to_datetime(df['date'])
# month with highest delay rate
result = df.groupby(df['date'].dt.month).apply(lambda g: (g['delay_minutes']>0).mean()).idxmax()
",9,The month with the highest delay rate is 3.
423,424,What is the median delivery time by route? (detailed),result = df.groupby('route')['delivery_time'].median(),"# median delivery time by route
result = df.groupby('route')['delivery_time'].median().reset_index()
","route
Route A    5.55
Route B    5.47
Route C    5.69
Route D    5.37
Route E    5.51
Name: delivery_time, dtype: float64","     route  median_delivery_time
0  Route A                  5.55
1  Route B                  5.47
2  Route C                  5.69
3  Route D                  5.37
4  Route E                  5.51"
424,425,Which warehouse shows the shortest delivery time overall? (detailed),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the shortest delivery time overall is 'WH4' with an average delivery time of 5.45 units.
425,426,Which route had the fewest shipments? (detailed),result = df['route'].value_counts().idxmin(),"# route with fewest shipments
result = df['route'].value_counts().idxmin()
",Route C,The route with the fewest shipments is 'Route C' with 183 shipment(s).
426,427,Which warehouse handled the most shipments overall? (detailed),result = df['warehouse'].value_counts().idxmax(),"# warehouse with most shipments
result = df['warehouse'].value_counts().idxmax()
",WH1,"  warehouse  shipment_count
0       WH1             272"
427,428,Which warehouse shows the shortest delivery time overall? (detailed),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the shortest delivery time overall is 'WH4' with an average delivery time of 5.45.
428,429,Show all shipments delayed last week. (count only),df['date']=pd.to_datetime(df['date']); maxd=df['date'].max(); last_week=df[(df['date']>maxd-pd.Timedelta(days=7))]; result = last_week[last_week['delay_minutes']>0],"df['date']=pd.to_datetime(df['date'])
max_date = df['date'].max()
last_week = df[(df['date'] > max_date - pd.Timedelta(days=7))]
result = last_week[last_week['delay_minutes'] > 0].reset_index(drop=True)
","      id    route warehouse  delivery_time  delay_minutes      delay_reason  \
357  358  Route A       WH4           4.91             21  Mechanical Issue   
358  359  Route C       WH4           6.27             51           Traffic   
359  360  Route C       WH1           6.64             27       Driver Rest   
360  361  Route E       WH2           6.38             62     Customs Delay   
361  362  Route D       WH2           5.65            117           Weather   
362  363  Route A       WH3           5.72             46           Weather   
363  364  Route B       WH1           4.46            118           Traffic   
722  723  Route C       WH4           5.08             69           Traffic   
723  724  Route D       WH1           6.23             71           Weather   
725  726  Route C       WH4           5.54              6   Minor Breakdown   
726  727  Route B       WH3           6.11             26           Traffic   
727  728  Route A       WH1           5.35             38           Traffic   
728  729  Route A       WH4           6.65             97       Driver Rest   

          date  
357 2024-12-24  
358 2024-12-25  
359 2024-12-26  
360 2024-12-27  
361 2024-12-28  
362 2024-12-29  
363 2024-12-30  
722 2024-12-24  
723 2024-12-25  
725 2024-12-27  
726 2024-12-28  
727 2024-12-29  
728 2024-12-30  ",12
429,430,What is the median delivery time by route? (detailed),result = df.groupby('route')['delivery_time'].median(),"# median delivery time by route
result = df.groupby('route')['delivery_time'].median().reset_index()
","route
Route A    5.55
Route B    5.47
Route C    5.69
Route D    5.37
Route E    5.51
Name: delivery_time, dtype: float64","       route  median_delivery_time
0    Route E                  5.51
1    Route E                  5.51
2    Route E                  5.51
3    Route E                  5.51
4    Route E                  5.51
..       ...                   ...
995  Route C                  5.69
996  Route C                  5.69
997  Route C                  5.69
998  Route C                  5.69
999  Route C                  5.69

[1000 rows x 2 columns]"
430,431,Which warehouse has the longest average delay? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the longest average delay is WH2.
431,432,What is the average delay time across all shipments? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",52.784
432,433,What is the 95th percentile of delivery time? (detailed),result = df['delivery_time'].quantile(0.95),"# 95th percentile of delivery_time
result = df['delivery_time'].quantile(0.95)
",6.87,6.87
433,434,Show average delay per route in the last two weeks. (count only),df['date']=pd.to_datetime(df['date']); maxd=df['date'].max(); window=df[(df['date']>maxd-pd.Timedelta(days=13))]; result = window.groupby('route')['delay_minutes'].mean(),"df['date']=pd.to_datetime(df['date'])
max_date = df['date'].max()
window = df[(df['date'] > max_date - pd.Timedelta(days=13))]
result = window.groupby('route')['delay_minutes'].mean().reset_index()
","route
Route A    43.333333
Route B    44.500000
Route C    30.600000
Route D    97.200000
Route E    48.000000
Name: delay_minutes, dtype: float64","     route  average_delay
0  Route D      81.000000
1  Route B      50.200000
2  Route E      49.714286
3  Route C      43.500000
4  Route A      43.333333"
434,435,How many shipments were sent from each warehouse? (detailed),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  num_shipments
0       WH1            272
1       WH4            250
2       WH3            242
3       WH2            236"
435,436,Which route has the highest average delivery time? (detailed),result = df.groupby('route')['delivery_time'].mean().idxmax(),"# route with highest average delivery time
result = df.groupby('route')['delivery_time'].mean().idxmax()
",Route C,"     route  avg_delivery_time
0  Route C           5.573716
1  Route A           5.546961
2  Route D           5.461773
3  Route E           5.453333
4  Route B           5.438376"
436,437,List all shipments in October with delay above 20 minutes. (count only),df['date']=pd.to_datetime(df['date']); result = df[(df['date'].dt.month==10)&(df['delay_minutes']>20)],"df['date']=pd.to_datetime(df['date'])
result = df[(df['date'].dt.month == 10) & (df['delay_minutes'] > 20)].reset_index(drop=True)
","      id    route warehouse  delivery_time  delay_minutes      delay_reason  \
273  274  Route B       WH2           4.12             77  Mechanical Issue   
275  276  Route C       WH2           5.81             78  Mechanical Issue   
276  277  Route D       WH4           6.19             69   Minor Breakdown   
277  278  Route A       WH1           6.41            108     Customs Delay   
278  279  Route B       WH4           4.25             28           Weather   
279  280  Route E       WH3           5.11             58  Mechanical Issue   
280  281  Route D       WH1           6.30             28  Mechanical Issue   
281  282  Route E       WH1           5.29            120           Traffic   
283  284  Route C       WH1           4.56             23           Weather   
284  285  Route C       WH2           5.20             88           Traffic   
285  286  Route E       WH3           6.27             28  Mechanical Issue   
286  287  Route B       WH1           5.10             46       Driver Rest   
287  288  Route B       WH3           5.19             88     Customs Delay   
288  289  Route C       WH1           4.09             81   Minor Breakdown   
289  290  Route D       WH1           4.83             86       Driver Rest   
291  292  Route A       WH3           5.22             33     Customs Delay   
292  293  Route E       WH4           4.07             21           Weather   
296  297  Route D       WH2           5.80            101  Mechanical Issue   
299  300  Route E       WH1           6.16             31           Traffic   
300  301  Route A       WH4           6.54             83  Mechanical Issue   
303  304  Route E       WH2           5.60            104  Mechanical Issue   
638  639  Route D       WH2           5.85             54           Weather   
639  640  Route D       WH4           4.36             29           Traffic   
640  641  Route B       WH2           6.29             72  Mechanical Issue   
642  643  Route E       WH2           4.11             93     Customs Delay   
643  644  Route B       WH1           6.40            107     Customs Delay   
647  648  Route E       WH2           6.72            110           Traffic   
648  649  Route E       WH1           6.44             29           Traffic   
651  652  Route C       WH4           6.23             93           Weather   
652  653  Route E       WH3           4.80            100           Weather   
653  654  Route B       WH4           5.47            113           Traffic   
656  657  Route D       WH1           4.45             87           Traffic   
657  658  Route A       WH3           4.20             71   Minor Breakdown   
658  659  Route B       WH2           6.48            106  Mechanical Issue   
660  661  Route E       WH1           5.93             83           Traffic   
661  662  Route E       WH1           6.06            110           Weather   
662  663  Route B       WH4           4.98             98   Minor Breakdown   
663  664  Route A       WH1           5.09             50   Minor Breakdown   
666  667  Route A       WH3           4.22             97           Weather   
668  669  Route B       WH1           4.38             86           Weather   

          date  
273 2024-10-01  
275 2024-10-03  
276 2024-10-04  
277 2024-10-05  
278 2024-10-06  
279 2024-10-07  
280 2024-10-08  
281 2024-10-09  
283 2024-10-11  
284 2024-10-12  
285 2024-10-13  
286 2024-10-14  
287 2024-10-15  
288 2024-10-16  
289 2024-10-17  
291 2024-10-19  
292 2024-10-20  
296 2024-10-24  
299 2024-10-27  
300 2024-10-28  
303 2024-10-31  
638 2024-10-01  
639 2024-10-02  
640 2024-10-03  
642 2024-10-05  
643 2024-10-06  
647 2024-10-10  
648 2024-10-11  
651 2024-10-14  
652 2024-10-15  
653 2024-10-16  
656 2024-10-19  
657 2024-10-20  
658 2024-10-21  
660 2024-10-23  
661 2024-10-24  
662 2024-10-25  
663 2024-10-26  
666 2024-10-29  
668 2024-10-31  ",40
437,438,What is the average delay time across all shipments? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",52.784
438,439,What is the average delay time per warehouse? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  average_delay_time
0       WH4           52.124000
1       WH3           54.206612
2       WH1           50.613971
3       WH2           54.525424"
439,440,What is the average delay time across all shipments? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",52.784
440,441,What is the most recent shipment date? (detailed),df['date']=pd.to_datetime(df['date']); result = df['date'].max(),"df['date']=pd.to_datetime(df['date'])
# most recent shipment date
result = df['date'].max()
",2024-12-30 00:00:00,The most recent shipment date is 2024-12-30 00:00:00.
441,442,List top 5 routes with longest delays this quarter. (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","     route  delay_count
0  Route E           35
1  Route B           35
2  Route D           34
3  Route A           22
4  Route C           21"
442,443,What is the average delay time per warehouse? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  average_delay_minutes
0       WH2              54.525424
1       WH3              54.206612
2       WH4              52.124000
3       WH1              50.613971"
443,444,How many shipments took more than 6 days? (detailed),result = (df['delivery_time']>6).sum(),"# shipments with delivery_time more than 6
result = df[df['delivery_time'] > 6].shape[0]
",318,"      id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0      5  Route C       WH4           6.13            120           Traffic   
1     12  Route C       WH2           6.60              7       Driver Rest   
2     14  Route A       WH4           6.44            119   Minor Breakdown   
3     18  Route E       WH3           6.53             87   Minor Breakdown   
4     23  Route E       WH2           6.37             45   Minor Breakdown   
..   ...      ...       ...            ...            ...               ...   
313  986  Route D       WH3           6.06             69  Mechanical Issue   
314  988  Route D       WH2           6.11             17       Driver Rest   
315  991  Route A       WH2           6.02             80  Mechanical Issue   
316  993  Route D       WH1           6.03             65           Traffic   
317  995  Route A       WH4           6.35             57           Traffic   

          date  
0   2024-01-06  
1   2024-01-13  
2   2024-01-15  
3   2024-01-19  
4   2024-01-24  
..         ...  
313 2024-09-13  
314 2024-09-15  
315 2024-09-18  
316 2024-09-20  
317 2024-09-22  

[318 rows x 7 columns]"
444,445,How many shipments were sent from each warehouse? (detailed),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  num_shipments
0       WH1            272
1       WH4            250
2       WH3            242
3       WH2            236"
445,446,Rank all routes by reliability (fewest delays to most). (count only),result = df.groupby('route').apply(lambda g:(g['delay_minutes']==0).mean()).sort_values(ascending=False),"# rank routes by on-time rate
result = df.groupby('route').apply(lambda g: (g['delay_minutes']==0).mean()).sort_values(ascending=False).reset_index(name='on_time_rate')
","route
Route C    0.191257
Route A    0.186275
Route E    0.169014
Route D    0.157635
Route B    0.147208
dtype: float64","     route  total_shipments  delayed_shipments
0  Route C              183              148.0
1  Route A              204              166.0
2  Route B              197              168.0
3  Route D              203              171.0
4  Route E              213              177.0"
446,447,How many shipments took less than 3 days? (detailed),result = (df['delivery_time']<3).sum(),"# shipments with delivery_time less than 3
result = df[df['delivery_time'] < 3].shape[0]
",0,"       id    route warehouse  delivery_time  delay_minutes      delay_reason  \
0       1  Route C       WH2           4.88             51     Customs Delay   
1       2  Route A       WH4           4.77             45       Driver Rest   
2       3  Route C       WH4           5.31            113           Traffic   
3       4  Route B       WH4           5.83             32   Minor Breakdown   
4       5  Route C       WH4           6.13            120           Traffic   
..    ...      ...       ...            ...            ...               ...   
995   996  Route B       WH2           5.60            118           Weather   
996   997  Route E       WH4           5.00             83       Driver Rest   
997   998  Route B       WH4           5.45             52       Driver Rest   
998   999  Route E       WH4           5.61            117           Traffic   
999  1000  Route B       WH3           5.52            105  Mechanical Issue   

          date  
0   2024-01-02  
1   2024-01-03  
2   2024-01-04  
3   2024-01-05  
4   2024-01-06  
..         ...  
995 2024-09-23  
996 2024-09-24  
997 2024-09-25  
998 2024-09-26  
999 2024-09-27  

[1000 rows x 7 columns]"
447,448,How many unique routes are there? (detailed),result = df['route'].nunique(),"# number of unique routes
result = df['route'].nunique()
",5,5
448,449,How many warehouses are involved? (detailed),result = df['warehouse'].nunique(),"# number of unique warehouses
result = df['warehouse'].nunique()
",4,4
449,450,Show all shipments delayed last week. (count only),df['date']=pd.to_datetime(df['date']); maxd=df['date'].max(); last_week=df[(df['date']>maxd-pd.Timedelta(days=7))]; result = last_week[last_week['delay_minutes']>0],"df['date']=pd.to_datetime(df['date'])
max_date = df['date'].max()
last_week = df[(df['date'] > max_date - pd.Timedelta(days=7))]
result = last_week[last_week['delay_minutes'] > 0].reset_index(drop=True)
","      id    route warehouse  delivery_time  delay_minutes      delay_reason  \
357  358  Route A       WH4           4.91             21  Mechanical Issue   
358  359  Route C       WH4           6.27             51           Traffic   
359  360  Route C       WH1           6.64             27       Driver Rest   
360  361  Route E       WH2           6.38             62     Customs Delay   
361  362  Route D       WH2           5.65            117           Weather   
362  363  Route A       WH3           5.72             46           Weather   
363  364  Route B       WH1           4.46            118           Traffic   
722  723  Route C       WH4           5.08             69           Traffic   
723  724  Route D       WH1           6.23             71           Weather   
725  726  Route C       WH4           5.54              6   Minor Breakdown   
726  727  Route B       WH3           6.11             26           Traffic   
727  728  Route A       WH1           5.35             38           Traffic   
728  729  Route A       WH4           6.65             97       Driver Rest   

          date  
357 2024-12-24  
358 2024-12-25  
359 2024-12-26  
360 2024-12-27  
361 2024-12-28  
362 2024-12-29  
363 2024-12-30  
722 2024-12-24  
723 2024-12-25  
725 2024-12-27  
726 2024-12-28  
727 2024-12-29  
728 2024-12-30  ",12
450,451,How many shipments took less than 3 days? (detailed),result = (df['delivery_time']<3).sum(),"# shipments with delivery_time less than 3
result = df[df['delivery_time'] < 3].shape[0]
",0,1000
451,452,Which warehouse served the most different routes? (detailed),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  distinct_routes
0       WH3                5
1       WH2                5
2       WH1                5
3       WH4                5"
452,453,Which warehouse had the most weather-related delays? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most weather-related delays is WH3.
453,454,Which route had the longest single delay event? (count only),"idx = df['delay_minutes'].idxmax(); result = df.loc[idx, ['route','delay_minutes','date']].to_dict()","idx = df['delay_minutes'].idxmax()
result = df.loc[idx, ['route', 'delay_minutes', 'date']].to_dict()
","{'route': 'Route C', 'delay_minutes': 120, 'date': Timestamp('2024-01-06 00:00:00')}",The route with the longest single delay event is Route B with a delay of 120 minutes.
454,455,Predict next week's delay rate using historical averages. (count only),df['date']=pd.to_datetime(df['date']); last_28=df[df['date']>df['date'].max()-pd.Timedelta(days=27)]; result = (last_28['delay_minutes']>0).mean(),"df['date']=pd.to_datetime(df['date'])
max_date = df['date'].max()
last_28 = df[df['date'] > max_date - pd.Timedelta(days=27)]
result = (last_28['delay_minutes'] > 0).mean()
",0.8333333333333334,nan
455,456,Show total delayed shipments last month. (count only),df['date']=pd.to_datetime(df['date']); m=df['date'].max().month; y=df['date'].max().year; result = df[(df['date'].dt.month==m)&(df['date'].dt.year==y)&(df['delay_minutes']>0)].shape[0],"df['date']=pd.to_datetime(df['date'])
max_date = df['date'].max()
month = max_date.month; year = max_date.year
result = df[(df['date'].dt.month==month) & (df['date'].dt.year==year) & (df['delay_minutes']>0)].shape[0]
",48,50
456,457,Which route has the highest average delivery time? (detailed),result = df.groupby('route')['delivery_time'].mean().idxmax(),"# route with highest average delivery time
result = df.groupby('route')['delivery_time'].mean().idxmax()
",Route C,"     route  avg_delivery_time
0  Route C           5.573716
1  Route A           5.546961
2  Route D           5.461773
3  Route E           5.453333
4  Route B           5.438376"
457,458,What is the earliest shipment date recorded? (detailed),df['date']=pd.to_datetime(df['date']); result = df['date'].min(),"df['date']=pd.to_datetime(df['date'])
# earliest shipment date
result = df['date'].min()
",2024-01-01 00:00:00,The earliest shipment date recorded is 2024-01-01 00:00:00.
458,459,What is the total delay time across all shipments? (count only),result = df['delay_minutes'].sum(),"# total delay minutes across dataset
result = df['delay_minutes'].sum()
",52784,52784.0
459,460,What is the 95th percentile of delivery time? (detailed),result = df['delivery_time'].quantile(0.95),"# 95th percentile of delivery_time
result = df['delivery_time'].quantile(0.95)
",6.87,6.87
460,461,Show total delayed shipments last month. (count only),df['date']=pd.to_datetime(df['date']); m=df['date'].max().month; y=df['date'].max().year; result = df[(df['date'].dt.month==m)&(df['date'].dt.year==y)&(df['delay_minutes']>0)].shape[0],"df['date']=pd.to_datetime(df['date'])
max_date = df['date'].max()
month = max_date.month; year = max_date.year
result = df[(df['date'].dt.month==month) & (df['date'].dt.year==year) & (df['delay_minutes']>0)].shape[0]
",48,50
461,462,What is the average delay time across all shipments? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",52.784
462,463,What is the most recent shipment date? (detailed),df['date']=pd.to_datetime(df['date']); result = df['date'].max(),"df['date']=pd.to_datetime(df['date'])
# most recent shipment date
result = df['date'].max()
",2024-12-30 00:00:00,"    id    route warehouse  delivery_time  delay_minutes delay_reason  \
0  364  Route B       WH1           4.46            118      Traffic   

        date  
0 2024-12-30  "
463,464,What percentage of all shipments were delayed? (count only),result = (df['delay_minutes']>0).mean()*100,"# percentage of shipments delayed
result = (df['delay_minutes']>0).mean() * 100
",83.0,83.0
464,465,How many warehouses are involved? (detailed),result = df['warehouse'].nunique(),"# number of unique warehouses
result = df['warehouse'].nunique()
",4,4
465,466,Show the route-wise breakdown of delay reasons. (count only),"result = df[df['delay_minutes']>0].groupby(['route','delay_reason'])['id'].count()","# breakdown of delay reasons by route
result = df[df['delay_minutes']>0].groupby(['route','delay_reason'])['id'].count().reset_index(name='count')
","route    delay_reason    
Route A  Customs Delay       24
         Driver Rest         31
         Mechanical Issue    27
         Minor Breakdown     22
         Traffic             29
         Weather             33
Route B  Customs Delay       22
         Driver Rest         38
         Mechanical Issue    24
         Minor Breakdown     29
         Traffic             30
         Weather             25
Route C  Customs Delay       17
         Driver Rest         21
         Mechanical Issue    28
         Minor Breakdown     30
         Traffic             32
         Weather             20
Route D  Customs Delay       21
         Driver Rest         30
         Mechanical Issue    41
         Minor Breakdown     20
         Traffic             29
         Weather             30
Route E  Customs Delay       31
         Driver Rest         25
         Mechanical Issue    23
         Minor Breakdown     32
         Traffic             37
         Weather             29
Name: id, dtype: int64","      route      delay_reason  delay_count
0   Route A              None           38
1   Route A           Weather           33
2   Route A       Driver Rest           31
3   Route A           Traffic           29
4   Route A  Mechanical Issue           27
5   Route A     Customs Delay           24
6   Route A   Minor Breakdown           22
7   Route B       Driver Rest           38
8   Route B           Traffic           30
9   Route B              None           29
10  Route B   Minor Breakdown           29
11  Route B           Weather           25
12  Route B  Mechanical Issue           24
13  Route B     Customs Delay           22
14  Route C              None           35
15  Route C           Traffic           32
16  Route C   Minor Breakdown           30
17  Route C  Mechanical Issue           28
18  Route C       Driver Rest           21
19  Route C           Weather           20
20  Route C     Customs Delay           17
21  Route D  Mechanical Issue           41
22  Route D              None           32
23  Route D       Driver Rest           30
24  Route D           Weather           30
25  Route D           Traffic           29
26  Route D     Customs Delay           21
27  Route D   Minor Breakdown           20
28  Route E           Traffic           37
29  Route E              None           36
30  Route E   Minor Breakdown           32
31  Route E     Customs Delay           31
32  Route E           Weather           29
33  Route E       Driver Rest           25
34  Route E  Mechanical Issue           23"
466,467,What is the correlation between delivery_time and delay_minutes? (count only),result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,-0.004137855444638722
467,468,Which warehouse had the most weather-related delays? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most weather-related delays is WH3 with 38 delays.
468,469,Which warehouse had the most weather-related delays? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most weather-related delays is WH3.
469,470,Which warehouse had the least total delay minutes? (count only),result = df['delay_minutes'].sum(),"# total delay minutes across dataset
result = df['delay_minutes'].sum()
",52784,The warehouse with the least total delay minutes is WH2.
470,471,What day of the week has the most shipments? (detailed),df['date']=pd.to_datetime(df['date']); result = df.groupby(df['date'].dt.day_name())['id'].count().idxmax(),"df['date']=pd.to_datetime(df['date'])
# day of week with most shipments
result = df.groupby(df['date'].dt.day_name())['id'].count().idxmax()
",Monday,"        date day_of_week  shipment_count
0 2024-01-08      Monday             144
1 2024-01-05      Friday             143
2 2024-01-02     Tuesday             143
3 2024-01-04    Thursday             143
4 2024-01-03   Wednesday             143
5 2024-01-06    Saturday             142
6 2024-01-07      Sunday             142"
471,472,What is the most recent shipment date? (detailed),df['date']=pd.to_datetime(df['date']); result = df['date'].max(),"df['date']=pd.to_datetime(df['date'])
# most recent shipment date
result = df['date'].max()
",2024-12-30 00:00:00,The most recent shipment date is 2024-12-30 00:00:00.
472,473,What is the 95th percentile of delivery time? (detailed),result = df['delivery_time'].quantile(0.95),"# 95th percentile of delivery_time
result = df['delivery_time'].quantile(0.95)
",6.87,6.87
473,474,What is the total delay time across all shipments? (count only),result = df['delay_minutes'].sum(),"# total delay minutes across dataset
result = df['delay_minutes'].sum()
",52784,52784.0
474,475,Show total delayed shipments last month. (count only),df['date']=pd.to_datetime(df['date']); m=df['date'].max().month; y=df['date'].max().year; result = df[(df['date'].dt.month==m)&(df['date'].dt.year==y)&(df['delay_minutes']>0)].shape[0],"df['date']=pd.to_datetime(df['date'])
max_date = df['date'].max()
month = max_date.month; year = max_date.year
result = df[(df['date'].dt.month==month) & (df['date'].dt.year==year) & (df['delay_minutes']>0)].shape[0]
",48,50
475,476,What is the average delay time across all shipments? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",52.784
476,477,Which warehouse had the most weather-related delays? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most weather-related delays is WH3.
477,478,Which warehouse had the most weather-related delays? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the most weather-related delays is WH3.
478,479,What is the average delay time across all shipments? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",52.784
479,480,Find routes where delivery time is rising but delay minutes are decreasing. (count only),"df['date']=pd.to_datetime(df['date']); result = []
# compute monthly trend per route
monthly_dt = df.set_index(pd.to_datetime(df['date'])).groupby('route')['delivery_time'].resample('M').mean().unstack(0)
monthly_delay = df.set_index(pd.to_datetime(df['date'])).groupby('route')['delay_minutes'].resample('M').mean().unstack(0)
for col in monthly_dt.columns:
    if monthly_dt[col].iloc[-1] > monthly_dt[col].iloc[0] and monthly_delay[col].iloc[-1] < monthly_delay[col].iloc[0]:
        result.append(col)","df['date']=pd.to_datetime(df['date'])
monthly_dt = df.set_index('date').groupby('route')['delivery_time'].resample('M').mean().unstack(0)
monthly_delay = df.set_index('date').groupby('route')['delay_minutes'].resample('M').mean().unstack(0)
trend_dt = (monthly_dt.iloc[-1] - monthly_dt.iloc[0]) > 0
trend_delay = (monthly_delay.iloc[-1] - monthly_delay.iloc[0]) < 0
result = list(monthly_dt.columns[trend_dt & trend_delay])
","['Route A', 'Route C', 'Route D']","     route  count
0  Route B    197
1  Route C    183
2  Route A    204
3  Route E    213
4  Route D    203"
480,481,How many warehouses are involved? (detailed),result = df['warehouse'].nunique(),"# number of unique warehouses
result = df['warehouse'].nunique()
",4,4
481,482,What day of the week has the most shipments? (detailed),df['date']=pd.to_datetime(df['date']); result = df.groupby(df['date'].dt.day_name())['id'].count().idxmax(),"df['date']=pd.to_datetime(df['date'])
# day of week with most shipments
result = df.groupby(df['date'].dt.day_name())['id'].count().idxmax()
",Monday,The day of the week with the most shipments is 2024-02-13 00:00:00.
482,483,What percentage of all shipments were delayed? (count only),result = (df['delay_minutes']>0).mean()*100,"# percentage of shipments delayed
result = (df['delay_minutes']>0).mean() * 100
",83.0,83.0
483,484,How many shipments occurred per month? (detailed),df['date']=pd.to_datetime(df['date']); result = df.groupby(df['date'].dt.month)['id'].count(),"df['date']=pd.to_datetime(df['date'])
# shipments per month
result = df.groupby(df['date'].dt.month)['id'].count().reset_index(name='count')
","date
1     92
2     87
3     93
4     90
5     93
6     90
7     93
8     93
9     87
10    62
11    60
12    60
Name: id, dtype: int64","      month  shipments_count
0   2024-01               92
1   2024-02               87
2   2024-03               93
3   2024-04               90
4   2024-05               93
5   2024-06               90
6   2024-07               93
7   2024-08               93
8   2024-09               87
9   2024-10               62
10  2024-11               60
11  2024-12               60"
484,485,Which warehouse had the most weather-related delays? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  delay_count
0       WH3           38"
485,486,Which warehouse served the most different routes? (detailed),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}","  warehouse  distinct_routes
0       WH3                5
1       WH1                5
2       WH2                5
3       WH4                5"
486,487,Which warehouse shows the shortest delivery time overall? (detailed),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",The warehouse with the shortest delivery time overall is 'WH4' with an average delivery time of 5.45 hours.
487,488,What is the correlation between delivery_time and delay_minutes? (count only),result = df['delivery_time'].corr(df['delay_minutes']),"# correlation between delivery_time and delay_minutes
result = df['delivery_time'].corr(df['delay_minutes'])
",-0.004137855444638635,-0.004137855444638722
488,489,Rank all routes by reliability (fewest delays to most). (count only),result = df.groupby('route').apply(lambda g:(g['delay_minutes']==0).mean()).sort_values(ascending=False),"# rank routes by on-time rate
result = df.groupby('route').apply(lambda g: (g['delay_minutes']==0).mean()).sort_values(ascending=False).reset_index(name='on_time_rate')
","route
Route C    0.191257
Route A    0.186275
Route E    0.169014
Route D    0.157635
Route B    0.147208
dtype: float64","     route  total_shipments  delayed_shipments
0  Route C              183              148.0
1  Route A              204              166.0
2  Route B              197              168.0
3  Route D              203              171.0
4  Route E              213              177.0"
489,490,Show the route-wise breakdown of delay reasons. (count only),"result = df[df['delay_minutes']>0].groupby(['route','delay_reason'])['id'].count()","# breakdown of delay reasons by route
result = df[df['delay_minutes']>0].groupby(['route','delay_reason'])['id'].count().reset_index(name='count')
","route    delay_reason    
Route A  Customs Delay       24
         Driver Rest         31
         Mechanical Issue    27
         Minor Breakdown     22
         Traffic             29
         Weather             33
Route B  Customs Delay       22
         Driver Rest         38
         Mechanical Issue    24
         Minor Breakdown     29
         Traffic             30
         Weather             25
Route C  Customs Delay       17
         Driver Rest         21
         Mechanical Issue    28
         Minor Breakdown     30
         Traffic             32
         Weather             20
Route D  Customs Delay       21
         Driver Rest         30
         Mechanical Issue    41
         Minor Breakdown     20
         Traffic             29
         Weather             30
Route E  Customs Delay       31
         Driver Rest         25
         Mechanical Issue    23
         Minor Breakdown     32
         Traffic             37
         Weather             29
Name: id, dtype: int64","      route      delay_reason  count
0   Route A              None     38
1   Route A           Weather     33
2   Route A       Driver Rest     31
3   Route A           Traffic     29
4   Route A  Mechanical Issue     27
5   Route A     Customs Delay     24
6   Route A   Minor Breakdown     22
7   Route B       Driver Rest     38
8   Route B           Traffic     30
9   Route B              None     29
10  Route B   Minor Breakdown     29
11  Route B           Weather     25
12  Route B  Mechanical Issue     24
13  Route B     Customs Delay     22
14  Route C              None     35
15  Route C           Traffic     32
16  Route C   Minor Breakdown     30
17  Route C  Mechanical Issue     28
18  Route C       Driver Rest     21
19  Route C           Weather     20
20  Route C     Customs Delay     17
21  Route D  Mechanical Issue     41
22  Route D              None     32
23  Route D           Weather     30
24  Route D       Driver Rest     30
25  Route D           Traffic     29
26  Route D     Customs Delay     21
27  Route D   Minor Breakdown     20
28  Route E           Traffic     37
29  Route E              None     36
30  Route E   Minor Breakdown     32
31  Route E     Customs Delay     31
32  Route E           Weather     29
33  Route E       Driver Rest     25
34  Route E  Mechanical Issue     23"
490,491,How many shipments had zero delay? (count only),result = (df['delay_minutes']==0).sum(),"# count shipments with zero delay
result = df[df['delay_minutes']==0].shape[0]
",170,170
491,492,What is the earliest shipment date recorded? (detailed),df['date']=pd.to_datetime(df['date']); result = df['date'].min(),"df['date']=pd.to_datetime(df['date'])
# earliest shipment date
result = df['date'].min()
",2024-01-01 00:00:00,The earliest shipment date recorded is 2024-01-01 00:00:00.
492,493,Predict next week's delay rate using historical averages. (count only),df['date']=pd.to_datetime(df['date']); last_28=df[df['date']>df['date'].max()-pd.Timedelta(days=27)]; result = (last_28['delay_minutes']>0).mean(),"df['date']=pd.to_datetime(df['date'])
max_date = df['date'].max()
last_28 = df[df['date'] > max_date - pd.Timedelta(days=27)]
result = (last_28['delay_minutes'] > 0).mean()
",0.8333333333333334,52.784
493,494,Which route has the lowest average delivery time? (detailed),result = df.groupby('route')['delivery_time'].mean().idxmin(),"# route with lowest average delivery time
result = df.groupby('route')['delivery_time'].mean().idxmin()
",Route B,The route with the lowest average delivery time is 'Route B' with an average delivery time of 5.44.
494,495,What is the maximum recorded delay time? (count only),"result = {'shape': df.shape, 'columns': list(df.columns)}","result = {'shape': df.shape, 'columns': list(df.columns), 'sample': df.head(3).to_dict(orient='records')}
","{'shape': (1000, 7), 'columns': ['id', 'route', 'warehouse', 'delivery_time', 'delay_minutes', 'delay_reason', 'date']}",120
495,496,How many shipments occurred per month? (detailed),df['date']=pd.to_datetime(df['date']); result = df.groupby(df['date'].dt.month)['id'].count(),"df['date']=pd.to_datetime(df['date'])
# shipments per month
result = df.groupby(df['date'].dt.month)['id'].count().reset_index(name='count')
","date
1     92
2     87
3     93
4     90
5     93
6     90
7     93
8     93
9     87
10    62
11    60
12    60
Name: id, dtype: int64","      month  shipments_count
0   2024-01               92
1   2024-02               87
2   2024-03               93
3   2024-04               90
4   2024-05               93
5   2024-06               90
6   2024-07               93
7   2024-08               93
8   2024-09               87
9   2024-10               62
10  2024-11               60
11  2024-12               60"
496,497,Which warehouse had the least total delay minutes? (count only),result = df['delay_minutes'].sum(),"# total delay minutes across dataset
result = df['delay_minutes'].sum()
",52784,The warehouse with the least total delay minutes is WH2.
497,498,Which week had the most deliveries? (detailed),df['date']=pd.to_datetime(df['date']); result = df.groupby(df['date'].dt.isocalendar().week)['id'].count().idxmax(),"df['date']=pd.to_datetime(df['date'])
# week number with most deliveries
result = df.groupby(df['date'].dt.isocalendar().week)['id'].count().idxmax()
",1,"      week  deliveries
0  2024-04          21"
498,499,How many shipments had zero delay? (count only),result = (df['delay_minutes']==0).sum(),"# count shipments with zero delay
result = df[df['delay_minutes']==0].shape[0]
",170,170
499,500,Which routes had no delays at all? (count only),"result = [r for r,g in df.groupby('route') if (g['delay_minutes']>0).sum()==0]","groups = df.groupby('route')
# routes with zero delays
result = [route for route, g in groups if (g['delay_minutes']>0).sum() == 0]
",[],"     route  no_delay_count
0  Route A              38
1  Route E              36
2  Route C              35
3  Route D              32
4  Route B              29"
